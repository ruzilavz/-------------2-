<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>AVZAL√òV (–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤) ‚Äî –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∞—Ä—Ç–∏—Å—Ç–∞ AVZAL√òV (–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤). –ú—É–∑—ã–∫–∞, —Ä–µ–ª–∏–∑—ã, –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã." />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    /* —É–±–∏—Ä–∞–µ—Ç –Ω–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å —É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ñ–æ—Ä–º—ã */
    button,
    input,
    select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }

    :root {
      --bg: #05060a;
      --accent: #2f6bff;
      --accent-soft: rgba(47, 107, 255, 0.2);
      --text: #f5f5f5;
      --muted: #9a9fb4;
      --card: #101320;
      --border: #1c2133;
      --radius-lg: 18px;
      --radius-md: 12px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.65);
      --shadow-sm: 0 8px 20px rgba(0, 0, 0, 0.5);
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      --transition: 200ms ease-out;
      --active-cover: none;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-main);
      background: radial-gradient(circle at top, #151a33 0, var(--bg) 55%);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.5;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-image: var(--active-cover);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0;
      transition: opacity var(--transition);
      pointer-events: none;
      filter: blur(5px);
      transform: scale(1.1);
      z-index: -1;
    }

    body.has-active-cover::before {
      opacity: 0.6;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    img {
      max-width: 100%;
      display: block;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px 16px 60px;
    }
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–≤–µ—Ä—Ö" */
    .scroll-to-top-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--accent);
      color: var(--text);
      border: none;
      font-size: 18px;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
    }

    .scroll-to-top-btn:hover {
      opacity: 0.8;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —à–∞–ø–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è */
    .users-popover-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .users-popover-empty {
      font-size: 12px;
      color: rgba(198, 206, 244, 0.75);
    }

    .users-popover-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 10px;
      border-radius: var(--radius-md);
      background: rgba(14, 18, 34, 0.92);
      border: 1px solid rgba(76, 102, 189, 0.32);
      font-size: 12px;
      color: rgba(214, 220, 255, 0.88);
    }

    .users-popover-item-rank {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: rgba(47, 107, 255, 0.18);
      color: #adc3ff;
      font-size: 11px;
      font-weight: 600;
    }

    .users-popover-meta {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .users-popover-name {
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .users-popover-stats {
      display: flex;
      gap: 10px;
      font-size: 11px;
      color: rgba(160, 172, 220, 0.82);
    }

    .users-popover-stats span::before {
      content: "";
      display: inline-block;
      width: 4px;
      height: 4px;
      margin-right: 6px;
      border-radius: 50%;
      background: currentColor;
      opacity: 0.6;
    }

    .users-popover-role {
      font-size: 11px;
      color: rgba(186, 196, 240, 0.78);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .logo-group {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .logo-mark {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 600;
      color: var(--accent);
      box-shadow: 0 0 12px rgba(47, 107, 255, 0.3);
    }

    .logo-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .logo-text-main {
      font-weight: 700;
      letter-spacing: 0.22em;
      font-size: 13px;
      text-transform: uppercase;
    }

    .logo-text-sub {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.18em;
    }

    nav {
      display: flex;
      gap: 18px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
    }

    nav a {
      position: relative;
      padding-bottom: 4px;
    }

    nav a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 2px;
      background: var(--accent);
      border-radius: 999px;
      transition: width var(--transition);
    }

    nav a:hover::after {
      width: 100%;
    }

    .site-header {
      position: sticky;
      top: 18px;
      z-index: 80;
      display: flex;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
      padding: 18px 22px;
      margin: 24px 0 48px;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(74, 100, 189, 0.36);
      background: linear-gradient(135deg, rgba(12, 16, 30, 0.94), rgba(7, 10, 22, 0.86));
      box-shadow: 0 22px 48px rgba(6, 8, 16, 0.72);
      overflow: visible;
      isolation: isolate;
      transform: translateY(18px);
      transition:
        transform 0.35s ease,
        box-shadow 0.35s ease,
        background 0.35s ease,
        border-color 0.35s ease,
        backdrop-filter 0.35s ease;
      will-change: transform, box-shadow, background;
    }

    .site-header.is-floating {
      transform: translateY(0);
      box-shadow: 0 26px 52px rgba(5, 8, 20, 0.78);
      border-color: rgba(74, 100, 189, 0.48);
      background: linear-gradient(135deg, rgba(12, 16, 30, 0.98), rgba(7, 10, 22, 0.94));
      backdrop-filter: blur(16px);
    }

    .site-header.is-condensed {
      padding: 14px 20px;
    }

    .site-header::before {
      content: "";
      position: absolute;
      inset: -30% -20% auto;
      height: 140%;
      background: radial-gradient(circle at top right, rgba(82, 126, 255, 0.4), transparent 60%);
      pointer-events: none;
    }

    .site-header::after {
      content: "";
      position: absolute;
      inset: auto -10% -40% -10%;
      height: 160%;
      background: radial-gradient(circle at bottom left, rgba(104, 65, 212, 0.28), transparent 65%);
      pointer-events: none;
    }

    .site-header .logo-group,
    .site-header nav,
    .site-header .header-actions,
    .site-header .nav-toggle {
      position: relative;
      z-index: 1;
    }

    .site-header nav {
      flex: 1 1 320px;
      display: flex;
      justify-content: center;
    }

    .mix-button-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 160px;
    }

    .mix-button {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      padding: 10px 18px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: linear-gradient(135deg, rgba(255, 99, 71, 0.2), rgba(255, 165, 0, 0.15));
      color: #fff5ec;
      font-weight: 700;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      cursor: pointer;
      transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition), background var(--transition);
    }

    .mix-button:hover,
    .mix-button:focus-visible {
      transform: translateY(-2px);
      box-shadow: 0 20px 36px rgba(255, 140, 0, 0.35);
      border-color: rgba(255, 176, 126, 0.6);
      outline: none;
    }

    .mix-button.is-live {
      background: linear-gradient(135deg, rgba(255, 76, 41, 0.65), rgba(255, 191, 0, 0.5));
      border-color: rgba(255, 176, 126, 0.9);
      box-shadow: 0 26px 46px rgba(255, 120, 72, 0.45);
    }

    .mix-label {
      font-size: 13px;
      letter-spacing: 0.3em;
    }

    .mix-countdown {
      font-size: 11px;
      letter-spacing: 0.08em;
      color: rgba(255, 232, 210, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .mix-countdown::before {
      content: "‚è≥";
      font-size: 12px;
      opacity: 0.9;
    }

    .mix-button.is-live .mix-countdown::before {
      content: "üî•";
    }

    .header-actions {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid rgba(76, 106, 204, 0.32);
      background: rgba(6, 9, 18, 0.78);
      box-shadow: 0 18px 38px rgba(5, 7, 16, 0.6);
    }

    .search-bar {
      position: relative;
    }

    .search-bar input {
      padding: 8px 12px 8px 32px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: rgba(9, 12, 24, 0.9);
      color: var(--text);
      font-size: 13px;
      width: 200px;
      transition: width 0.3s ease-in-out;
    }

    .search-bar input:focus {
      outline: 2px solid rgba(47, 107, 255, 0.6);
      outline-offset: 1px;
      width: 250px;
    }

    .search-bar .fa-search {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
    }

    .scroll-to-top-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--accent);
      color: var(--text);
      border: none;
      font-size: 18px;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      transition: opacity 0.3s, visibility 0.3s;
    }

    .scroll-to-top-btn:hover {
      opacity: 0.8;
    }

    .header-action-group {
      position: relative;
      display: flex;
      align-items: center;
    }

    .ruzcoin-chip {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      border-radius: 999px;
      border: 1px solid rgba(122, 150, 255, 0.45);
      background: linear-gradient(135deg, rgba(20, 28, 60, 0.96), rgba(12, 16, 34, 0.92));
      box-shadow: 0 20px 38px rgba(28, 44, 120, 0.45);
      cursor: pointer;
      color: inherit;
      transition: transform var(--transition), border-color var(--transition), box-shadow var(--transition);
    }

    .ruzcoin-chip:hover,
    .ruzcoin-chip:focus-visible {
      transform: translateY(-1px);
      border-color: rgba(148, 178, 255, 0.65);
      box-shadow: 0 24px 40px rgba(36, 58, 140, 0.5);
      outline: none;
    }

    .ruzcoin-info {
      display: flex;
      flex-direction: column;
      line-height: 1.1;
    }

    .ruzcoin-label {
      font-size: 10px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255, 255, 255, 0.55);
    }

    .ruzcoin-value {
      font-size: 15px;
      font-weight: 700;
    }

    .ruzcoin-icon {
      position: relative;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: radial-gradient(circle at 28% 18%, #fff6d4 0%, #f3c35d 45%, #a9680d 100%);
      border: 1px solid rgba(255, 209, 140, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 16px 28px rgba(180, 122, 40, 0.35);
      overflow: hidden;
    }

    .ruzcoin-icon::before {
      content: "";
      position: absolute;
      inset: 3px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(255, 244, 210, 0.85), rgba(255, 205, 120, 0.3));
      opacity: 0.9;
      pointer-events: none;
    }

    .ruzcoin-icon::after {
      content: "";
      position: absolute;
      inset: 6px;
      border-radius: 50%;
      border: 1px solid rgba(255, 232, 190, 0.65);
      box-shadow: inset 0 0 0 1px rgba(208, 138, 36, 0.35);
      pointer-events: none;
    }

    .ruzcoin-glyph {
      position: relative;
      font-size: 15px;
      font-weight: 700;
      color: rgba(60, 32, 6, 0.9);
      text-shadow: 0 1px 0 rgba(255, 248, 226, 0.6);
      letter-spacing: 0.06em;
    }

    .ruzcoin-icon.is-inline {
      width: 22px;
      height: 22px;
      margin-right: 6px;
      box-shadow: 0 10px 20px rgba(180, 122, 40, 0.28);
    }

    .ruzcoin-icon.is-inline::before {
      inset: 2px;
    }

    .ruzcoin-icon.is-inline::after {
      inset: 4px;
    }

    .header-profile-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: rgba(9, 12, 24, 0.9);
      color: var(--text);
      font-size: 11px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background var(--transition), border-color var(--transition), transform var(--transition);
    }

    .header-profile-avatar {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background-image: var(--header-avatar-image, linear-gradient(140deg, rgba(47, 107, 255, 0.36), rgba(18, 22, 40, 0.9)));
      background-size: cover;
      background-position: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.08em;
      color: #e4e9ff;
      transition: opacity var(--transition);
      overflow: hidden;
    }

    .header-profile-avatar.has-image {
      color: transparent;
      box-shadow: 0 8px 18px rgba(12, 18, 38, 0.55);
    }

    .header-profile-btn:hover,
    .header-profile-btn:focus-visible {
      background: rgba(26, 36, 74, 0.95);
      border-color: rgba(47, 107, 255, 0.7);
      transform: translateY(-2px);
      outline: none;
    }

    .header-profile-btn i {
      font-size: 14px;
    }

    .header-popover {
      position: absolute;
      top: calc(100% + 14px);
      right: 0;
      width: min(320px, 80vw);
      padding: 16px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(47, 107, 255, 0.28);
      background: rgba(10, 12, 24, 0.98);
      box-shadow: var(--shadow-soft);
      display: none;
      flex-direction: column;
      gap: 14px;
      z-index: 30;
      max-height: min(72vh, 520px);
      overflow-y: auto;
      backdrop-filter: blur(12px);
    }

    .header-popover-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .topup-methods-panel {
      border-radius: var(--radius-md);
      border: 1px solid rgba(82, 112, 210, 0.32);
      background: rgba(12, 14, 28, 0.88);
      padding: 14px;
      display: none;
      flex-direction: column;
      gap: 12px;
    }

    .topup-methods-panel[aria-hidden="false"] {
      display: flex;
      animation: popoverFade var(--transition) ease;
    }

    .topup-methods-note {
      font-size: 11px;
      color: rgba(198, 206, 244, 0.75);
      line-height: 1.4;
    }

    .topup-methods-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 4px;
    }

    .topup-method-card {
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-start;
      padding: 12px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(64, 96, 202, 0.35);
      background: rgba(14, 17, 32, 0.92);
      color: rgba(218, 224, 255, 0.9);
      font-size: 12px;
      letter-spacing: 0.04em;
      cursor: pointer;
      transition: transform var(--transition), border-color var(--transition), box-shadow var(--transition);
    }

    .topup-method-card:hover,
    .topup-method-card:focus-visible {
      transform: translateY(-2px);
      border-color: rgba(108, 148, 255, 0.85);
      box-shadow: 0 16px 30px rgba(36, 52, 118, 0.45);
      outline: none;
    }

    .topup-method-card.is-active {
      border-color: rgba(140, 172, 255, 0.9);
      box-shadow: 0 18px 34px rgba(54, 78, 180, 0.5);
    }

    .topup-method-icon {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      background: rgba(47, 107, 255, 0.18);
      display: grid;
      place-items: center;
      color: #b8c8ff;
      font-size: 14px;
    }

    .topup-method-name {
      font-weight: 600;
      color: #e5eaff;
    }

    .topup-method-note {
      font-size: 11px;
      color: rgba(198, 206, 244, 0.75);
    }

    .topup-methods-panel .topup-row {
      gap: 8px;
    }

    .topup-methods-panel .topup-amount-btn {
      flex: 1 1 120px;
      padding: 10px 12px;
      font-size: 12px;
    }

    .topup-methods-panel .topup-amount-btn small {
      font-size: 10px;
    }

    .topup-summary.topup-summary-compact {
      font-size: 12px;
      flex-direction: column;
      align-items: flex-start;
    }

    .topup-actions.topup-actions-compact {
      flex-direction: column;
    }

    .mix-popover {
      min-width: 320px;
      max-width: 380px;
      padding: 18px;
    }

    .mix-events-list {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .mix-event-card {
      border-radius: var(--radius-md);
      border: 1px solid rgba(255, 173, 110, 0.28);
      background: rgba(20, 12, 24, 0.9);
      padding: 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .mix-event-card[data-status="active"] {
      border-color: rgba(255, 204, 128, 0.6);
      box-shadow: 0 18px 34px rgba(255, 158, 92, 0.35);
    }

    .mix-event-title {
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.04em;
      color: #ffe7d0;
    }

    .mix-event-status {
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(255, 221, 189, 0.85);
    }

    .mix-event-status span {
      font-weight: 600;
      color: #ffd19d;
    }

    .mix-event-description {
      font-size: 12px;
      color: rgba(255, 224, 209, 0.82);
    }

    .mix-event-stats {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 12px;
      color: rgba(255, 232, 220, 0.9);
    }

    .mix-event-toplist {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
      color: rgba(255, 232, 220, 0.85);
    }

    .mix-event-toplist span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .mix-event-toplist span::before {
      content: "‚Ä¢";
      opacity: 0.6;
    }

    .mix-popover .users-popover-empty {
      color: rgba(255, 224, 209, 0.72);
    }

    .header-popover::before {
      content: "";
      position: absolute;
      top: -8px;
      right: 18px;
      width: 16px;
      height: 16px;
      transform: rotate(45deg);
      background: inherit;
      border-left: 1px solid rgba(47, 107, 255, 0.28);
      border-top: 1px solid rgba(47, 107, 255, 0.28);
      pointer-events: none;
      z-index: -1;
    }

    .header-popover[data-open="true"] {
      display: flex;
      animation: popoverFade var(--transition) ease;
    }

    .popover-sections {
      border-top: 1px solid var(--border);
      padding-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .popover-sections-title {
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(198, 206, 244, 0.8);
    }

    .popover-sections-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 8px;
    }

    .popover-section-card {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(82, 112, 210, 0.32);
      background: rgba(14, 17, 32, 0.9);
      color: #e4e9ff;
      transition: transform var(--transition), border-color var(--transition), box-shadow var(--transition);
    }

    .popover-section-card:hover,
    .popover-section-card:focus-visible {
      transform: translateY(-1px);
      border-color: rgba(122, 154, 255, 0.7);
      box-shadow: 0 14px 24px rgba(34, 48, 114, 0.45);
      outline: none;
    }

    .popover-section-icon {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      background: rgba(47, 107, 255, 0.2);
      display: grid;
      place-items: center;
      color: #b9c8ff;
    }

    .popover-section-body {
      display: flex;
      flex-direction: column;
      gap: 2px;
      align-items: flex-start;
    }

    .popover-section-title {
      font-weight: 700;
      letter-spacing: 0.04em;
    }

    .popover-section-note {
      font-size: 11px;
      color: rgba(198, 206, 244, 0.76);
    }

    @keyframes popoverFade {
      from {
        opacity: 0;
        transform: translateY(-6px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .popover-header {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .popover-title {
      font-size: 13px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
    }

    .popover-sub {
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.06em;
    }

    .popover-text, .popover-footnote {
      font-size: 12px;
      color: rgba(240, 243, 255, 0.78);
      line-height: 1.45;
    }

    .popover-footnote {
      border-top: 1px solid rgba(47, 107, 255, 0.12);
      padding-top: 10px;
      margin-top: 6px;
      font-size: 11px;
      color: var(--muted);
    }

    .popover-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .popover-actions .btn {
      flex: 1 1 auto;
      min-width: 120px;
      justify-content: center;
    }

    .popover-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 8px;
    }

    .popover-form input {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(47, 107, 255, 0.3);
      background: rgba(7, 9, 18, 0.9);
      color: var(--text);
      font-size: 13px;
    }

    .popover-form input:focus-visible {
      outline: 2px solid rgba(47, 107, 255, 0.6);
      outline-offset: 1px;
    }

    .admin-login {
      border-radius: 12px;
      border: 1px solid rgba(47, 107, 255, 0.24);
      padding: 10px 12px;
      background: rgba(8, 10, 22, 0.92);
    }

    .admin-login summary {
      cursor: pointer;
      font-size: 12px;
      color: rgba(195, 204, 255, 0.86);
      letter-spacing: 0.06em;
    }

    .admin-login[open] summary {
      margin-bottom: 8px;
      color: #f0f3ff;
    }

    .login-methods {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .login-method-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(64, 92, 196, 0.32);
      background: rgba(12, 14, 26, 0.9);
      color: #e4e9ff;
      font-size: 12px;
      cursor: pointer;
      transition: border-color var(--transition), transform var(--transition), box-shadow var(--transition);
    }

    .login-method-btn:hover,
    .login-method-btn:focus-visible {
      border-color: rgba(114, 148, 255, 0.72);
      box-shadow: 0 12px 26px rgba(32, 46, 108, 0.45);
      transform: translateY(-1px);
      outline: none;
    }

    .login-method-icon {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      background: rgba(47, 107, 255, 0.2);
      display: grid;
      place-items: center;
      color: #b9c8ff;
      font-size: 14px;
    }

    .login-method-body {
      display: flex;
      flex-direction: column;
      gap: 2px;
      align-items: flex-start;
    }

    .login-method-name {
      font-weight: 600;
    }

    .login-method-note {
      font-size: 11px;
      color: rgba(198, 206, 244, 0.75);
    }

    .profile-popover-section {
      display: none;
      flex-direction: column;
      gap: 12px;
    }

    .profile-popover-section.is-visible {
      display: flex;
    }

    .popover-avatar {
      width: 48px;
      height: 48px;
      border-radius: 16px;
      background-image: var(--popover-avatar-image, linear-gradient(140deg, rgba(47, 107, 255, 0.32), rgba(18, 22, 40, 0.9)));
      background-size: cover;
      background-position: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #e4e9ff;
      letter-spacing: 0.08em;
      margin-bottom: 4px;
      overflow: hidden;
    }

    .popover-avatar.has-image {
      color: transparent;
      box-shadow: 0 12px 28px rgba(12, 18, 34, 0.55);
    }

    .popover-balance {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(47, 107, 255, 0.18);
      background: rgba(15, 18, 32, 0.9);
    }

    .popover-meta {
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.04em;
    }

    .popover-balance-value {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.08em;
    }

    .profile-empty {
      position: relative;
      z-index: 1;
      border-radius: var(--radius-lg);
      border: 1px dashed rgba(47, 107, 255, 0.4);
      background: rgba(10, 13, 26, 0.8);
      padding: 24px;
      color: rgba(220, 225, 255, 0.8);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .profile-empty h3 {
      font-size: 16px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #dce2ff;
    }

    .profile-empty p {
      font-size: 13px;
      line-height: 1.6;
    }

    .profile-role {
      font-size: 12px;
      color: var(--muted);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .nav-toggle {
      display: none;
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(7, 8, 15, 0.9);
      color: var(--muted);
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .hero {
      display: flex;
      gap: 26px;
      margin-bottom: 40px;
      align-items: center;
      flex-wrap: wrap;
    }

    .hero-left {
      display: flex;
      align-items: center;
      gap: 18px;
      flex: 1 1 260px;
      min-width: 0;
    }

    .hero-avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background-image: url("img/avzalov.jpg");
      background-size: cover;
      background-position: center 40%;
      position: relative;
      overflow: hidden;
      filter: blur(0.6px) contrast(1.05) saturate(1.02);
      box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.07), 0 14px 30px rgba(0, 0, 0, 0.7);
      flex-shrink: 0;
    }

    .hero-avatar::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 0, rgba(255, 255, 255, 0.24), transparent 55%);
      mix-blend-mode: screen;
      opacity: 0.8;
    }

    .hero-avatar-label {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      letter-spacing: 0.26em;
      text-transform: uppercase;
      color: #f5f6ff;
      text-align: center;
      padding: 0 14px;
      background: radial-gradient(circle at 50% 120%, rgba(0, 0, 0, 0.55), transparent 55%);
    }

    .hero-main {
      flex: 2 1 320px;
      min-width: 0;
    }

    .hero-title {
      font-size: clamp(26px, 4.6vw, 38px);
      font-weight: 800;
      letter-spacing: 0.07em;
      text-transform: uppercase;
      margin-bottom: 10px;
    }

    .hero-subtitle {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .hero-subtitle span {
      color: #d9defb;
      font-weight: 600;
    }

    .hero-text {
      font-size: 15px;
      color: var(--muted);
      max-width: 520px;
      margin-bottom: 22px;
    }

    .hero-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .tag {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid rgba(89, 109, 184, 0.45);
      background: radial-gradient(circle at top, rgba(92, 134, 255, 0.09), rgba(10, 12, 24, 0.9));
      color: var(--muted);
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .btn {
      border-radius: 999px;
      padding: 11px 20px;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: transform var(--transition), box-shadow var(--transition), background var(--transition), color var(--transition);
    }

    .btn-primary {
      background: linear-gradient(135deg, #2f6bff, #6d9dff);
      color: #fff;
      box-shadow: 0 16px 40px rgba(47, 107, 255, 0.45);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 22px 50px rgba(47, 107, 255, 0.55);
    }

    .btn-ghost {
      background: rgba(7, 9, 18, 0.9);
      border: 1px solid var(--border);
      color: var(--muted);
    }

    .btn-ghost:hover {
      background: rgba(18, 22, 34, 0.96);
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 12px;
    }

    .btn-xs {
      padding: 6px 12px;
      font-size: 11px;
    }

    section {
      margin-bottom: 40px;
    }

    .section-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 16px;
    }

    .section-title {
      font-size: 18px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
    }

    .section-sub {
      font-size: 12px;
      color: var(--muted);
    }

    .moscow-time {
      font-size: 12px;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .moscow-time i {
      color: var(--accent);
    }

    .users-directory {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
    }

    .user-card {
      border-radius: var(--radius-md);
      border: 1px solid rgba(68, 94, 186, 0.28);
      background: rgba(10, 12, 24, 0.88);
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      box-shadow: 0 16px 30px rgba(8, 10, 22, 0.55);
    }

    .user-card-header {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .user-avatar {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background-image: var(--user-avatar-image, linear-gradient(140deg, rgba(47, 107, 255, 0.28), rgba(18, 22, 40, 0.9)));
      background-size: cover;
      background-position: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #dfe4ff;
      letter-spacing: 0.04em;
      overflow: hidden;
      transition: transform var(--transition), box-shadow var(--transition);
    }

    .user-avatar.has-image {
      color: transparent;
      box-shadow: 0 10px 24px rgba(12, 16, 32, 0.55);
    }

    .user-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .user-name {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.04em;
    }

    .user-id {
      font-size: 12px;
      color: var(--muted);
    }

    .user-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      font-size: 12px;
      color: rgba(198, 204, 238, 0.78);
    }

    .user-stat-badge {
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(47, 107, 255, 0.12);
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }

    .user-stat-badge i {
      font-size: 12px;
    }

    .users-empty {
      font-size: 13px;
      color: rgba(160, 168, 210, 0.8);
    }

    /* –ü—Ä–æ—Ñ–∏–ª—å / –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç */
    .profile-wrapper {
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      background: radial-gradient(circle at top, rgba(47, 107, 255, 0.16), rgba(5, 6, 12, 0.98));
      padding: 20px 20px 22px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 18px;
      position: relative;
      overflow: hidden;
    }

    .profile-wrapper::before {
      content: "";
      position: absolute;
      inset: -40% -10% auto;
      height: 140%;
      background: radial-gradient(circle at top right, rgba(86, 121, 255, 0.25), transparent 70%);
      pointer-events: none;
    }

    .profile-panel {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .admin-tools {
      border-radius: var(--radius-md);
      border: 1px solid rgba(88, 118, 214, 0.32);
      background: rgba(12, 14, 26, 0.92);
      padding: 16px;
      display: none;
      flex-direction: column;
      gap: 12px;
    }

    .admin-tools.is-visible {
      display: flex;
    }

    .admin-tools h4 {
      font-size: 13px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #d4ddff;
    }

    .admin-gift-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
    }

    .admin-gift-form input {
      padding: 8px 12px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(70, 96, 190, 0.32);
      background: rgba(8, 10, 20, 0.9);
      color: var(--text);
      font-size: 12px;
    }

    .admin-gift-form button {
      border-radius: var(--radius-md);
      border: 1px solid rgba(86, 118, 224, 0.4);
      background: linear-gradient(140deg, rgba(47, 107, 255, 0.6), rgba(68, 198, 180, 0.6));
      color: #f5f6ff;
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 10px 14px;
      cursor: pointer;
      transition: transform var(--transition), box-shadow var(--transition);
    }

    .admin-gift-form button:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 32px rgba(58, 122, 240, 0.35);
    }

    .profile-main {
      display: flex;
      gap: 20px;
      align-items: flex-start;
      padding: 14px 16px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(68, 94, 186, 0.28);
      background: rgba(9, 12, 24, 0.9);
      box-shadow: 0 18px 32px rgba(6, 8, 16, 0.55);
    }

    .profile-avatar-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .profile-avatar {
      position: relative;
      width: 80px;
      height: 80px;
      border-radius: 28px;
      background-image: var(--profile-avatar-image, linear-gradient(140deg, rgba(47, 107, 255, 0.45), rgba(34, 20, 69, 0.8)));
      background-size: cover;
      background-position: center;
      box-shadow: 0 14px 32px rgba(0, 0, 0, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      transition: transform var(--transition), box-shadow var(--transition);
    }

    .profile-avatar::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.18), transparent 55%);
      opacity: 0.6;
      pointer-events: none;
      transition: opacity var(--transition);
    }

    .profile-avatar.has-image::after {
      opacity: 0;
    }

    .profile-avatar:hover {
      transform: translateY(-2px);
      box-shadow: 0 18px 36px rgba(15, 22, 48, 0.7);
    }

    .profile-avatar-initials {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.08em;
      color: rgba(229, 235, 255, 0.92);
      text-transform: uppercase;
      transition: opacity var(--transition);
    }

    .profile-avatar.has-image .profile-avatar-initials {
      opacity: 0;
    }

    .profile-avatar-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .profile-avatar-actions .btn-xs {
      padding-inline: 10px;
    }

    .profile-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .profile-name {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.04em;
    }

    .profile-id {
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .profile-coins {
      font-size: 13px;
      margin-top: 2px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .coins-amount {
      font-weight: 700;
      color: #ffd56a;
    }

    .profile-actions-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }

    .profile-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .profile-tab-btn {
      border-radius: 999px;
      padding: 8px 18px;
      border: 1px solid rgba(88, 112, 198, 0.38);
      background: rgba(12, 15, 30, 0.75);
      color: rgba(206, 213, 248, 0.82);
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background var(--transition), border-color var(--transition), color var(--transition), box-shadow var(--transition);
    }

    .profile-tab-btn.is-active,
    .profile-tab-btn:focus-visible {
      background: rgba(47, 107, 255, 0.22);
      border-color: rgba(108, 148, 255, 0.65);
      color: #f5f7ff;
      box-shadow: 0 16px 34px rgba(47, 107, 255, 0.35);
      outline: none;
    }

    .profile-views {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .profile-view {
      display: none;
    }

    .profile-view.is-active {
      display: block;
    }

    .profile-overview-grid {
      display: grid;
      gap: 16px;
    }

    .profile-overview-callout {
      padding: 14px 16px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(96, 120, 210, 0.3);
      background: rgba(12, 16, 34, 0.85);
      font-size: 13px;
      color: rgba(211, 217, 255, 0.82);
      line-height: 1.5;
    }

    .profile-achievements h4 {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      margin-bottom: 8px;
      color: #d4ddff;
    }

    .achievements-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .achievement-card {
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(5, 7, 15, 0.96);
      padding: 8px 9px;
      font-size: 11px;
      color: #c4c8e4;
      position: relative;
      overflow: hidden;
    }

    .stats-card {
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      background: rgba(9, 11, 21, 0.95);
      padding: 18px 20px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .stats-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
    }

    .stat-block {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 12px 14px;
      border-radius: var(--radius-md);
      background: rgba(18, 22, 38, 0.9);
      border: 1px solid rgba(92, 118, 210, 0.35);
    }

    .stat-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: rgba(189, 196, 235, 0.75);
    }

    .stat-value {
      font-size: 22px;
      font-weight: 700;
      color: #f4f5ff;
    }

    .stat-subvalue {
      font-size: 12px;
      color: rgba(198, 205, 245, 0.7);
    }

    .stats-divider {
      height: 1px;
      background: rgba(82, 96, 150, 0.4);
      border-radius: 999px;
    }

    .recent-plays {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .recent-plays-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .recent-plays-header h3 {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #d9defb;
    }

    .recent-plays-note {
      font-size: 11px;
      color: rgba(154, 160, 196, 0.75);
    }

    .recent-plays-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin: 0;
      padding: 0;
    }

    .recent-plays-item {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: baseline;
      font-size: 12px;
      color: rgba(206, 212, 242, 0.88);
      padding: 8px 10px;
      border-radius: var(--radius-md);
      background: rgba(16, 20, 36, 0.9);
      border: 1px solid rgba(76, 102, 189, 0.28);
    }

    .recent-track {
      font-weight: 600;
      color: #eef1ff;
    }

    .recent-time {
      font-size: 11px;
      color: rgba(165, 174, 220, 0.8);
      white-space: nowrap;
    }

    .recent-plays-empty {
      font-size: 12px;
      color: rgba(165, 174, 220, 0.75);
      padding: 6px 0;
    }

    .history-card {
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      background: rgba(9, 11, 21, 0.95);
      padding: 18px 20px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .history-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
    }

    .history-summary-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      background: rgba(16, 18, 30, 0.9);
      border: 1px solid rgba(82, 110, 198, 0.3);
    }

    .summary-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: rgba(164, 173, 214, 0.7);
    }

    .summary-value {
      font-size: 16px;
      font-weight: 700;
      color: #f5f6ff;
    }

    .history-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 220px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .history-entry {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      background: rgba(14, 16, 28, 0.9);
      border: 1px solid rgba(70, 92, 180, 0.25);
      font-size: 12px;
      color: rgba(204, 210, 240, 0.85);
    }

    .history-entry-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
    }

    .history-entry-title {
      font-weight: 600;
      color: #eef1ff;
    }

    .history-entry-delta {
      font-weight: 600;
    }

    .history-entry-delta.is-positive {
      color: #3ce39a;
    }

    .history-entry-delta.is-negative {
      color: #ff9d6f;
    }

    .history-entry-delta.is-pending {
      color: rgba(198, 206, 244, 0.75);
      font-style: italic;
    }

    .history-entry-time {
      font-size: 11px;
      color: rgba(170, 178, 220, 0.75);
    }

    .history-empty {
      font-size: 12px;
      color: rgba(164, 173, 214, 0.75);
      padding: 6px 0;
    }

    #payments {
      position: relative;
    }

    .section-hidden {
      display: none;
    }

    .topup-card {
      border-radius: var(--radius-lg);
      border: 1px solid rgba(72, 98, 188, 0.32);
      background: radial-gradient(circle at top, rgba(58, 98, 240, 0.14), rgba(6, 8, 18, 0.95));
      padding: 20px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 18px;
      position: relative;
      overflow: hidden;
    }

    .topup-card::before {
      content: "";
      position: absolute;
      inset: -30% auto auto -20%;
      width: 320px;
      height: 320px;
      background: radial-gradient(circle, rgba(104, 142, 255, 0.3), transparent 70%);
      pointer-events: none;
    }

    .topup-card::after {
      content: "";
      position: absolute;
      inset: auto -10% -40% auto;
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, rgba(255, 168, 92, 0.25), transparent 70%);
      pointer-events: none;
    }

    .topup-content {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .topup-rows {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .topup-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .topup-amount-btn {
      flex: 1 1 140px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(86, 112, 204, 0.4);
      background: rgba(11, 14, 28, 0.92);
      color: #f4f6ff;
      padding: 12px 16px;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      display: flex;
      flex-direction: column;
      gap: 4px;
      align-items: flex-start;
      cursor: pointer;
      transition: transform var(--transition), border-color var(--transition), background var(--transition), box-shadow var(--transition);
    }

    .topup-amount-btn small {
      font-size: 11px;
      letter-spacing: 0.04em;
      text-transform: none;
      color: rgba(196, 204, 245, 0.78);
    }

    .topup-amount-btn:hover,
    .topup-amount-btn:focus-visible {
      border-color: rgba(144, 176, 255, 0.6);
      background: rgba(22, 30, 58, 0.96);
      box-shadow: 0 18px 32px rgba(48, 72, 166, 0.45);
      transform: translateY(-1px);
      outline: none;
    }

    .topup-amount-btn.active {
      border-color: rgba(176, 205, 255, 0.7);
      background: rgba(32, 44, 90, 0.98);
      box-shadow: 0 20px 38px rgba(60, 90, 180, 0.48);
    }

    .topup-summary {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      font-size: 13px;
      color: rgba(198, 206, 244, 0.85);
    }

    .topup-summary strong {
      color: #f5f6ff;
    }

    .topup-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .btn-disabled {
      background: rgba(16, 18, 30, 0.92);
      border: 1px dashed rgba(126, 142, 200, 0.6);
      color: rgba(182, 190, 232, 0.85);
      cursor: not-allowed;
      box-shadow: none;
    }

    .btn-disabled:hover,
    .btn-disabled:focus-visible {
      transform: none;
      box-shadow: none;
      border-color: rgba(152, 168, 226, 0.65);
    }

    .topup-btn-main,
    .topup-btn-real {
      flex: 1 1 220px;
      justify-content: center;
    }

    .topup-note {
      position: relative;
      z-index: 1;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.5;
    }

    .achievement-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top left, rgba(87, 133, 255, 0.32), transparent 65%);
      opacity: 0;
      transition: opacity 160ms ease;
    }

    .achievement-card.unlocked::before {
      opacity: 1;
    }

    .achievement-title {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .achievement-desc {
      font-size: 10px;
      color: rgba(189, 195, 232, 0.85);
    }

    .achievement-badge {
      position: absolute;
      top: 6px;
      right: 7px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #3ce39a;
    }

    .tracks-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 24px;
    }

    .track-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .tracks-carousel-shell {
      position: relative;
      display: flex;
      align-items: stretch;
      gap: 10px;
      padding: 0 32px;
    }

    .tracks-carousel-shell::before, .tracks-carousel-shell::after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      width: 42px;
      pointer-events: none;
      z-index: 1;
    }

    .tracks-carousel-shell::before {
      left: 32px;
      background: linear-gradient(90deg, rgba(5, 6, 10, 0.85), transparent);
    }

    .tracks-carousel-shell::after {
      right: 32px;
      background: linear-gradient(270deg, rgba(5, 6, 10, 0.85), transparent);
    }

    .tracks-carousel {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding: 12px 4px 24px;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
    }

    .tracks-carousel::-webkit-scrollbar {
      display: none;
    }

    .carousel-arrow {
      width: 46px;
      height: 100%;
      border-radius: 16px;
      border: 1px solid rgba(85, 108, 203, 0.45);
      background: rgba(18, 24, 46, 0.8);
      color: #f9f9ff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background var(--transition), transform 200ms ease;
      z-index: 2;
    }

    .carousel-arrow i {
      font-size: 18px;
    }

    .carousel-arrow:hover {
      background: rgba(53, 72, 141, 0.95);
      transform: translateY(-2px);
    }

    .tracks-carousel .track-card {
      flex: 0 0 calc(82vw - 48px);
      max-width: 360px;
      min-width: 260px;
      scroll-snap-align: start;
    }

    @media (min-width: 600px) {
      .tracks-carousel .track-card {
        flex: 0 0 calc(50vw - 60px);
      }
    }

    @media (min-width: 960px) {
      .tracks-carousel .track-card {
        flex: 0 0 320px;
      }
    }

    @media (min-width: 1280px) {
      .tracks-carousel .track-card {
        flex: 0 0 340px;
      }
    }

    .track-card {
      --lift: 0px;
      --tilt-x: 0deg;
      --tilt-y: 0deg;
      --glow-x: 50%;
      --glow-y: 50%;
      position: relative;
      background: linear-gradient(140deg, rgba(30, 39, 84, 0.8), rgba(12, 15, 30, 0.95));
      border-radius: 20px;
      border: 1px solid rgba(68, 95, 189, 0.25);
      padding: 18px 18px 20px;
      display: flex;
      gap: 18px;
      align-items: center;
      box-shadow: 0 18px 40px rgba(5, 8, 20, 0.55);
      transition: transform 160ms ease, box-shadow 220ms ease, border-color 220ms ease, filter 200ms ease;
      overflow: hidden;
      transform-style: preserve-3d;
      transform: perspective(1200px) rotateX(var(--tilt-x)) rotateY(var(--tilt-y)) translate3d(0, var(--lift), 0);
      will-change: transform;
    }

    .track-card::before {
      content: "";
      position: absolute;
      inset: 1px;
      border-radius: 18px;
      background: radial-gradient(circle at top left, rgba(86, 131, 255, 0.28), transparent 60%);
      opacity: 0;
      transition: opacity 220ms ease;
      pointer-events: none;
    }

    .track-card::after {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(
        circle at var(--glow-x) var(--glow-y),
        rgba(47, 107, 255, 0.28),
        transparent 65%
      );
      opacity: 0;
      transition: opacity 220ms ease;
      pointer-events: none;
    }

    .track-card:hover {
      --lift: -12px;
      box-shadow: 0 26px 50px rgba(8, 12, 32, 0.6);
      border-color: rgba(86, 131, 255, 0.45);
    }

    .track-card.is-highlighted {
      border-color: rgba(86, 131, 255, 0.85);
      box-shadow: 0 28px 56px rgba(47, 107, 255, 0.35);
    }

    .track-card:hover::before,
    .track-card.playing::before,
    .track-card.playing::after {
      opacity: 1;
    }

    .track-card.audio-error {
      border-color: rgba(255, 122, 122, 0.55);
      box-shadow: 0 18px 36px rgba(255, 76, 76, 0.25);
    }

    .track-card.audio-error .play-overlay {
      background: radial-gradient(circle at center, rgba(255, 120, 120, 0.35), rgba(10, 12, 20, 0.95));
    }

    .track-card.audio-error .time-display {
      color: #ff9f9f;
    }

    .track-card.playing {
      --lift: -16px;
      border-color: rgba(61, 208, 156, 0.7);
      box-shadow: 0 28px 60px rgba(30, 215, 160, 0.3);
    }

    .track-card[data-status="ep"] {
      border-color: rgba(118, 146, 238, 0.45);
      box-shadow: 0 22px 48px rgba(32, 42, 92, 0.65);
    }

    .track-card[data-status="soon"] {
      border-color: rgba(255, 189, 97, 0.45);
      box-shadow: 0 22px 46px rgba(255, 168, 72, 0.2);
    }

    .track-card[data-status="soon"] .track-meta span:last-child {
      color: rgba(255, 208, 138, 0.9);
    }

    .track-card[data-has-audio="false"] .track-cover,
    .track-card[data-has-audio="false"] .track-play-toggle {
      cursor: default;
    }

    .track-card[data-has-audio="false"] .play-overlay {
      display: none;
    }

    .track-card[data-has-audio="false"] .track-play-toggle:hover,
    .track-card[data-has-audio="false"] .track-play-toggle:active {
      transform: none;
      box-shadow: none;
    }

    .track-card[data-has-audio="false"] .track-play-toggle {
      background: linear-gradient(140deg, rgba(90, 96, 140, 0.55), rgba(64, 69, 104, 0.8));
      box-shadow: none;
    }

    .track-card[data-has-audio="false"] .time-display {
      font-size: 11px;
      color: rgba(200, 205, 235, 0.65);
    }

    .player-controls.is-disabled {
      opacity: 0.75;
      filter: saturate(0.75);
    }

    .player-controls.is-disabled .track-play-toggle,
    .player-controls.is-disabled .progress-bar {
      cursor: not-allowed;
    }

    .track-card.track-locked {
      border-color: rgba(255, 189, 97, 0.45);
      box-shadow: 0 22px 46px rgba(255, 168, 72, 0.2);
      filter: saturate(0.85);
    }

    .track-card.track-locked .track-cover::after {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(7, 10, 20, 0.58);
      backdrop-filter: blur(2px);
    }

    .track-card.track-locked .play-overlay {
      opacity: 1;
    }

    .track-card.track-locked .player-controls {
      opacity: 0.55;
      pointer-events: none;
    }

    .track-card.track-locked .track-locked-note {
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(255, 207, 143, 0.85);
      margin-bottom: 10px;
    }

    .track-locked-note.is-hidden {
      display: none;
    }

    .track-card.track-locked .unlock-btn {
      border-color: rgba(255, 196, 120, 0.75);
      background: rgba(40, 24, 5, 0.7);
      color: #ffd68a;
      box-shadow: 0 8px 22px rgba(255, 176, 80, 0.25);
    }

    .track-card.track-locked .unlock-btn:hover {
      background: linear-gradient(130deg, rgba(255, 203, 122, 0.2), rgba(255, 176, 80, 0.35));
      border-color: rgba(255, 213, 150, 0.85);
    }

    .track-cover {
      position: relative;
      width: 96px;
      height: 96px;
      border-radius: 16px;
      background-size: cover;
      background-position: center;
      background-color: #1b2031;
      flex-shrink: 0;
      overflow: hidden;
      cursor: pointer;
    }

    .track-cover::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(160deg, rgba(255, 255, 255, 0.18), transparent 55%);
      mix-blend-mode: screen;
    }

    .track-cover .play-overlay {
      position: absolute;
      inset: 0;
      background: rgba(6, 9, 20, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      color: #eef2ff;
      opacity: 0;
      transition: opacity var(--transition);
      backdrop-filter: blur(4px);
    }

    .track-card:hover .track-cover .play-overlay,
    .track-card.playing .track-cover .play-overlay {
      opacity: 1;
    }

    .track-info {
      flex: 1;
      min-width: 0;
      position: relative;
      z-index: 1;
    }

    .track-title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 6px;
    }

    .track-title {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.02em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .track-stats {
      display: flex;
      align-items: center;
      gap: 16px;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .track-user-plays {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(30, 40, 78, 0.55);
      border: 1px solid rgba(90, 118, 204, 0.35);
      color: rgba(218, 224, 255, 0.9);
    }

    .track-user-plays span {
      font-weight: 700;
      color: #f2f4ff;
      letter-spacing: 0.04em;
    }
    .track-like-btn, .track-plays {
        display: flex;
        align-items: center;
        gap: 6px;
    }
    .track-like-btn {
        background: none;
        border: none;
        color: inherit;
        cursor: pointer;
        padding: 0;
    }
    .track-like-btn.is-liked {
        color: #ff6b81;
    }
    .track-price {
        font-size: 12px;
        color: #ffd56a;
        margin-bottom: 12px;
    }
    .track-price .ruzcoin-icon {
        width: 16px;
        height: 16px;
        font-size: 8px;
        margin-right: 4px;
        vertical-align: middle;
    }
    .track-copyright {
        font-size: 10px;
        color: var(--muted);
        opacity: 0.7;
        margin-top: 12px;
        border-top: 1px solid var(--border);
        padding-top: 8px;
    }

    .track-card.playing .track-title {
      color: #effffc;
    }

    .track-badge {
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.07);
      color: var(--muted);
      white-space: nowrap;
      flex-shrink: 0;
    }

    .track-badge.public {
      background: rgba(65, 193, 120, 0.18);
      color: #b6f7d5;
    }

    .track-badge.early-access {
      background: rgba(47, 107, 255, 0.18);
      color: #adc3ff;
    }

    .track-badge.upcoming {
      background: rgba(255, 166, 0, 0.2);
      color: #ffe0a3;
    }

    .track-meta {
      font-size: 12px;
      color: rgba(206, 212, 242, 0.8);
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .track-clip-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(47, 107, 255, 0.12);
      color: rgba(186, 201, 255, 0.9);
    }

    .track-clip-indicator.is-missing {
      background: rgba(120, 126, 160, 0.14);
      color: rgba(160, 170, 210, 0.7);
    }

    .track-clip-indicator i {
      font-size: 12px;
    }

    .track-card.upcoming .track-meta {
      margin-bottom: 8px;
      opacity: 0.85;
    }

    .dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(206, 212, 242, 0.4);
    }

    .track-divider {
      padding: 6px 4px 0;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(166, 173, 215, 0.78);
    }

    .track-divider-meta {
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }


    .track-divider .track-divider-meta {
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: none;
      color: rgba(199, 204, 236, 0.7);
    }

    .player-controls {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 14px;
    }

    .track-play-toggle {
      width: 46px;
      height: 46px;
      border-radius: 14px;
      border: none;
      background: linear-gradient(140deg, #2f6bff, #8aa2ff);
      box-shadow: 0 18px 30px rgba(47, 107, 255, 0.45);
      color: #f8f9ff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      transition: transform 180ms ease, box-shadow 180ms ease;
    }

    .track-play-toggle:hover {
      transform: translateY(-2px);
      box-shadow: 0 22px 40px rgba(47, 107, 255, 0.6);
    }

    .track-play-toggle:active {
      transform: translateY(0);
    }

    .progress-bar-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .progress-bar {
      position: relative;
      width: 100%;
      height: 5px;
      border-radius: 999px;
      background: rgba(86, 97, 140, 0.35);
      overflow: hidden;
      cursor: pointer;
    }

    .progress-bar::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, rgba(76, 112, 255, 0.18), transparent);
    }

    .progress-bar-filled {
      height: 100%;
      border-radius: inherit;
      width: 0;
      background: linear-gradient(90deg, #2f6bff, #3ed39a);
      box-shadow: 0 0 16px rgba(47, 107, 255, 0.35);
    }

    .time-display {
      font-size: 11px;
      color: rgba(192, 199, 228, 0.75);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .track-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .track-action-btn {
      border: 1px solid rgba(95, 124, 220, 0.35);
      color: #dfe4ff;
      background: rgba(15, 18, 34, 0.85);
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 11px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      transition: background 180ms ease, color 180ms ease, border-color 180ms ease;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .track-action-btn:hover {
      background: linear-gradient(120deg, rgba(47, 107, 255, 0.25), rgba(30, 208, 160, 0.25));
      border-color: rgba(120, 196, 255, 0.6);
    }

    .track-action-btn[disabled] {
      opacity: 0.5;
      pointer-events: none;
    }


    .mini-player {
      position: fixed;
      right: 28px;
      bottom: 28px;
      width: min(420px, calc(100% - 32px));
      border-radius: 24px;
      background: linear-gradient(140deg, rgba(18, 24, 46, 0.96), rgba(32, 38, 74, 0.96));
      border: 1px solid rgba(92, 128, 248, 0.35);
      box-shadow: 0 30px 60px rgba(6, 10, 28, 0.75);
      padding: 18px 20px;
      z-index: 50;
      opacity: 0;
      pointer-events: none;
      transform: translateY(40px);
      transition: opacity 220ms ease, transform 220ms ease;
      backdrop-filter: blur(14px);
    }

    .mini-player.is-active {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .mini-player-inner {
      display: grid;
      grid-template-columns: auto 1fr;
      grid-template-areas:
        "track controls"
        "actions actions";
      gap: 16px;
      align-items: center;
    }

    .mini-player-track {
      grid-area: track;
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .mini-player-cover {
      width: 66px;
      height: 66px;
      border-radius: 16px;
      background-size: cover;
      background-position: center;
      background-color: #1c2238;
      box-shadow: 0 14px 24px rgba(23, 33, 70, 0.55);
    }

    .mini-player-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .mini-player-title {
      font-size: 15px;
      font-weight: 700;
      letter-spacing: 0.04em;
    }

    .mini-player-artist {
      font-size: 12px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: rgba(198, 204, 238, 0.75);
    }

    .mini-player-controls {
      grid-area: controls;
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: stretch;
    }

    .mini-player-buttons {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .mini-player-skip-btn,
    .mini-player-play-btn {
      width: 48px;
      height: 48px;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: rgba(255, 255, 255, 0.06);
      color: #f4f6ff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      box-shadow: 0 12px 26px rgba(32, 178, 170, 0.18);
      transition: transform 180ms ease, box-shadow 180ms ease, background 180ms ease, border-color 180ms ease;
    }

    .mini-player-play-btn {
      width: 52px;
      height: 52px;
      border-radius: 16px;
      background: linear-gradient(140deg, #2f6bff, #46d5a0);
      border: none;
      box-shadow: 0 24px 40px rgba(32, 178, 170, 0.35);
    }

    .mini-player-skip-btn:hover,
    .mini-player-play-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 26px 50px rgba(72, 178, 255, 0.35);
      border-color: rgba(255, 255, 255, 0.18);
      background: linear-gradient(140deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.02));
    }

    .mini-player-progress-wrapper {
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 10px;
      align-items: center;
      font-size: 12px;
      color: rgba(194, 202, 232, 0.75);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .mini-player-progress-wrapper .progress-bar {
      height: 6px;
    }

    .mini-player-actions {
      grid-area: actions;
      display: flex;
      gap: 14px;
      align-items: center;
      justify-content: flex-end;
    }

    .mini-player .track-action-btn {
      font-size: 10px;
      padding: 6px 12px;
    }

    .volume-control {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: rgba(198, 204, 238, 0.7);
      font-size: 14px;
    }

    .volume-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 110px;
      height: 4px;
      border-radius: 999px;
      background: rgba(95, 120, 200, 0.35);
      outline: none;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: linear-gradient(140deg, #2f6bff, #3ed39a);
      box-shadow: 0 0 12px rgba(63, 163, 255, 0.5);
      cursor: pointer;
    }

    .volume-slider::-moz-range-thumb {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: linear-gradient(140deg, #2f6bff, #3ed39a);
      box-shadow: 0 0 12px rgba(63, 163, 255, 0.5);
      border: none;
      cursor: pointer;
    }

    .lyrics-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(4, 6, 12, 0.75);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 200ms ease;
      z-index: 60;
    }

    .lyrics-modal-overlay.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .lyrics-modal {
      background: linear-gradient(160deg, rgba(17, 22, 38, 0.96), rgba(26, 32, 56, 0.96));
      border: 1px solid rgba(90, 120, 210, 0.4);
      border-radius: 22px;
      padding: 28px;
      width: min(540px, calc(100% - 48px));
      box-shadow: 0 40px 70px rgba(5, 8, 20, 0.65);
      position: relative;
      color: #e8ebff;
    }

    .lyrics-modal::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      border: 1px solid rgba(127, 156, 255, 0.35);
      pointer-events: none;
      opacity: 0.6;
    }

    .lyrics-modal.is-yashlek {
      background: radial-gradient(circle at top, rgba(21, 30, 66, 0.95), rgba(8, 12, 28, 0.95));
      border-color: rgba(122, 245, 227, 0.45);
      box-shadow: 0 24px 80px rgba(26, 244, 175, 0.35);
      animation: lyricsGlow 4s ease-in-out infinite;
    }

    .lyrics-modal.is-yashlek::before {
      border-color: rgba(175, 248, 255, 0.35);
      box-shadow: 0 0 32px rgba(108, 249, 255, 0.25);
    }

    .lyrics-title {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.04em;
      margin-bottom: 6px;
    }

    .lyrics-artist {
      font-size: 12px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: rgba(198, 204, 238, 0.6);
      margin-bottom: 18px;
    }

    .lyrics-text {
      max-height: 320px;
      overflow-y: auto;
      line-height: 1.6;
      color: rgba(220, 225, 255, 0.9);
      font-size: 14px;
    }

    .lyrics-text.is-yashlek {
      font-size: 15px;
      letter-spacing: 0.02em;
      color: rgba(244, 255, 250, 0.95);
      text-transform: none;
    }

    .lyrics-text::-webkit-scrollbar {
      width: 6px;
    }

    .lyrics-text::-webkit-scrollbar-thumb {
      background: rgba(95, 120, 200, 0.5);
      border-radius: 999px;
    }

    .lyrics-paragraph {
      margin: 0 0 12px;
      font-weight: 500;
      letter-spacing: 0.03em;
    }

    .lyrics-space {
      height: 12px;
    }

    .lyrics-line {
      position: relative;
      padding: 10px 0;
      font-size: 16px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      overflow: hidden;
    }

    .lyrics-line-main {
      position: relative;
      z-index: 2;
    }

    .lyrics-line-ghost {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      color: rgba(108, 255, 226, 0.25);
      transform: translate(6px, 6px);
      z-index: 1;
      transition: opacity 300ms ease, transform 300ms ease;
      pointer-events: none;
    }

    .lyrics-line.is-desync .lyrics-line-ghost {
      opacity: 0.9;
      transform: translate(-6px, -6px);
    }

    @keyframes lyricsGlow {
      0% {
        box-shadow: 0 24px 80px rgba(26, 244, 175, 0.35);
      }
      50% {
        box-shadow: 0 36px 90px rgba(104, 194, 255, 0.45);
      }
      100% {
        box-shadow: 0 24px 80px rgba(26, 244, 175, 0.35);
      }
    }

    .lyrics-close-btn {
      position: absolute;
      top: 16px;
      right: 18px;
      width: 34px;
      height: 34px;
      border-radius: 12px;
      border: none;
      background: rgba(16, 20, 38, 0.85);
      color: #dfe4ff;
      font-size: 24px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: background 180ms ease;
    }

    .lyrics-close-btn:hover {
      background: rgba(47, 107, 255, 0.4);
    }

    @media (max-width: 720px) {
      .profile-wrapper {
        padding: 18px;
      }

      .profile-main {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .profile-actions-row,
      .profile-tabs,
      .profile-tab-btn {
        width: 100%;
      }

      .profile-tab-btn {
        text-align: center;
      }

      .achievements-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .tracks-gallery-scroller {
        grid-auto-flow: row;
        grid-template-rows: none;
        grid-auto-rows: minmax(0, 1fr);
        grid-auto-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 640px) {
      .track-card {
        flex-direction: column;
        align-items: flex-start;
      }

      .track-cover {
        width: 100%;
        height: 200px;
      }

      .player-controls {
        width: 100%;
      }

      .mini-player {
        right: 16px;
        left: 16px;
        bottom: 18px;
        width: auto;
      }

      .mini-player-inner {
        grid-template-columns: 1fr;
        grid-template-areas:
          "track"
          "controls"
          "actions";
      }

      .mini-player-track {
        justify-content: space-between;
      }

      .mini-player-actions {
        justify-content: space-between;
      }

      .volume-slider {
        width: 90px;
      }
    }

    .news-list {
      display: grid;
      gap: 14px;
    }

    .news-item {
      padding: 12px 14px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: rgba(9, 11, 21, 0.9);
      box-shadow: 0 9px 20px rgba(0, 0, 0, 0.6);
      position: relative;
      overflow: hidden;
    }

    .news-item::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(68, 115, 255, 0.15), transparent 60%);
      opacity: 0.8;
      pointer-events: none;
    }

    .news-tag {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #9fb1ff;
      margin-bottom: 4px;
    }

    .news-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .news-meta {
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .news-text {
      font-size: 13px;
      color: #c5c9dd;
    }

    .about-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.4fr);
      gap: 24px;
    }

    .about-text {
      font-size: 14px;
      color: var(--muted);
    }

    .about-text p + p {
      margin-top: 10px;
    }

    .socials {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 14px;
    }

    .social-pill {
      font-size: 12px;
      border-radius: 999px;
      padding: 7px 12px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(9, 12, 24, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .about-card {
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      background: radial-gradient(circle at top, rgba(47, 107, 255, 0.18), rgba(5, 6, 12, 0.96));
      padding: 16px 18px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .about-card-title {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #d4ddff;
    }

    .about-card-stat-row {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      color: #c1c7e6;
    }

    .about-card-stat-row span:last-child {
      color: #f8f8ff;
      font-weight: 600;
    }

    footer {
      margin-top: 24px;
      padding-top: 18px;
      border-top: 1px solid #1a1f30;
      font-size: 11px;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    @media (max-width: 720px) {
      .site-header {
        padding: 16px;
        gap: 16px;
        top: 12px;
        transform: translateY(12px);
      }

      .header-popover {
        position: fixed;
        left: 16px;
        right: 16px;
        width: auto;
        max-width: none;
        top: calc(88px + env(safe-area-inset-top, 0px));
        max-height: 68vh;
      }

      .header-popover::before {
        display: none;
      }

      .header-actions {
        width: 100%;
        justify-content: center;
      }

      .header-action-group {
        flex: 1 1 160px;
        justify-content: center;
      }

      .mix-button-wrapper {
        width: 100%;
        order: 4;
      }

      .mix-button {
        width: 100%;
      }

      .hero {
        align-items: flex-start;
      }

      .hero-left {
        flex-direction: row;
      }
    }

    @media (max-width: 520px) {
      .hero-left {
        flex-direction: row;
      }

      .hero-actions {
        flex-direction: column;
        align-items: stretch;
      }

      .btn,
      .btn-ghost {
        justify-content: center;
        width: 100%;
      }
    }

    @media (max-width: 720px) {
      .site-header {
        align-items: center;
      }

      .site-header nav {
        flex: 1 1 100%;
      }

      .site-header nav {
        position: absolute;
        inset-inline: 16px;
        top: 60px;
        background: rgba(5, 7, 16, 0.98);
        border-radius: 14px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-soft);
        padding: 10px 14px 12px;
        flex-direction: column;
        gap: 10px;
        transform-origin: top right;
        transform: scaleY(0.8);
        opacity: 0;
        pointer-events: none;
        transition: opacity 160ms ease-out, transform 160ms ease-out;
        z-index: 20;
      }

      .site-header nav.nav-open {
        opacity: 1;
        pointer-events: auto;
        transform: scaleY(1);
      }

      .nav-toggle {
        display: inline-flex;
      }
    }

    @media (max-width: 520px) {
      .hero-actions {
        flex-direction: column;
        align-items: stretch;
      }

      .btn,
      .btn-ghost {
        justify-content: center;
        width: 100%;
      }

      .section-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
    <button id="scrollToTopBtn" class="scroll-to-top-btn">
      <i class="fas fa-arrow-up"></i>
    </button>
    <header class="site-header">
      <div class="logo-group">
        <div class="logo-mark">√ò</div>
        <div class="logo-text">
          <div class="logo-text-main">AVZAL√òV</div>
          <div class="logo-text-sub">–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤</div>
        </div>
      </div>

      <button class="nav-toggle" id="navToggle" aria-label="–ú–µ–Ω—é">
        ‚ò∞
      </button>

      <nav id="mainNav">
        <a href="#tracks">–†–µ–ª–∏–∑—ã</a>
        <a href="#clips">–ö–ª–∏–ø—ã</a>
        <a href="#users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
        <a href="#payments" data-nav-target="payments">–û–ø–ª–∞—Ç–∞</a>
        <a href="#news">–ù–æ–≤–æ—Å—Ç–∏</a>
        <a href="#about">–ë–∏–æ–≥—Ä–∞—Ñ–∏—è</a>
        <a href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
      </nav>
      <div class="mix-button-wrapper">
        <button class="mix-button" id="mixEventsBtn" type="button" aria-haspopup="dialog" aria-expanded="false">
          <span class="mix-label">MIX</span>
          <span class="mix-countdown" id="mixCountdownLabel">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</span>
        </button>
        <div class="header-popover mix-popover" id="mixEventsPopover" role="dialog" aria-hidden="true">
          <div class="popover-header">
            <div class="popover-title">MIX —Å–æ–±—ã—Ç–∏—è</div>
            <div class="popover-sub" id="mixPopoverStatus">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è‚Ä¶</div>
          </div>
          <div class="mix-events-list" id="mixEventsList">
            <p class="users-popover-empty">–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è‚Ä¶</p>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <div class="header-action-group">
          <button
            class="ruzcoin-chip"
            id="headerCoinsBtn"
            type="button"
            aria-haspopup="dialog"
            aria-expanded="false"
          >
            <div class="ruzcoin-icon" aria-hidden="true">
              <span class="ruzcoin-glyph">…å</span>
            </div>
            <div class="ruzcoin-info">
              <span class="ruzcoin-label">RUZCOIN</span>
              <span class="ruzcoin-value" id="headerCoinsAmount">0</span>
            </div>
          </button>
          <div class="header-popover coins-popover" id="headerCoinsPopover" role="dialog" aria-hidden="true">
            <div class="popover-header">
              <div class="popover-title">RUZCOIN</div>
              <div class="popover-sub">1 RUZCOIN = <span id="ruzcoinPriceValue">25 ‚ÇΩ</span></div>
            </div>
            <p class="popover-text">
              –í—ã–±–∏—Ä–∞–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ. –î–æ—Å—Ç—É–ø–Ω—ã –ø–ª–∞—Ç–µ–∂–∏ –∫–∞—Ä—Ç–æ–π, —á–µ—Ä–µ–∑ –°–ë–ü –∏–ª–∏ –∫–æ—à–µ–ª—ë–∫ –ÆMoney.
              –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–±—Ä–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ ¬´–û–ø–ª–∞—Ç–∞¬ª ‚Äî –æ—Ç–∫—Ä–æ–π –µ–≥–æ, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É.
            </p>
            <div class="popover-actions">
              <button class="btn btn-primary btn-xs" type="button" id="openPaymentsFromPopoverBtn">
                –û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª –æ–ø–ª–∞—Ç—ã
              </button>
              <button class="btn btn-ghost btn-xs" type="button" id="coinsInfoBtn">
                –ö–∞–∫ –ø–æ–ø–æ–ª–Ω–∏—Ç—å RUZCOIN
              </button>
            </div>
            <div class="popover-footnote">
              –í –ø—Ä–æ—Ñ–∏–ª–µ —Ç—ã —É–≤–∏–¥–∏—à—å –∏—Å—Ç–æ—Ä–∏—é –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π RUZCOIN –∏ –±–æ–Ω—É—Å—ã –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.
            </div>
          </div>
        </div>
        <div class="header-action-group">
            <button id="headerUsersBtn" class="header-action-btn" type="button" aria-label="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏" aria-haspopup="true" aria-expanded="false">
              <span id="headerUsersAvatar" class="header-profile-avatar" style="font-size: 14px;">
                <i class="fas fa-users"></i>
              </span>
            </button>
          <div class="header-popover users-popover" id="headerUsersPopover" role="dialog" aria-hidden="true">
            <div class="popover-header">
              <div class="popover-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
              <div class="popover-sub">–¢–æ–ø —Å–ª—É—à–∞—Ç–µ–ª–µ–π</div>
            </div>
            <div class="users-popover-list" id="headerUsersList">
              <p class="users-popover-empty">–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–ª—É—à–∞—Ç–µ–ª–µ–π.</p>
            </div>
            <div class="popover-actions">
              <button class="btn btn-ghost btn-xs" type="button" id="openUsersSectionBtn">–û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª</button>
            </div>
          </div>
        </div>
        <div class="header-action-group">
          <button
            class="header-profile-btn"
            id="headerProfileBtn"
            type="button"
            aria-haspopup="dialog"
            aria-expanded="false"
          >
            <div class="header-profile-avatar" id="headerProfileAvatar" aria-hidden="true">RU</div>
            <span id="headerProfileName">–í–æ–π—Ç–∏</span>
          </button>
          <div class="header-popover profile-popover" id="headerProfilePopover" role="dialog" aria-hidden="true">
            <div class="profile-popover-section" data-state="logged-out">
              <div class="popover-header">
                <div class="popover-title">–í—Ö–æ–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å</div>
                <div class="popover-sub">–ü–æ–ª—É—á–∏ 10 RUZCOIN –∑–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</div>
              </div>
              <div class="login-methods" role="group" aria-label="–°–ø–æ—Å–æ–±—ã –≤—Ö–æ–¥–∞">
                <button class="login-method-btn" type="button" data-login-quick="demo">
                  <span class="login-method-icon"><i class="fa-solid fa-bolt"></i></span>
                  <span class="login-method-body">
                    <span class="login-method-name">–î–µ–º–æ-–≤—Ö–æ–¥</span>
                    <span class="login-method-note">–ì–æ—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç Demo Listener</span>
                  </span>
                </button>
                <button class="login-method-btn" type="button" data-login-quick="guest">
                  <span class="login-method-icon"><i class="fa-solid fa-user"></i></span>
                  <span class="login-method-body">
                    <span class="login-method-name">–û—Å—Ç–∞—Ç—å—Å—è –≥–æ—Å—Ç–µ–º</span>
                    <span class="login-method-note">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</span>
                  </span>
                </button>
              </div>
              <p class="popover-text">
                –•–æ—á–µ—à—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å? –í–≤–µ–¥–∏ –Ω–∏–∫ –∏ –ø—Ä–∏–¥—É–º–∞–π –ø–∞—Ä–æ–ª—å ‚Äî –º—ã —Å–æ–∑–¥–∞–¥–∏–º –∞–∫–∫–∞—É–Ω—Ç –∏ –Ω–∞—á–∏—Å–ª–∏–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å.
              </p>
              <form id="loginForm" class="popover-form">
                <label for="loginName" class="sr-only">–ù–∏–∫–Ω–µ–π–º</label>
                <input type="text" id="loginName" placeholder="–¢–≤–æ–π –Ω–∏–∫" autocomplete="nickname" required />
                <label for="loginPassword" class="sr-only">–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="new-password" required />
                <button type="submit" class="btn btn-primary btn-sm">–í–æ–π—Ç–∏</button>
              </form>
              <details class="admin-login" id="adminLoginToggle" open>
                <summary>–í–æ–π—Ç–∏ –ø–æ –∫–æ–¥—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</summary>
                <form id="adminCodeForm" class="popover-form">
                  <label for="adminCodeInput" class="sr-only">–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥</label>
                  <input type="text" id="adminCodeInput" placeholder="AVZ-ADMIN-000" autocomplete="one-time-code" required />
                  <label for="adminNameInput" class="sr-only">–ò–º—è</label>
                  <input type="text" id="adminNameInput" placeholder="–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è" autocomplete="nickname" />
                  <button type="submit" class="btn btn-primary btn-sm">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
                </form>
              </details>
            </div>
            <div class="profile-popover-section" data-state="logged-in">
              <div class="popover-avatar" id="popoverAvatar">RU</div>
              <div class="popover-header">
                <div class="popover-title" id="popoverProfileName">–ì–æ—Å—Ç—å</div>
                <div class="popover-sub">ID: <span id="popoverProfileId">‚Äî</span></div>
              </div>
              <div class="popover-balance">
                <span class="ruzcoin-icon is-inline" aria-hidden="true">
                  <span class="ruzcoin-glyph">…å</span>
                </span>
                <div>
                  <div class="popover-meta">–ë–∞–ª–∞–Ω—Å</div>
                  <div class="popover-balance-value" id="popoverCoinsAmount">0</div>
                </div>
              </div>
              <div class="popover-meta">–†–æ–ª—å: <span id="popoverProfileRole">–°–ª—É—à–∞—Ç–µ–ª—å</span></div>
              <div class="popover-actions">
                <button class="btn btn-primary btn-xs" type="button" id="openProfileSectionBtn">–ü—Ä–æ—Ñ–∏–ª—å</button>
                <button class="btn btn-ghost btn-xs" type="button" data-action="logout">–í—ã—Ö–æ–¥</button>
              </div>
            </div>
            <div class="popover-sections" aria-label="–ë—ã—Å—Ç—Ä—ã–µ —Ä–∞–∑–¥–µ–ª—ã">
              <div class="popover-sections-title">–ë—ã—Å—Ç—Ä—ã–µ —Ä–∞–∑–¥–µ–ª—ã</div>
              <div class="popover-sections-grid">
                <a class="popover-section-card" href="#profile" data-open-section="profile">
                  <span class="popover-section-icon" aria-hidden="true">
                    <i class="fa-solid fa-id-card"></i>
                  </span>
                  <span class="popover-section-body">
                    <span class="popover-section-title">–ü—Ä–æ—Ñ–∏–ª—å</span>
                    <span class="popover-section-note">–ü–æ–ª–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞</span>
                  </span>
                </a>
                <a class="popover-section-card" href="#users" data-open-section="users">
                  <span class="popover-section-icon" aria-hidden="true">
                    <i class="fa-solid fa-users"></i>
                  </span>
                  <span class="popover-section-body">
                    <span class="popover-section-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                    <span class="popover-section-note">–¢–æ–ø —Å–ª—É—à–∞—Ç–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º—å—é–Ω–∏—Ç–∏</span>
                  </span>
                </a>
                <a class="popover-section-card" href="#payments" data-open-section="payments">
                  <span class="popover-section-icon" aria-hidden="true">
                    <i class="fa-solid fa-coins"></i>
                  </span>
                  <span class="popover-section-body">
                    <span class="popover-section-title">–û–ø–ª–∞—Ç–∞</span>
                    <span class="popover-section-note">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ RUZCOIN –∏ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</span>
                  </span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <section class="hero">
      <div class="hero-left">
        <div class="hero-avatar">
          <div class="hero-avatar-label">AVZAL√òV</div>
        </div>
        <div class="hero-main">
          <div class="hero-subtitle">
            –∞—Ä—Ç–∏—Å—Ç ‚Ä¢ –ø—Ä–æ–¥—é—Å–µ—Ä ‚Ä¢ <span>–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤</span>
          </div>
          <h1 class="hero-title">AVZAL√òV</h1>
          <p class="hero-text">
            AVZAL√òV (–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤) ‚Äî –∞—Ä—Ç–∏—Å—Ç, —Å–æ—á–µ—Ç–∞—é—â–∏–π —Ç—ë–º–Ω—ã–µ –±–∞–ª–ª–∞–¥—ã,
            —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–æ–ø –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ –≤–µ—Ä–µ,
            –º–æ–ª–æ–¥–æ—Å—Ç–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –±–æ—Ä—å–±–µ.
          </p>

          <div class="hero-tags">
            <div class="tag">–¥–∞—Ä–∫-–ø–æ–ø</div>
            <div class="tag">–∞–ª—å—Ç-—Ä—ç–ø</div>
            <div class="tag">—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π</div>
            <div class="tag">ru / tt</div>
          </div>

          <div class="hero-actions">
            <button class="btn btn-primary" onclick="document.getElementById('tracks').scrollIntoView({behavior:'smooth'})">
              –°–ª—É—à–∞—Ç—å —Ä–µ–ª–∏–∑—ã
            </button>
            <button class="btn btn-ghost" onclick="document.getElementById('contacts').scrollIntoView({behavior:'smooth'})">
              –°–≤—è–∑–∞—Ç—å—Å—è
            </button>
          </div>
        </div>
      </div>
    </section>

    <section id="profile">
      <div class="section-header">
        <h2 class="section-title">–ü—Ä–æ—Ñ–∏–ª—å</h2>
        <p class="section-sub">
          –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, RUZCOIN –∏ –¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫—Ä—ã—Ç—ã–º —Ç—Ä–µ–∫–∞–º.
        </p>
      </div>

      <div class="profile-wrapper">
        <div class="profile-panel" id="profilePanel" hidden>
          <div class="profile-main">
            <div class="profile-avatar-wrapper">
              <div class="profile-avatar" id="profileAvatar" role="img" aria-label="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <span class="profile-avatar-initials" id="profileAvatarInitials">RU</span>
              </div>
              <div class="profile-avatar-actions">
                <input type="file" id="profileAvatarInput" accept="image/*" hidden />
                <button class="btn btn-primary btn-xs" type="button" id="profileAvatarUploadBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                <button class="btn btn-ghost btn-xs" type="button" id="profileAvatarResetBtn">–°–±—Ä–æ—Å–∏—Ç—å</button>
              </div>
            </div>
            <div class="profile-info">
              <div class="profile-name" id="profileName">–ì–æ—Å—Ç—å</div>
              <div class="profile-id">ID: <span id="profileId">‚Äî</span></div>
              <div class="profile-role">–†–æ–ª—å: <span id="profileRole">–°–ª—É—à–∞—Ç–µ–ª—å</span></div>
              <div class="profile-coins">
                <span class="ruzcoin-icon is-inline" aria-hidden="true">
                  <span class="ruzcoin-glyph">…å</span>
                </span>
                –ë–∞–ª–∞–Ω—Å RUZCOIN:
                <span class="coins-amount" id="coinsAmount">0</span>
              </div>
              <div class="profile-actions-row">
                <button class="btn btn-primary btn-xs" id="earnDemoCoinsBtn">+1 RUZCOIN (–¥–µ–º–æ, —Ä–∞–∑–æ–≤–æ)</button>
                <button class="btn btn-ghost btn-xs" id="profileTopupBtn" type="button">
                  –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
                </button>
                <button class="btn btn-ghost btn-xs" id="logoutBtn" type="button" data-action="logout">–í—ã—Ö–æ–¥</button>
              </div>
            </div>
          </div>

          <div class="admin-tools" id="adminTools">
            <h4>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h4>
            <p class="section-sub">
              –î–∞—Ä–∏—Ç–µ RUZCOIN –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ –∏—Ö ID. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ –∏ —Ñ–∞–π–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
            </p>
            <form class="admin-gift-form" id="adminGiftForm">
              <input type="text" id="giftUserId" placeholder="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" autocomplete="off" required />
              <input type="number" id="giftAmount" placeholder="RUZ" min="1" step="1" required />
              <button type="submit">–ü–æ–¥–∞—Ä–∏—Ç—å RUZCOIN</button>
            </form>
            <div class="section-sub" id="adminGiftStatus" role="status" aria-live="polite"></div>
          </div>

          <div class="profile-tabs" id="profileTabs" role="tablist" aria-label="–†–∞–∑–¥–µ–ª—ã –ø—Ä–æ—Ñ–∏–ª—è">
            <button
              class="profile-tab-btn is-active"
              type="button"
              role="tab"
              id="profileTabOverview"
              aria-controls="profileViewOverview"
              aria-selected="true"
              data-profile-tab="overview"
            >
              –û–±–∑–æ—Ä
            </button>
            <button
              class="profile-tab-btn"
              type="button"
              role="tab"
              id="profileTabStats"
              aria-controls="profileViewStats"
              aria-selected="false"
              data-profile-tab="stats"
            >
              –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </button>
            <button
              class="profile-tab-btn"
              type="button"
              role="tab"
              id="profileTabHistory"
              aria-controls="profileViewHistory"
              aria-selected="false"
              data-profile-tab="history"
            >
              –ò—Å—Ç–æ—Ä–∏—è RUZCOIN
            </button>
          </div>

          <div class="profile-views">
            <div
              class="profile-view is-active"
              data-profile-view="overview"
              id="profileViewOverview"
              role="tabpanel"
              aria-labelledby="profileTabOverview"
            >
              <div class="profile-overview-grid">
                <div class="profile-overview-callout">
                  –ü–µ—Ä–µ–∫–ª—é—á–∞–π—Å—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏, —á—Ç–æ–±—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ª–∏—á–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π –∏ –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π —Å RUZCOIN.
                  –ó–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –¥–µ–º–æ-–º–æ–Ω–µ—Ç—ã.
                </div>
                <div class="profile-achievements">
                  <h4>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h4>
                  <div class="achievements-grid" id="achievementsGrid"></div>
                </div>
              </div>
            </div>

            <div
              class="profile-view"
              data-profile-view="stats"
              id="profileViewStats"
              role="tabpanel"
              aria-labelledby="profileTabStats"
              hidden
            >
              <div class="stats-card" id="listeningStatsCard">
                <div class="stats-summary">
                  <div class="stat-block">
                    <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π</div>
                    <div class="stat-value" id="statTotalPlays">0</div>
                    <div class="stat-subvalue">–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</div>
                  </div>
                  <div class="stat-block">
                    <div class="stat-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏</div>
                    <div class="stat-value" id="statUniqueTracks">0</div>
                    <div class="stat-subvalue">–° —É—á—ë—Ç–æ–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ä–µ–ª–∏–∑–æ–≤</div>
                  </div>
                  <div class="stat-block">
                    <div class="stat-label">–õ—é–±–∏–º—ã–π —Ç—Ä–µ–∫</div>
                    <div class="stat-value" id="statTopTrack">‚Äî</div>
                    <div class="stat-subvalue" id="statTopTrackCount">–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π: 0</div>
                  </div>
                </div>

                <div class="stats-divider"></div>

                <div class="recent-plays">
                  <div class="recent-plays-header">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è</h3>
                    <span class="recent-plays-note" id="statsNote">–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.</span>
                  </div>
                  <ul class="recent-plays-list" id="recentListeningList">
                    <li class="recent-plays-empty">–ù–∞—á–Ω–∏—Ç–µ —Å–ª—É—à–∞—Ç—å —Ç—Ä–µ–∫–∏, –∏ —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</li>
                  </ul>
                </div>
              </div>
            </div>

            <div
              class="profile-view"
              data-profile-view="history"
              id="profileViewHistory"
              role="tabpanel"
              aria-labelledby="profileTabHistory"
              hidden
            >
              <div class="history-card" id="coinHistoryCard">
                <div class="history-summary">
                  <div class="history-summary-item">
                    <span class="summary-label">–ü–æ–ª—É—á–µ–Ω–æ</span>
                    <span class="summary-value" id="historyEarned">0 RUZ</span>
                  </div>
                  <div class="history-summary-item">
                    <span class="summary-label">–ü–æ—Ç—Ä–∞—á–µ–Ω–æ</span>
                    <span class="summary-value" id="historySpent">0 RUZ</span>
                  </div>
                  <div class="history-summary-item">
                    <span class="summary-label">–ë–∞–ª–∞–Ω—Å –æ–ø–µ—Ä–∞—Ü–∏–π</span>
                    <span class="summary-value" id="historyNet">0 RUZ</span>
                  </div>
                </div>

                <div class="history-list" id="coinHistoryList">
                  <div class="history-empty" id="coinHistoryEmpty">–ò—Å—Ç–æ—Ä–∏—è –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å RUZCOIN.</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="profile-empty" id="profileEmpty">
          <h3>–û—Ç–∫—Ä–æ–π —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å AVZAL√òV</h3>
          <p>
            –ù–∞–∂–º–∏ ¬´–í–æ–π—Ç–∏¬ª –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É ‚Äî –≤—ã–±–µ—Ä–∏ –¥–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç, –æ—Å—Ç–∞–Ω—å—Å—è –≥–æ—Å—Ç–µ–º –∏–ª–∏ —Å–æ–∑–¥–∞–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å –±–æ–Ω—É—Å–æ–º
            +10 RUZCOIN. –í –∫–∞–±–∏–Ω–µ—Ç–µ –∂–¥—É—Ç –±–∞–ª–∞–Ω—Å, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π –∏ –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.
          </p>
        </div>
      </div>
    </section>

    <section id="users">
      <div class="section-header">
        <h2 class="section-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
        <p class="section-sub">
          –¢–æ–ø —Å–ª—É—à–∞—Ç–µ–ª–µ–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É RUZCOIN –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞.
        </p>
      </div>
      <div class="users-directory" id="usersDirectory">
        <p class="users-empty">–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫.</p>
      </div>
    </section>

    <section id="payments" class="section-hidden">
      <div class="section-header">
        <h2 class="section-title">–û–ø–ª–∞—Ç–∞ –∏ RUZCOIN</h2>
        <p class="section-sub">
          1 RUZCOIN = 25 ‚ÇΩ. –í—ã–±–∏—Ä–∞–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å–º–æ—Ç—Ä–∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—É—é —Ü–µ–Ω—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.
        </p>
      </div>

      <div class="topup-card">
        <div class="topup-content">
          <div class="topup-rows" role="group" aria-label="–í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ RUZCOIN">
            <div class="topup-row">
              <button class="topup-amount-btn" type="button" data-amount="1" aria-pressed="false">
                <span>1 RUZ</span>
                <small>~25 ‚ÇΩ</small>
              </button>
              <button class="topup-amount-btn" type="button" data-amount="5" aria-pressed="false">
                <span>5 RUZ</span>
                <small>~125 ‚ÇΩ</small>
              </button>
              <button class="topup-amount-btn" type="button" data-amount="10" aria-pressed="false">
                <span>10 RUZ</span>
                <small>~250 ‚ÇΩ</small>
              </button>
            </div>
            <div class="topup-row">
              <button class="topup-amount-btn" type="button" data-amount="15" aria-pressed="false">
                <span>15 RUZ</span>
                <small>~375 ‚ÇΩ</small>
              </button>
              <button class="topup-amount-btn" type="button" data-amount="25" aria-pressed="false">
                <span>25 RUZ</span>
                <small>~625 ‚ÇΩ</small>
              </button>
              <button class="topup-amount-btn active" type="button" data-amount="50" aria-pressed="true">
                <span>50 RUZ</span>
                <small>~1250 ‚ÇΩ</small>
              </button>
            </div>
          </div>

          <div class="topup-summary">
            <div>
              –í—ã–±—Ä–∞–Ω–æ: <strong><span id="topupAmount">50</span> RUZ</strong>
            </div>
            <div>
              –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—É–º–º–∞: <strong><span id="topupPrice">1250</span> ‚ÇΩ</strong>
            </div>
          </div>

          <div class="topup-actions">
            <button class="btn btn-primary topup-btn-main" type="button" id="demoTopupBtn">
              <i class="fa-solid fa-bolt"></i>
              –ó–∞—á–∏—Å–ª–∏—Ç—å –∫–∞–∫ –¥–µ–º–æ
            </button>
            <button class="btn btn-ghost topup-btn-real" type="button" id="realTopupBtn">
              <i class="fa-solid fa-circle-check"></i>
              –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É
            </button>
          </div>
          <div class="topup-methods-grid">
            <button class="topup-method-card" type="button" data-topup-method="card">
              <div class="topup-method-icon"><i class="fa-solid fa-credit-card"></i></div>
              <div class="topup-method-name">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</div>
              <div class="topup-method-note">Visa, Mastercard, –ú–ò–†</div>
            </button>
            <button class="topup-method-card" type="button" data-topup-method="sbp">
              <div class="topup-method-icon"><i class="fa-solid fa-building-columns"></i></div>
              <div class="topup-method-name">–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π</div>
              <div class="topup-method-note">–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</div>
            </button>
            <button class="topup-method-card" type="button" data-topup-method="yoomoney">
              <div class="topup-method-icon"><i class="fa-solid fa-wallet"></i></div>
              <div class="topup-method-name">–ÆMoney</div>
              <div class="topup-method-note">–û–ø–ª–∞—Ç–∞ –∫–æ—à–µ–ª—å–∫–æ–º –∏–ª–∏ –Ω–æ–º–µ—Ä–æ–º –∫–∞—Ä—Ç—ã</div>
            </button>
          </div>
        </div>
        <p class="topup-note">
          –ü–æ—Å–ª–µ –∑–∞—è–≤–∫–∏ –º—ã –ø—Ä–∏—à–ª—ë–º —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–º –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é. –ü–æ–∫–∞ –∂–¥—ë—à—å –æ—Ç–≤–µ—Ç, –º–æ–∂–Ω–æ
          –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ-–∑–∞—á–∏—Å–ª–µ–Ω–∏—è.
        </p>
      </div>
    </section>

    <section id="tracks">
      <div class="section-header">
        <h2 class="section-title">–†–µ–ª–∏–∑—ã</h2>
        <div>
          <p class="section-sub">
            –í—Å–µ —Å–∏–Ω–≥–ª—ã, EP –∏ –∞–ª—å–±–æ–º—ã –≤ –æ–¥–Ω–æ–º —Å–ø–∏—Å–∫–µ.
          </p>
          <div class="moscow-time" id="moscowTime">
            <i class="fa-solid fa-clock"></i>
            <span>–ú–°–ö: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è‚Ä¶</span>
          </div>
        </div>
      </div>
      <div class="tracks-grid">
      </div>
    </section>

    <section id="clips">
      <div class="section-header">
        <h2 class="section-title">–ö–ª–∏–ø—ã</h2>
        <p class="section-sub">–í—ã–±–æ—Ä —Ç—Ä–µ–∫–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∫–ª–∏–ø –∏–ª–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.</p>
      </div>
      <div class="tracks-grid" id="clipsGrid">
        <p class="users-empty">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –∫–ª–∏–ø—ã. –û—Ç–∫—Ä–æ–π —Ç—Ä–µ–∫–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –±–æ–ª—å—à–µ.</p>
      </div>
    </section>

    <section id="news">
      <div class="section-header">
        <h2 class="section-title">–ù–æ–≤–æ—Å—Ç–∏</h2>
        <p class="section-sub">
          –°–≤–µ–∂–∏–µ –∞–Ω–æ–Ω—Å—ã, —Ä–µ–ª–∏–∑—ã –∏ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.
        </p>
      </div>

      <div class="news-list">
        <article class="news-item">
          <div class="news-tag" style="color: #2ed58b;">–∞–Ω–æ–Ω—Å</div>
          <div class="news-title">¬´–î–ò–ö–ê–Ø –ö–û–ú–ï–¢–ê¬ª –≤—ã—Ö–æ–¥–∏—Ç 28 –Ω–æ—è–±—Ä—è</div>
          <div class="news-meta">–ù–æ—è–±—Ä—å 2025</div>
          <p class="news-text">
            –ù–æ–≤—ã–π —Å–∏–Ω–≥–ª AVZAL√òV —É–∂–µ –Ω–∞ –ø–æ–¥—Ö–æ–¥–µ ‚Äî –≤–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –ø—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –ø—Ä–µ–º—å–µ—Ä–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É 28.11.2025.
          </p>
        </article>
        
        <article class="news-item">
          <div class="news-tag">–∞–Ω–æ–Ω—Å</div>
          <div class="news-title">–ì–æ—Ç–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–π –º–∏–Ω–∏-–∞–ª—å–±–æ–º</div>
          <div class="news-meta">–î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞ –±—É–¥–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ</div>
          <p class="news-text">
            –í —Ç—Ä–µ–∫–ª–∏—Å—Ç –≤–æ–π–¥—É—Ç —Ç–µ–º–Ω—ã–µ –±–∞–ª–ª–∞–¥—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ —Ç–∞—Ç–∞—Ä—Å–∫–æ–º —è–∑—ã–∫–∞—Ö, –∞ —Ç–∞–∫–∂–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ —Ä–∞–±–æ—Ç—ã —Å –¥—Ä—É–≥–∏–º–∏ –∞—Ä—Ç–∏—Å—Ç–∞–º–∏.
          </p>
        </article>
      </div>
    </section>

    <section id="about">
      <div class="section-header">
        <h2 class="section-title">–û–±–æ –º–Ω–µ</h2>
        <p class="section-sub">
          –ù–µ–º–Ω–æ–≥–æ –æ —Ç–æ–º, –∫—Ç–æ —Ç–∞–∫–æ–π AVZAL√òV (–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤).
        </p>
      </div>

      <div class="about-grid">
        <div class="about-text">
          <p>
            AVZAL√òV (–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤) ‚Äî –∞—Ä—Ç–∏—Å—Ç –∏ –∞–≤—Ç–æ—Ä –ø–µ—Å–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ —Å–≤–æ–µ–π –º—É–∑—ã–∫–µ –º—Ä–∞—á–Ω—ã–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã, –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —Ç–µ–∫—Å—Ç—ã –∏ –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω—ã–π –∑–≤—É–∫. –¢–µ–º—ã —Ç—Ä–µ–∫–æ–≤ ‚Äî –≤–µ—Ä–∞, –ø–æ–∏—Å–∫ —Å–µ–±—è, –º–æ–ª–æ–¥–æ—Å—Ç—å, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–∞–Ω—ã –∏ –Ω–∞–¥–µ–∂–¥–∞.
          </p>
          <p>
            –í –ø–µ—Å–Ω—è—Ö –∑–≤—É—á–∞—Ç —Ä—É—Å—Å–∫–∏–π –∏ —Ç–∞—Ç–∞—Ä—Å–∫–∏–π —è–∑—ã–∫–∏, –∞ –∑–≤—É—á–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –º–µ–∂–¥—É dark pop, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º —Ä—ç–ø–æ–º –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –±–∞–ª–ª–∞–¥–∞–º–∏.
          </p>

          <div class="socials">
            <a href="https://vk.com/artist/avzalov" target="_blank" class="social-pill">VK Music</a>
            <a href="https://music.youtube.com/" target="_blank" class="social-pill">YouTube Music</a>
            <a href="https://open.spotify.com/artist/" target="_blank" class="social-pill">Spotify</a>
            <a href="https://t.me/your_nick" target="_blank" class="social-pill">Telegram</a>
          </div>
        </div>

        <aside class="about-card">
          <div class="about-card-title">–¶–∏—Ñ—Ä—ã –∏ —Ñ–∞–∫—Ç—ã</div>
          <div class="about-card-stat-row">
            <span>–†–µ–ª–∏–∑–æ–≤</span>
            <span>10+</span>
          </div>
          <div class="about-card-stat-row">
            <span>–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π</span>
            <span>100K+</span>
          </div>
          <div class="about-card-stat-row">
            <span>–ì–æ—Ä–æ–¥–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π</span>
            <span>20+</span>
          </div>
        </aside>
      </div>
    </section>

    <section id="contacts">
      <div class="section-header">
        <h2 class="section-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
        <p class="section-sub">
          –î–ª—è –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤, –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏–π, –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.
        </p>
      </div>

      <div class="about-text">
        <p>
          –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ –∏ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–π:
        </p>
        <p style="margin-top:8px;">
          Email: <a href="mailto:booking@avzalov.com" style="color: var(--accent);">booking@avzalov.com</a><br />
          Telegram: <a href="https://t.me/your_nick" target="_blank" style="color: var(--accent);">@your_nick</a>
        </p>
      </div>
    </section>

    <footer>
      <span>¬© <span id="year"></span> AVZAL√òV (–†—É–∑–∏–ª—å –ê–≤–∑–∞–ª–æ–≤).</span>
      <span>–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∞—Ä—Ç–∏—Å—Ç–∞.</span>
    </footer>
  </div>

  <!-- NEW Mini Player -->
  <div class="mini-player" id="miniPlayer">
    <div class="mini-player-inner">
      <div class="mini-player-track">
        <div class="mini-player-cover" id="miniPlayerCover"></div>
        <div class="mini-player-info">
          <div class="mini-player-title" id="miniPlayerTitle">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</div>
          <div class="mini-player-artist">AVZAL√òV</div>
        </div>
      </div>
      <div class="mini-player-controls">
        <div class="mini-player-buttons">
          <button class="mini-player-skip-btn" id="miniPlayerPrevBtn" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫"><i class="fas fa-backward"></i></button>
          <button class="mini-player-play-btn" id="miniPlayerPlayBtn"><i class="fas fa-play"></i></button>
          <button class="mini-player-skip-btn" id="miniPlayerNextBtn" aria-label="–°–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫"><i class="fas fa-forward"></i></button>
        </div>
        <div class="mini-player-progress-wrapper">
          <span id="miniPlayerCurrentTime">0:00</span>
          <div class="progress-bar" id="miniPlayerProgressBar"><div class="progress-bar-filled" id="miniPlayerProgressFilled"></div></div>
          <span id="miniPlayerDuration">0:00</span>
        </div>
      </div>
      <div class="mini-player-actions">
        <button class="track-action-btn" id="miniPlayerLyricsBtn">–¢–µ–∫—Å—Ç</button>
        <div class="volume-control">
          <i class="fas fa-volume-down"></i>
          <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.01" value="1">
        </div>
      </div>
    </div>
  </div>

  <!-- Lyrics Modal -->
  <div class="lyrics-modal-overlay" id="lyricsModalOverlay">
    <div class="lyrics-modal">
      <button class="lyrics-close-btn" id="lyricsCloseBtn">&times;</button>
      <h3 class="lyrics-title" id="lyricsModalTitle"></h3>
      <p class="lyrics-artist">AVZAL√òV</p>
      <div class="lyrics-text" id="lyricsModalText"></div>
    </div>
  </div>
  <script src="mix-events.js"></script>
  <script src="tracks-data.js"></script>
  <script>
      // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É "–ù–∞–≤–µ—Ä—Ö"
      const scrollToTopBtn = document.getElementById("scrollToTopBtn");
      const siteHeader = document.querySelector(".site-header");

      function updateStickyChrome() {
        const offset = window.pageYOffset || document.documentElement.scrollTop;
        if (siteHeader) {
          const isFloating = offset > 12;
          siteHeader.classList.toggle("is-floating", isFloating);
          siteHeader.classList.toggle("is-condensed", offset > 220);
        }
        if (scrollToTopBtn) {
          scrollToTopBtn.style.display = offset > 160 ? "block" : "none";
        }
      }

      window.addEventListener("scroll", updateStickyChrome, { passive: true });

      if (scrollToTopBtn) {
        scrollToTopBtn.addEventListener("click", () => {
          window.scrollTo({
            top: 0,
            behavior: "smooth"
          });
        });
      }

      updateStickyChrome();
    const navToggle = document.getElementById("navToggle");
    const mainNav = document.getElementById("mainNav");
    const headerProfileBtn = document.getElementById("headerProfileBtn");
    const headerProfileNameEl = document.getElementById("headerProfileName");
    const headerCoinsAmountEl = document.getElementById("headerCoinsAmount");
    const mixEventsBtn = document.getElementById("mixEventsBtn");
    const mixEventsPopover = document.getElementById("mixEventsPopover");
    const mixCountdownLabel = document.getElementById("mixCountdownLabel");
    const mixPopoverStatus = document.getElementById("mixPopoverStatus");
    const mixEventsListEl = document.getElementById("mixEventsList");
    const openPaymentsFromPopoverBtn = document.getElementById("openPaymentsFromPopoverBtn");
    const profileTopupBtn = document.getElementById("profileTopupBtn");
    const paymentsSection = document.getElementById("payments");
    const topupAmountButtons = Array.from(document.querySelectorAll(".topup-amount-btn"));
    const topupAmountDisplayEls = [document.getElementById("topupAmount")].filter(Boolean);
    const topupPriceDisplayEls = [document.getElementById("topupPrice")].filter(Boolean);
    const demoTopupButtons = [document.getElementById("demoTopupBtn")].filter(Boolean);
    const primaryDemoTopupBtn = demoTopupButtons[0] || null;
    const realTopupButtons = [document.getElementById("realTopupBtn")].filter(Boolean);
    const profileTabButtons = Array.from(document.querySelectorAll("[data-profile-tab]"));
    const profileViews = Array.from(document.querySelectorAll("[data-profile-view]"));
    const headerUsersBtn = document.getElementById("headerUsersBtn");
    const usersSection = document.getElementById("users");
    const usersDirectoryEl = document.getElementById("usersDirectory");
    const clipsGrid = document.getElementById("clipsGrid");
    const loginQuickButtons = Array.from(document.querySelectorAll("[data-login-quick]"));
    const topupMethodButtons = Array.from(document.querySelectorAll("[data-topup-method]"));

    const tracksGrid = document.querySelector("#tracks .tracks-grid");

    const RUZCOIN_PRICE_RUB = 25;
    const VOLUME_STORAGE_KEY = "avzalov-volume";
    const TOPUP_METHOD_CONFIG = {
      card: {
        label: "–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞",
        description: "–û–ø–ª–∞—Ç–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π Visa, Mastercard –∏–ª–∏ –ú–ò–†"
      },
      sbp: {
        label: "–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π",
        description: "–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ –°–ë–ü"
      },
      yoomoney: {
        label: "–ÆMoney",
        description: "–ü–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ –∫–æ—à–µ–ª—ë–∫ –∏–ª–∏ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—É—é –∫–∞—Ä—Ç—É"
      }
    };

    if (navToggle && mainNav) {
      navToggle.addEventListener("click", () => {
        mainNav.classList.toggle("nav-open");
      });
    }

    function revealSection(sectionEl) {
      if (!sectionEl) {
        return false;
      }
      sectionEl.hidden = false;
      sectionEl.classList.remove("section-hidden");
      return true;
    }

    function openPaymentsSection(options = {}) {
      const shouldFocusTopup = options.focusTopup === true;
      if (!revealSection(paymentsSection)) {
        notifyPaymentsInProgress();
        return;
      }
      paymentsSection.scrollIntoView({ behavior: "smooth" });
      if (shouldFocusTopup && primaryDemoTopupBtn && typeof primaryDemoTopupBtn.focus === "function") {
        window.setTimeout(() => {
          try {
            primaryDemoTopupBtn.focus({ preventScroll: true });
          } catch (error) {
            primaryDemoTopupBtn.focus();
          }
        }, 260);
      }
    }

    function openSectionById(sectionId) {
      if (!sectionId) {
        return;
      }
      closeAllPopovers();
      const target = document.getElementById(sectionId);
      if (target) {
        revealSection(target);
        target.scrollIntoView({ behavior: "smooth" });
      }
    }

    if (mainNav) {
      const navLinks = Array.from(mainNav.querySelectorAll("a[href^=\"#\"]"));
      navLinks.forEach(link => {
        link.addEventListener("click", event => {
          const targetId = link.getAttribute("href");
          if (!targetId || !targetId.startsWith("#")) {
            return;
          }
          if (targetId === "#payments") {
            event.preventDefault();
            mainNav.classList.remove("nav-open");
            openPaymentsSection({ focusTopup: true });
            return;
          }
          const target = document.querySelector(targetId);
          if (target) {
            event.preventDefault();
            mainNav.classList.remove("nav-open");
            target.scrollIntoView({ behavior: "smooth" });
          }
        });
      });
    }

    if (window.location.hash === "#payments") {
      revealSection(paymentsSection);
    }

    function notifyPaymentsInProgress() {
      alert("–í—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É –∏ –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ RUZCOIN.");
    }

    realTopupButtons.forEach(button => {
      button.addEventListener("click", event => {
        event.preventDefault();
        if (!selectedTopupMethod) {
          notifyPaymentsInProgress();
          return;
        }
        handleRealTopup(selectedTopupMethod);
      });
    });

    const currentYearEl = document.getElementById("year");
    if (currentYearEl) {
      currentYearEl.textContent = new Date().getFullYear();
    }
    const numberFormatter = new Intl.NumberFormat("ru-RU");
    const moscowTimeEl = document.getElementById("moscowTime");

    function updateMoscowTime() {
      if (!moscowTimeEl) {
        return;
      }
      const now = new Date();
      const formatted = now.toLocaleString("ru-RU", {
        timeZone: "Europe/Moscow",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        day: "2-digit",
        month: "2-digit",
        year: "numeric"
      });
      const timeLabel = moscowTimeEl.querySelector("span");
      if (timeLabel) {
        timeLabel.textContent = `–ú–°–ö: ${formatted}`;
      }
    }

    updateMoscowTime();
    window.setInterval(updateMoscowTime, 1000 * 30);

    let selectedTopupAmount = 0;
    let selectedTopupMethod = "";

    function updateTopupSelectionFromButton(button) {
      if (!button) {
        return;
      }
      const amountValue = Number.parseInt(button.dataset.amount || "0", 10);
      if (!Number.isFinite(amountValue) || amountValue <= 0) {
        return;
      }
      selectedTopupAmount = amountValue;
      topupAmountButtons.forEach(item => {
        const itemAmount = Number.parseInt(item.dataset.amount || "0", 10);
        const isActive = itemAmount === amountValue;
        item.classList.toggle("active", isActive);
        item.setAttribute("aria-pressed", isActive ? "true" : "false");
      });
      topupAmountDisplayEls.forEach(el => {
        el.textContent = numberFormatter.format(amountValue);
      });
      topupPriceDisplayEls.forEach(el => {
        el.textContent = numberFormatter.format(amountValue * RUZCOIN_PRICE_RUB);
      });
    }

    function initializeTopupSelection() {
      if (!topupAmountButtons.length) {
        selectedTopupAmount = 0;
        return;
      }
      const presetButton = topupAmountButtons.find(btn => btn.classList.contains("active"));
      updateTopupSelectionFromButton(presetButton || topupAmountButtons[0]);
    }

    function getTopupMethodInfo(methodKey) {
      const normalized = (methodKey || "").toLowerCase();
      return TOPUP_METHOD_CONFIG[normalized] || null;
    }

    function setActiveTopupMethod(methodKey) {
      selectedTopupMethod = (methodKey || "").toLowerCase();
      topupMethodButtons.forEach(button => {
        const value = (button.dataset.topupMethod || "").toLowerCase();
        button.classList.toggle("is-active", value === selectedTopupMethod);
      });
    }

    function recordTopupRequest(methodKey, amount) {
      const method = getTopupMethodInfo(methodKey);
      if (!currentUser || !method) {
        return;
      }
      const numericAmount = Number(amount);
      const safeAmount = Number.isFinite(numericAmount) && numericAmount > 0 ? Math.floor(numericAmount) : 0;
      const description = `–ó–∞—è–≤–∫–∞ –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (${method.label}) ‚Äî ${numberFormatter.format(safeAmount)} RUZ`;
      const entry = {
        type: "request",
        description,
        delta: 0,
        status: "pending",
        time: new Date().toLocaleString("ru-RU")
      };
      coinHistory = [entry, ...coinHistory].slice(0, MAX_HISTORY_ENTRIES);
      saveCoinHistory();
      renderCoinHistory();
    }

    function handleRealTopup(methodKey) {
      if (!currentUser) {
        if (profilePopoverController) {
          profilePopoverController.open();
        } else {
          alert("–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.");
        }
        return;
      }
      const method = getTopupMethodInfo(methodKey);
      if (!method) {
        alert("–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: –∫–∞—Ä—Ç–∞, –°–ë–ü –∏–ª–∏ –ÆMoney.");
        return;
      }
      if (selectedTopupAmount <= 0) {
        alert("–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ RUZCOIN –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è.");
        return;
      }
      recordTopupRequest(methodKey, selectedTopupAmount);
      alert(
        `–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!\n–°—É–º–º–∞: ${numberFormatter.format(selectedTopupAmount)} RUZ\n–°–ø–æ—Å–æ–±: ${method.label}.\n` +
          "–ú—ã –ø—Ä–∏—à–ª—ë–º —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–º –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é."
      );
      saveProfile();
      updateProfilePopoverState();
      setActiveProfileView("history");
    }

    function setActiveProfileView(targetView) {
      if (!profileTabButtons.length || !profileViews.length) {
        return;
      }
      const normalizedView = targetView || (profileTabButtons[0] ? profileTabButtons[0].dataset.profileTab : "");
      profileTabButtons.forEach(button => {
        const isActive = button.dataset.profileTab === normalizedView;
        button.classList.toggle("is-active", isActive);
        button.setAttribute("aria-selected", isActive ? "true" : "false");
        button.setAttribute("tabindex", isActive ? "0" : "-1");
      });
      profileViews.forEach(view => {
        const isActive = view.dataset.profileView === normalizedView;
        view.classList.toggle("is-active", isActive);
        view.hidden = !isActive;
      });
    }

    if (profileTabButtons.length) {
      profileTabButtons.forEach(button => {
        button.addEventListener("click", () => {
          setActiveProfileView(button.dataset.profileTab);
        });
      });
      const initialView = profileTabButtons.find(btn => btn.classList.contains("is-active"));
      setActiveProfileView(initialView ? initialView.dataset.profileTab : "overview");
    }

    if (topupAmountButtons.length) {
      topupAmountButtons.forEach(button => {
        button.addEventListener("click", () => {
          updateTopupSelectionFromButton(button);
        });
      });
      initializeTopupSelection();
    }

    if (topupMethodButtons.length) {
      topupMethodButtons.forEach(button => {
        button.addEventListener("click", () => {
          const methodKey = button.dataset.topupMethod || "";
          setActiveTopupMethod(methodKey);
          handleRealTopup(methodKey);
        });
      });
    }

    if (loginQuickButtons.length) {
      loginQuickButtons.forEach(button => {
        button.addEventListener("click", () => {
          handleQuickLogin(button.dataset.loginQuick || "");
        });
      });
    }

    if (profileAvatarUploadBtn && profileAvatarInput) {
      profileAvatarUploadBtn.addEventListener("click", () => {
        if (!currentUser) {
          if (profilePopoverController) {
            profilePopoverController.open();
          }
          alert("–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä.");
          return;
        }
        profileAvatarInput.click();
      });
      profileAvatarInput.addEventListener("change", event => {
        const files = event.target && event.target.files ? Array.from(event.target.files) : [];
        handleAvatarSelection(files[0]);
        profileAvatarInput.value = "";
      });
    }

    if (profileAvatarResetBtn) {
      profileAvatarResetBtn.addEventListener("click", () => {
        if (!currentUser) {
          if (profilePopoverController) {
            profilePopoverController.open();
          }
          alert("–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–≤–∞—Ç–∞—Ä–æ–º.");
          return;
        }
        currentUser.avatar = "";
        saveProfile();
        updateProfilePopoverState();
        alert("–ê–≤–∞—Ç–∞—Ä —Å–±—Ä–æ—à–µ–Ω –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–∏–¥–∞.");
      });
    }

    demoTopupButtons.forEach(button => {
      button.addEventListener("click", () => {
        if (!currentUser) {
          if (profilePopoverController) {
            profilePopoverController.open();
          } else {
            alert("–í–æ–π–¥–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.");
          }
          return;
        }
        const demoTopupKey = `${DEMO_TOPUP_KEY}_${currentUser.id}`;
        if (localStorage.getItem(demoTopupKey) === "true") {
          alert("–î–µ–º–æ-–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.");
          return;
        }
        const demoTopupAmount = 1;
        if (selectedTopupAmount <= 0) {
          alert("–í—ã–±–µ—Ä–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ RUZCOIN –¥–ª—è –¥–µ–º–æ-–ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è.");
          return;
        }
        currentUser.coins += demoTopupAmount;
        if (coinsAmountEl) {
          coinsAmountEl.textContent = numberFormatter.format(currentUser.coins);
        }
        updateHeaderCoins(currentUser.coins);
        recordCoinHistory("demo-topup", demoTopupAmount, `–î–µ–º–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: +${demoTopupAmount} RUZCOIN`);
        saveProfile();
        updateProfilePopoverState();
        localStorage.setItem(demoTopupKey, "true");
        setActiveProfileView("history");
      });
    });

    let releasedTracksConfig = Array.isArray(window.RELEASED_TRACKS_DATA)
      ? window.RELEASED_TRACKS_DATA
      : [];
    const FALLBACK_RELEASES_ENDPOINT = "data/all-tracks.json";
    let mixReferenceDate = null;
    let mixEventsSchedule = [];
    let mixCountdownTimer = null;
    const mixEventsConfig =
      window.MIX_EVENTS_CONFIG && typeof window.MIX_EVENTS_CONFIG === "object"
        ? window.MIX_EVENTS_CONFIG
        : {};
    function slugifyTitleForFallback(title, index = 0) {
      const baseIndex = Number.isInteger(index) ? index : 0;
      const raw = typeof title === "string" ? title.trim() : "";
      if (!raw) {
        return `track-${baseIndex + 1}`;
      }
      const lower = raw.toLowerCase();
      const normalized = typeof lower.normalize === "function" ? lower.normalize("NFD") : lower;
      const stripped = normalized.replace(/[\u0300-\u036f]/g, "");
      const compact = stripped.replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g, "");
      return compact || `track-${baseIndex + 1}`;
    }

    async function loadFallbackReleases() {
      try {
        const response = await fetch(FALLBACK_RELEASES_ENDPOINT, { cache: "no-cache" });
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}`);
        }
        const payload = await response.json();
        if (!Array.isArray(payload)) {
          return [];
        }
        const usedSlugs = new Set();
        return payload.map((item, index) => {
          const title = item && item.title ? String(item.title).trim() : `–¢—Ä–µ–∫ ${index + 1}`;
          let slug = slugifyTitleForFallback(title, index);
          while (usedSlugs.has(slug)) {
            slug = `${slug}-${index + 1}`;
          }
          usedSlugs.add(slug);
          const release = item && item.release ? String(item.release).trim() : "—Å–∫–æ—Ä–æ";
          const normalized = {
            slug,
            title,
            releaseDate: release
          };
          if (item && item.type) {
            normalized.type = String(item.type).trim();
          }
          if (item && Object.prototype.hasOwnProperty.call(item, "price")) {
            const priceValue = Number.parseInt(item.price, 10);
            normalized.price = Number.isFinite(priceValue) ? priceValue : 0;
          }
          if (item && item.access) {
            normalized.access = String(item.access).trim();
          }
          if (item && item.hasClip === true) {
            normalized.hasClip = true;
            if (item.clipUrl) {
              normalized.clipUrl = String(item.clipUrl);
            }
          }
          return normalized;
        });
      } catch (error) {
        console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ä–µ–ª–∏–∑–æ–≤:", error);
        return [];
      }
    }

    const releaseReferenceDate = resolveReferenceDate();
    const availabilityLabelMap = {
      public: "–û—Ç–∫—Ä—ã—Ç–æ",
      "early-access": "–†–∞–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø",
      upcoming: "–û–∂–∏–¥–∞–µ—Ç—Å—è"
    };

    function resolveReferenceDate() {
      const manual = typeof window.RELEASES_TODAY === "string" ? window.RELEASES_TODAY.trim() : "";
      if (manual) {
        const parsed = new Date(manual);
        if (!Number.isNaN(parsed.getTime())) {
          return parsed;
        }
      }
      return new Date();
    }

    function parseReleaseDate(value) {
      if (typeof value !== "string") {
        return null;
      }
      const trimmed = value.trim();
      if (!trimmed || trimmed.toLowerCase() === "—Å–∫–æ—Ä–æ") {
        return null;
      }
      const segments = trimmed.split(".");
      if (segments.length === 3) {
        const [day, month, year] = segments.map(part => Number.parseInt(part, 10));
        if (!Number.isNaN(day) && !Number.isNaN(month) && !Number.isNaN(year)) {
          const parsed = new Date(year, month - 1, day);
          if (!Number.isNaN(parsed.getTime())) {
            return parsed;
          }
        }
      }
      const fallback = new Date(trimmed);
      return Number.isNaN(fallback.getTime()) ? null : fallback;
    }

    function determineReleaseState(parsedDate) {
      if (!parsedDate) {
        return "soon";
      }
      return parsedDate.getTime() <= releaseReferenceDate.getTime() ? "released" : "soon";
    }

    function determineVisualStatus(typeLabel, releaseState) {
      const normalizedType = (typeLabel || "").toLowerCase();
      if (normalizedType.includes("ep") || normalizedType.includes("–∞–ª—å–±–æ–º")) {
        return "ep";
      }
      return releaseState === "soon" ? "soon" : "released";
    }

    function resolveAvailability(accessValue, releaseState, trackConfig = {}) {
      const normalized = typeof accessValue === "string" ? accessValue.trim().toLowerCase() : "";
      if (normalized && Object.prototype.hasOwnProperty.call(availabilityLabelMap, normalized)) {
        return normalized;
      }
      if (releaseState === "released") {
        return "public";
      }
      if (trackConfig && trackConfig.unlockable === false) {
        return "upcoming";
      }
      return "early-access";
    }

    function formatAvailabilityLabel(value) {
      return availabilityLabelMap[value] || availabilityLabelMap.public;
    }

    const MIX_EVENT_DAY_MS = 24 * 60 * 60 * 1000;
    const MIX_EVENT_DEFAULT_DURATION_MS = 7 * MIX_EVENT_DAY_MS;
    const MIX_EVENT_STATS_KEY = "avzalov_mix_event_stats_v1";

    function createEmptyMixEventStats() {
      return { events: {} };
    }

    let mixEventStatsRegistry = {};
    let mixEventStats = createEmptyMixEventStats();

    let getMixEventStatsForCurrentUser = () => null;
    let ensureMixEventEntry = () => ({
      totalPlays: 0,
      trackPlays: {},
      updatedAt: new Date().toISOString()
    });
    let saveMixEventStatsForActiveUser = () => {};

    function parseMixDate(value) {
      if (typeof value !== "string") {
        return null;
      }
      const trimmed = value.trim();
      if (!trimmed) {
        return null;
      }
      const parsed = new Date(trimmed);
      return Number.isNaN(parsed.getTime()) ? null : parsed;
    }

    function fallbackMixStart(referenceDate, index) {
      const base = referenceDate instanceof Date && !Number.isNaN(referenceDate.getTime())
        ? referenceDate
        : new Date();
      return new Date(base.getTime() + index * MIX_EVENT_DEFAULT_DURATION_MS);
    }

    function sanitizeMixEventsList(list, referenceDate) {
      if (!Array.isArray(list)) {
        return [];
      }
      return list
        .map((item, index) => {
          if (!item || typeof item !== "object") {
            return null;
          }
          const startDate = parseMixDate(item.start) || fallbackMixStart(referenceDate, index);
          const endCandidate = parseMixDate(item.end);
          const endDate = endCandidate && endCandidate > startDate
            ? endCandidate
            : new Date(startDate.getTime() + MIX_EVENT_DEFAULT_DURATION_MS);
          const id = item.id ? String(item.id) : `mix-event-${index + 1}`;
          const title = item.title ? String(item.title) : "MIX —Å–æ–±—ã—Ç–∏–µ";
          const description = item.description
            ? String(item.description)
            : "–°–ª–µ–¥–∏—Ç–µ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ —Å–ª—É—à–∞–π—Ç–µ —Ä–µ–ª–∏–∑—ã, —á—Ç–æ–±—ã —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ MIX.";
          const focus = Array.isArray(item.focus)
            ? item.focus.filter(Boolean).map(entry => String(entry))
            : [];
          return {
            id,
            title,
            description,
            metric: item.metric ? String(item.metric) : "unique-plays",
            focus,
            startDate,
            endDate,
            startLabel: startDate.toLocaleString("ru-RU", { day: "2-digit", month: "long", hour: "2-digit", minute: "2-digit" }),
            endLabel: endDate.toLocaleString("ru-RU", { day: "2-digit", month: "long", hour: "2-digit", minute: "2-digit" })
          };
        })
        .filter(Boolean)
        .sort((a, b) => a.startDate.getTime() - b.startDate.getTime());
    }

    function findActiveMixEvent(now = new Date()) {
      const currentTime = now.getTime();
      return mixEventsSchedule.find(event => {
        return event.startDate.getTime() <= currentTime && event.endDate.getTime() > currentTime;
      }) || null;
    }

    function findUpcomingMixEvent(now = new Date()) {
      const currentTime = now.getTime();
      return mixEventsSchedule.find(event => event.startDate.getTime() > currentTime) || null;
    }

    function formatMixCountdown(diffMs) {
      if (!Number.isFinite(diffMs)) {
        return "–°–∫–æ—Ä–æ";
      }
      if (diffMs <= 0) {
        return "00:00";
      }
      const totalMinutes = Math.floor(diffMs / 60000);
      const days = Math.floor(totalMinutes / (60 * 24));
      const hours = Math.floor((totalMinutes % (60 * 24)) / 60);
      const minutes = totalMinutes % 60;
      const hoursSegment = String(hours).padStart(2, "0");
      const minutesSegment = String(minutes).padStart(2, "0");
      return days > 0 ? `${days}–¥ ${hoursSegment}:${minutesSegment}` : `${hoursSegment}:${minutesSegment}`;
    }

    function setMixCountdownLabel(text, isLive) {
      if (mixCountdownLabel) {
        mixCountdownLabel.textContent = text;
      }
      if (mixEventsBtn) {
        mixEventsBtn.classList.toggle("is-live", Boolean(isLive));
      }
    }

    function updateMixCountdown() {
      const now = new Date();
      const active = findActiveMixEvent(now);
      if (active) {
        const remaining = active.endDate.getTime() - now.getTime();
        const countdownText = remaining > 0 ? `LIVE ¬∑ ${formatMixCountdown(remaining)}` : "LIVE";
        setMixCountdownLabel(countdownText, true);
        if (mixPopoverStatus) {
          mixPopoverStatus.textContent = `–ò–¥—ë—Ç —Å–æ–±—ã—Ç–∏–µ ¬´${active.title}¬ª –¥–æ ${active.endLabel}`;
        }
        return;
      }
      const upcoming = findUpcomingMixEvent(now);
      if (upcoming) {
        const untilStart = upcoming.startDate.getTime() - now.getTime();
        const countdownText = untilStart > 0 ? formatMixCountdown(untilStart) : "–ì–æ—Ç–æ–≤–æ –∫ —Å—Ç–∞—Ä—Ç—É";
        setMixCountdownLabel(countdownText, false);
        if (mixPopoverStatus) {
          mixPopoverStatus.textContent = `–°—Ç–∞—Ä—Ç ${upcoming.startLabel}`;
        }
        return;
      }
      setMixCountdownLabel("–°–∫–æ—Ä–æ", false);
      if (mixPopoverStatus) {
        mixPopoverStatus.textContent = "–°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –æ–±—ä—è–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ.";
      }
    }

    function startMixCountdown() {
      if (mixCountdownTimer) {
        window.clearInterval(mixCountdownTimer);
      }
      mixCountdownTimer = window.setInterval(() => {
        updateMixCountdown();
      }, 60000);
    }

    function stopMixCountdown() {
      if (mixCountdownTimer) {
        window.clearInterval(mixCountdownTimer);
        mixCountdownTimer = null;
      }
    }

    function determineMixEventStatus(event, now = new Date()) {
      const current = now.getTime();
      const start = event.startDate.getTime();
      const end = event.endDate.getTime();
      if (current >= start && current < end) {
        return { key: "active", countdown: formatMixCountdown(end - current) };
      }
      if (current < start) {
        return { key: "upcoming", countdown: formatMixCountdown(start - current) };
      }
      return { key: "finished", countdown: "" };
    }

    function buildMixEventCard(event, now = new Date()) {
      const status = determineMixEventStatus(event, now);
      let statusLabel = "";
      if (status.key === "active") {
        statusLabel = `LIVE ¬∑ –¥–æ —Ñ–∏–Ω–∞–ª–∞ ${status.countdown}`;
      } else if (status.key === "upcoming") {
        statusLabel = `–°—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ ${status.countdown}`;
      } else {
        statusLabel = "–°–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ";
      }
      const stats = getMixEventStatsForCurrentUser(event.id);
      const uniqueTracks = stats && stats.trackPlays
        ? Object.keys(stats.trackPlays).length
        : 0;
      const topTracks = stats && stats.trackPlays
        ? Object.entries(stats.trackPlays)
            .sort((a, b) => Number(b[1]) - Number(a[1]))
            .slice(0, 3)
        : [];
      const topTracksMarkup = topTracks.length
        ? `<div class="mix-event-toplist">${topTracks
            .map(([slug, count]) => `<span>${resolveTrackTitle(slug)} ‚Äî ${formatCount(count)}</span>`)
            .join("")}</div>`
        : "";
      const hasStats = stats && (stats.totalPlays > 0 || uniqueTracks > 0);
      const statsMarkup = hasStats
        ? `<div class="mix-event-stats">
            <span>–í—Å–µ–≥–æ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π: ${formatCount(stats.totalPlays || 0)}</span>
            <span>–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏: ${formatCount(uniqueTracks)}</span>
          </div>${topTracksMarkup}`
        : '<div class="mix-event-stats">–°–ª—É—à–∞–π —Ä–µ–ª–∏–∑—ã, —á—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –≤ –ø–æ–¥–±–æ—Ä–∫—É MIX.</div>';
      const focusMarkup = event.focus && event.focus.length
        ? `<div class="mix-event-description">–§–æ–∫—É—Å –Ω–µ–¥–µ–ª–∏: ${event.focus
            .map(slug => resolveTrackTitle(slug))
            .join(", ")}</div>`
        : "";
      return `
        <article class="mix-event-card" data-status="${status.key}">
          <div class="mix-event-title">${event.title}</div>
          <div class="mix-event-status">${statusLabel}<span> ¬∑ ${event.startLabel} ‚Äî ${event.endLabel}</span></div>
          <div class="mix-event-description">${event.description}</div>
          ${focusMarkup}
          ${statsMarkup}
        </article>
      `;
    }

    function renderMixEventsList(now = new Date()) {
      if (!mixEventsListEl) {
        return;
      }
      if (!mixEventsSchedule.length) {
        mixEventsListEl.innerHTML = '<p class="users-popover-empty">–°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –æ–±—ä—è–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ.</p>';
        return;
      }
      mixEventsListEl.innerHTML = mixEventsSchedule.map(event => buildMixEventCard(event, now)).join("");
    }

    function initializeMixEventsSchedule() {
      const referenceCandidate = parseMixDate(mixEventsConfig.referenceDate);
      mixReferenceDate = referenceCandidate || releaseReferenceDate || new Date();
      mixEventsSchedule = sanitizeMixEventsList(mixEventsConfig.events || [], mixReferenceDate);
      updateMixCountdown();
      startMixCountdown();
      renderMixEventsList();
    }

    function recordMixEventPlay(slug) {
      const activeEvent = findActiveMixEvent();
      if (!activeEvent || !slug) {
        return;
      }
      const entry = ensureMixEventEntry(activeEvent.id);
      entry.totalPlays += 1;
      if (!entry.trackPlays[slug]) {
        entry.trackPlays[slug] = 0;
      }
      entry.trackPlays[slug] += 1;
      entry.updatedAt = new Date().toISOString();
      saveMixEventStatsForActiveUser();
      renderMixEventsList();
    }

    function buildCoverBackgroundValue(fileBase, coverExt) {
      const normalized = (fileBase || "").trim();
      const gradientFallback = "linear-gradient(140deg, rgba(38, 52, 110, 0.85), rgba(12, 16, 32, 0.9))";
      if (!normalized) {
        return gradientFallback;
      }
      const sources = [];
      if (coverExt) {
        sources.push(`url('${encodeURI(`img/${normalized}${coverExt}`)}')`);
      }
      sources.push(...[".webp", ".jpg", ".jpeg", ".png"].map(ext => {
        const path = encodeURI(`img/${normalized}${ext}`);
        return `url('${path}')`;
      }));
      sources.push(gradientFallback);
      return sources.join(", ");
    }

    function buildAudioSource(fileBase, customExt) {
      const normalized = (fileBase || "").trim();
      const ext = customExt || ".mp3";
      if (!normalized) {
        return "";
      }
      return encodeURI(`audio/${normalized}${ext}`);
    }

    const trackTitleCache = new Map();
    let getPersonalPlayCount = () => 0;
    let updateTrackPersonalPlayDisplay = () => {};

    function resolveTrackTitle(slug) {
      if (!slug) {
        return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç—Ä–µ–∫";
      }
      if (trackTitleCache.has(slug)) {
        return trackTitleCache.get(slug);
      }
      const trackFromLibrary = buildTrackLibrary().find(item => item.slug === slug);
      if (trackFromLibrary && trackFromLibrary.title) {
        trackTitleCache.set(slug, trackFromLibrary.title);
        return trackFromLibrary.title;
      }
      return slug;
    }

    function calculateTrackPrice(trackConfig, releaseState) {
      const basePrice = Number.parseInt(trackConfig.price, 10);
      const safeBasePrice = Number.isFinite(basePrice) ? Math.max(0, basePrice) : 0;
      if (releaseState !== "released") {
        return 1;
      }
      return safeBasePrice;
    }

    function buildTrackLibrary() {
      return releasedTracksConfig.map((trackConfig, index) => {
        const slug = (trackConfig.slug || trackConfig.file || `track-${index}`).trim();
        const releaseRaw = trackConfig.releaseDate ? String(trackConfig.releaseDate).trim() : "";
        const parsedDate = parseReleaseDate(releaseRaw);
        const releaseState = determineReleaseState(parsedDate);
        const isReleased = releaseState === "released";
        const typeLabel = (trackConfig.type || "–°–∏–Ω–≥–ª").trim() || "–°–∏–Ω–≥–ª";
        const visualStatus = determineVisualStatus(typeLabel, releaseState);
        const availability = resolveAvailability(trackConfig.access, releaseState, trackConfig);
        const availabilityLabel = formatAvailabilityLabel(availability);
        const coverBase = (trackConfig.cover || slug).trim();
        const audioBaseRaw = trackConfig.audio;
        const audioBase = audioBaseRaw === false ? "" : (audioBaseRaw || slug).trim();
        const audioSource = audioBase ? buildAudioSource(audioBase, trackConfig.audioExt) : "";
        const hasAudioAvailable = Boolean(audioSource);
        const hasAudio = hasAudioAvailable;
        const price = calculateTrackPrice(trackConfig, releaseState);
        const releaseLabel = (() => {
          if (releaseRaw && releaseRaw.toLowerCase() !== "—Å–∫–æ—Ä–æ") {
            return releaseState === "soon" ? `–°–∫–æ—Ä–æ ‚Ä¢ ${releaseRaw}` : releaseRaw;
          }
          return releaseState === "released" ? "–£–∂–µ –≤ —Å–µ—Ç–∏" : "–°–∫–æ—Ä–æ";
        })();
        const releaseDateValue = parsedDate ? parsedDate.getTime() : null;
        return {
          slug,
          title: trackConfig.title || slug,
          typeLabel,
          releaseLabel,
          releaseState,
          visualStatus,
          availability,
          availabilityLabel,
          releaseDateValue,
          likes: 2100 + index * 47,
          plays: 130000 + index * 6100,
          coverStyle: buildCoverBackgroundValue(coverBase, trackConfig.coverExt),
          audio: audioSource || "",
          hasAudio,
          hasClip: trackConfig.hasClip === true,
          clipUrl: trackConfig.clipUrl || "",
          streamUrl: trackConfig.streamUrl || audioSource || "#",
          lyrics: trackConfig.lyrics || null,
          price,
          copyright: trackConfig.copyright || `¬© ${new Date().getFullYear()} AVZAL√òV. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.`
        };
      });
    }

    function sortTrackLibrary(tracks) {
      return tracks
        .slice()
        .sort((a, b) => {
          if (a.releaseState !== b.releaseState) {
            return a.releaseState === "released" ? -1 : 1;
          }

          const aTime = a.releaseDateValue;
          const bTime = b.releaseDateValue;

          if (a.releaseState === "released") {
            // Released: newest first. Null dates are oldest.
            if (aTime === null && bTime === null) return a.title.localeCompare(b.title, "ru", { sensitivity: "base" });
            if (aTime === null) return 1;
            if (bTime === null) return -1;
            return bTime - aTime;
          } else {
            // Soon: closest first. Null dates are furthest.
            if (aTime === null && bTime === null) return a.title.localeCompare(b.title, "ru", { sensitivity: "base" });
            if (aTime === null) return 1;
            if (bTime === null) return -1;
            return aTime - bTime;
          }
        });
    }

    function createTrackCard(track) {
      const article = document.createElement("article");
      article.className = "track-card";
      if (track.slug) {
        article.dataset.trackSlug = track.slug;
      }
      article.dataset.likes = track.likes;
      article.dataset.plays = track.plays;
      article.dataset.releaseState = track.releaseState;
      article.dataset.status = track.visualStatus;
      article.dataset.availability = track.availability;
      article.dataset.hasAudio = track.hasAudio ? "true" : "false";
      article.dataset.hasClip = track.hasClip ? "true" : "false";

      const isLocked = !track.hasAudio && track.price > 0;
      if (isLocked) {
        article.classList.add("track-locked");
        article.dataset.trackLocked = track.slug;
        article.dataset.trackPrice = track.price;
      }

      if (track.slug) {
        trackTitleCache.set(track.slug, track.title);
      }

      const personalPlayCount = getPersonalPlayCount(track.slug);
      const personalMarkup = `
          <div class="track-user-plays" data-track-personal="${track.slug}"${personalPlayCount > 0 ? "" : " hidden"}>
            –¢–≤–æ–∏—Ö –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π: <span>${formatCount(personalPlayCount)}</span>
          </div>
        `;

      const playerControlsClass = track.hasAudio ? "player-controls" : "player-controls is-disabled";
      const playButtonAttributes = track.hasAudio
        ? 'class="track-play-toggle" type="button" aria-label="–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ç—Ä–µ–∫"'
        : 'class="track-play-toggle" type="button" aria-label="–ü—Ä–µ–¥–ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ" disabled';
      
      const priceMarkup = isLocked
        ? `<div class="track-price">
             <span class="ruzcoin-icon is-inline" aria-hidden="true"><span class="ruzcoin-glyph">…å</span></span>
             –¶–µ–Ω–∞ —Ä–∞–Ω–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞: ${track.price} RUZCOIN
           </div>`
        : '';

      const audioMarkup = track.hasAudio
        ? `<audio class="track-audio" src="${track.audio}" preload="metadata"></audio>`
        : '';

      const clipIndicatorMarkup = track.hasClip
        ? `<a class="track-clip-indicator" href="${track.clipUrl || '#'}" target="_blank" rel="noopener" title="–û—Ç–∫—Ä—ã—Ç—å –∫–ª–∏–ø"><i class="fas fa-video"></i>–ö–ª–∏–ø</a>`
        : '<span class="track-clip-indicator is-missing" title="–ö–ª–∏–ø –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"><i class="fas fa-video-slash"></i>–ù–µ—Ç –∫–ª–∏–ø–∞</span>';

      const clipActionMarkup = track.hasClip
        ? `<a class="track-action-btn" href="${track.clipUrl || '#'}" target="_blank" rel="noopener"><i class="fas fa-video"></i><span>–ö–ª–∏–ø</span></a>`
        : '<button class="track-action-btn" type="button" disabled><i class="fas fa-video-slash"></i><span>–ö–ª–∏–ø</span></button>';

      const unlockActionMarkup = isLocked
        ? `<button class="track-action-btn unlock-btn" data-track-id="${track.slug}" data-unlock-price="${track.price}"><i class="fas fa-key"></i><span>–û—Ç–∫—Ä—ã—Ç—å</span></button>`
        : '';

      article.innerHTML = `
        <div class="track-cover" style="background-image:${track.coverStyle};">
          <div class="play-overlay"><i class="fas ${isLocked ? 'fa-lock' : 'fa-play'}"></i></div>
        </div>
        <div class="track-info">
          <div class="track-title-row">
            <div class="track-title">${track.title}</div>
            <span class="track-badge ${track.availability}">${track.availabilityLabel}</span>
          </div>
          <div class="track-meta">
            <span>${track.typeLabel}</span>
            <span class="dot"></span>
            <span>${track.releaseLabel}</span>
            ${clipIndicatorMarkup}
          </div>
          <div class="track-stats">
            <button class="track-like-btn" type="button" aria-label="–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å" aria-pressed="false">
              <i class="fas fa-heart"></i>
              <span class="track-like-count">${formatCount(track.likes)}</span>
            </button>
            <div class="track-plays" aria-label="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π">
              <i class="fas fa-chart-line"></i>
              <span class="track-plays-count">${formatCount(track.plays)}</span>
            </div>
          </div>
          ${personalMarkup}
          ${priceMarkup}
          <div class="${playerControlsClass}">
            <button ${playButtonAttributes}>
              <i class="fas ${isLocked ? 'fa-lock' : 'fa-play'}"></i>
            </button>
            <div class="progress-bar-wrapper">
              <div class="progress-bar"><div class="progress-bar-filled"></div></div>
              <span class="time-display">${track.hasAudio ? '0:00 / 0:00' : '–°–∫–æ—Ä–æ'}</span>
            </div>
          </div>
          <div class="track-actions">
            ${unlockActionMarkup}
            <button class="track-action-btn lyrics-btn"><i class="fas fa-align-left"></i><span>–¢–µ–∫—Å—Ç</span></button>
            ${clipActionMarkup}
          </div>
          <div class="track-copyright">${track.copyright}</div>
        </div>
        ${audioMarkup}
        <div class="lyrics-content" style="display: none;"></div>
      `;
      const lyricsContainer = article.querySelector(".lyrics-content");
      if (lyricsContainer && Array.isArray(track.lyrics) && track.lyrics.length > 0) {
        lyricsContainer.textContent = track.lyrics.join("\n");
      }
      return article;
    }

    function renderTracksGrid(tracks) {
      if (!tracksGrid) {
        return;
      }
      tracksGrid.innerHTML = '';
      if (!tracks || tracks.length === 0) {
        const placeholder = document.createElement('p');
        placeholder.className = 'section-sub';
        placeholder.textContent = '–ù–µ—Ç —Ä–µ–ª–∏–∑–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.';
        tracksGrid.appendChild(placeholder);
        return;
      }
      tracks.forEach(track => {
        const card = createTrackCard(track);
        tracksGrid.appendChild(card);
        if (track && track.slug) {
          updateTrackPersonalPlayDisplay(track.slug);
        }
      });
    }

    function focusTrackCardBySlug(slug) {
      if (!slug) {
        return;
      }
      const targetCard = document.querySelector(`.track-card[data-track-slug="${slug}"]`);
      if (!targetCard) {
        return;
      }
      targetCard.scrollIntoView({ behavior: "smooth", block: "center" });
      targetCard.classList.add("is-highlighted");
      window.setTimeout(() => {
        targetCard.classList.remove("is-highlighted");
      }, 1600);
    }

    function renderClipsGrid(tracks) {
      if (!clipsGrid) {
        return;
      }
      clipsGrid.innerHTML = '';
      if (!tracks || !tracks.length) {
        clipsGrid.innerHTML = '<p class="users-empty">–ù–µ—Ç —Ä–µ–ª–∏–∑–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>';
        return;
      }
      const clips = tracks.filter(track => track.hasClip);
      if (!clips.length) {
        clipsGrid.innerHTML = '<p class="users-empty">–ö–ª–∏–ø—ã –ø–æ—è–≤—è—Ç—Å—è –ø–æ–∑–∂–µ ‚Äî —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.</p>';
        return;
      }
      clips.forEach(track => {
        const card = createTrackCard(track);
        clipsGrid.appendChild(card);
        if (track && track.slug) {
          updateTrackPersonalPlayDisplay(track.slug);
        }
      });
    }

    function updateLyricsModalTheme(slug) {
      const isYashlek = slug === LYRICS_DESYNC_SLUG;
      if (lyricsModal) {
        lyricsModal.classList.toggle("is-yashlek", isYashlek);
      }
      if (lyricsModalText) {
        lyricsModalText.classList.toggle("is-yashlek", isYashlek);
      }
    }

    function renderLyricsBody(rawText, slug) {
      if (!lyricsModalText) {
        return;
      }
      const lines = rawText.split(/\r?\n/);
      const fragment = document.createDocumentFragment();
      lines.forEach(line => {
        const trimmed = line.trim();
        if (!trimmed) {
          const spacer = document.createElement("div");
          spacer.className = "lyrics-space";
          fragment.appendChild(spacer);
          return;
        }
        if (slug === LYRICS_DESYNC_SLUG) {
          const lineEl = document.createElement("div");
          lineEl.className = "lyrics-line";
          const main = document.createElement("span");
          main.className = "lyrics-line-main";
          main.textContent = trimmed;
          const ghost = document.createElement("span");
          ghost.className = "lyrics-line-ghost";
          ghost.textContent = trimmed;
          lineEl.append(main, ghost);
          fragment.appendChild(lineEl);
        } else {
          const paragraph = document.createElement("p");
          paragraph.className = "lyrics-paragraph";
          paragraph.textContent = trimmed;
          fragment.appendChild(paragraph);
        }
      });
      lyricsModalText.innerHTML = "";
      lyricsModalText.appendChild(fragment);
      lyricsModalText.scrollTop = 0;
    }

    function stopLyricsDesync(clearState = true) {
      if (lyricsDesyncTimer) {
        clearInterval(lyricsDesyncTimer);
        lyricsDesyncTimer = null;
      }
      if (clearState && lyricsModalText) {
        lyricsModalText
          .querySelectorAll(".lyrics-line")
          .forEach(line => line.classList.remove("is-desync"));
      }
    }

    function startLyricsDesync() {
      if (!lyricsModalText) {
        return;
      }
      const lines = Array.from(lyricsModalText.querySelectorAll(".lyrics-line"));
      if (!lines.length) {
        return;
      }
      stopLyricsDesync(false);
      lyricsDesyncTimer = window.setInterval(() => {
        const randomLine = lines[Math.floor(Math.random() * lines.length)];
        randomLine.classList.add("is-desync");
        window.setTimeout(() => randomLine.classList.remove("is-desync"), 900);
      }, 1200);
    }

    function updateLyricsDesyncState() {
      if (
        lyricsModalOverlay.classList.contains("visible") &&
        lyricsActiveSlug === LYRICS_DESYNC_SLUG &&
        lyricsActiveCard &&
        lyricsActiveCard.classList.contains("playing")
      ) {
        startLyricsDesync();
      } else {
        stopLyricsDesync();
      }
    }

    function closeLyricsModal() {
      if (!lyricsModalOverlay.classList.contains("visible")) {
        return;
      }
      lyricsModalOverlay.classList.remove("visible");
      lyricsModalOverlay.dataset.activeSlug = "";
      lyricsActiveCard = null;
      lyricsActiveSlug = "";
      stopLyricsDesync();
    }

    function renderAllTrackGrids(library) {
      renderTracksGrid(library);
      renderClipsGrid(library);
    }

    let trackLibrary = sortTrackLibrary(buildTrackLibrary());
    renderAllTrackGrids(trackLibrary);
    // initializeMixEventsSchedule();

    if (!releasedTracksConfig.length) {
      loadFallbackReleases().then(fallback => {
        if (Array.isArray(fallback) && fallback.length) {
          releasedTracksConfig = fallback;
          trackLibrary = sortTrackLibrary(buildTrackLibrary());
          renderAllTrackGrids(trackLibrary);
          rebindTrackCardEvents();
        }
      });
    }

    const lyricsModal = document.querySelector(".lyrics-modal");
    const prefersReducedMotion =
      typeof window.matchMedia === "function"
        ? window.matchMedia("(prefers-reduced-motion: reduce)")
        : { matches: false };
    const miniPlayer = document.getElementById("miniPlayer");
    const miniPlayerCover = document.getElementById("miniPlayerCover");
    const miniPlayerTitle = document.getElementById("miniPlayerTitle");
    const miniPlayerPlayBtn = document.getElementById("miniPlayerPlayBtn");
    const miniPlayerPlayIcon = miniPlayerPlayBtn ? miniPlayerPlayBtn.querySelector("i") : null;
    const miniPlayerPrevBtn = document.getElementById("miniPlayerPrevBtn");
    const miniPlayerNextBtn = document.getElementById("miniPlayerNextBtn");
    const miniPlayerCurrentTime = document.getElementById("miniPlayerCurrentTime");
    const miniPlayerDuration = document.getElementById("miniPlayerDuration");
    const miniPlayerProgressBar = document.getElementById("miniPlayerProgressBar");
    const miniPlayerProgressFilled = document.getElementById("miniPlayerProgressFilled");
    const miniPlayerLyricsBtn = document.getElementById("miniPlayerLyricsBtn");
    const volumeSlider = document.getElementById("volumeSlider");
    const lyricsModalOverlay = document.getElementById("lyricsModalOverlay");
    const lyricsModalTitle = document.getElementById("lyricsModalTitle");
    const lyricsModalText = document.getElementById("lyricsModalText");
    const lyricsCloseBtn = document.getElementById("lyricsCloseBtn");
    const statsCardEl = document.getElementById("listeningStatsCard");
    const statTotalPlaysEl = document.getElementById("statTotalPlays");
    const statUniqueTracksEl = document.getElementById("statUniqueTracks");
    const statTopTrackEl = document.getElementById("statTopTrack");
    const statTopTrackCountEl = document.getElementById("statTopTrackCount");
    const statsNoteEl = document.getElementById("statsNote");
    const recentListeningListEl = document.getElementById("recentListeningList");
    const historyEarnedEl = document.getElementById("historyEarned");
    const historySpentEl = document.getElementById("historySpent");
    const historyNetEl = document.getElementById("historyNet");
    const coinHistoryListEl = document.getElementById("coinHistoryList");
    const coinHistoryEmptyEl = document.getElementById("coinHistoryEmpty");
    const trackRealtimeStats = new Map();
    const LYRICS_DESYNC_SLUG = "yashlek";

    let currentAudio = null;
    let currentCard = null;
    let lyricsActiveCard = null;
    let lyricsActiveSlug = "";
    let lyricsDesyncTimer = null;

    function getStoredVolume() {
      try {
        const storedValue = localStorage.getItem(VOLUME_STORAGE_KEY);
        const parsedValue = parseFloat(storedValue);
        if (Number.isFinite(parsedValue) && parsedValue >= 0 && parsedValue <= 1) {
          return parsedValue;
        }
      } catch (error) {}
      return null;
    }

    function persistVolume(value) {
      if (!Number.isFinite(value)) return;
      try {
        localStorage.setItem(VOLUME_STORAGE_KEY, String(value));
      } catch (error) {}
    }

    function applyVolumeToAll(volume) {
      if (!Number.isFinite(volume)) return;
      document.querySelectorAll(".track-audio").forEach(audio => {
        audio.volume = volume;
      });
      if (currentAudio) {
        currentAudio.volume = volume;
      }
    }

    const storedVolume = getStoredVolume();
    const initialVolume = Number.isFinite(storedVolume)
      ? storedVolume
      : parseFloat(volumeSlider ? volumeSlider.value : "1");
    if (volumeSlider && Number.isFinite(initialVolume)) {
      volumeSlider.value = initialVolume.toString();
    }
    applyVolumeToAll(Number.isFinite(initialVolume) ? initialVolume : 1);

    function setDefaultTilt(card) {
      if (!card) return;
      card.style.setProperty("--tilt-x", "0deg");
      card.style.setProperty("--tilt-y", "0deg");
      card.style.setProperty("--glow-x", "50%");
      card.style.setProperty("--glow-y", "50%");
    }

    function handleCardPointerMove(event) {
      const card = event.currentTarget;
      const rect = card.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      const rotateX = ((rect.height / 2 - y) / rect.height) * 12;
      const rotateY = ((x - rect.width / 2) / rect.width) * 16;
      card.style.setProperty("--tilt-x", `${rotateX.toFixed(2)}deg`);
      card.style.setProperty("--tilt-y", `${rotateY.toFixed(2)}deg`);
      card.style.setProperty("--glow-x", `${((x / rect.width) * 100).toFixed(2)}%`);
      card.style.setProperty("--glow-y", `${((y / rect.height) * 100).toFixed(2)}%`);
    }

    function handleCardPointerLeave(event) {
      setDefaultTilt(event.currentTarget);
    }

    function bindInteractiveMotion() {
      document.querySelectorAll(".track-card").forEach(card => {
        if (card.dataset.motion === "off" || card.__motionBound) {
          return;
        }
        setDefaultTilt(card);
        card.addEventListener("pointermove", handleCardPointerMove);
        card.addEventListener("pointerleave", handleCardPointerLeave);
        card.addEventListener("pointerup", handleCardPointerLeave);
        card.__motionBound = true;
      });
    }

    function unbindInteractiveMotion() {
      document.querySelectorAll(".track-card").forEach(card => {
        if (!card.__motionBound) {
          setDefaultTilt(card);
          return;
        }
        card.removeEventListener("pointermove", handleCardPointerMove);
        card.removeEventListener("pointerleave", handleCardPointerLeave);
        card.removeEventListener("pointerup", handleCardPointerLeave);
        card.__motionBound = false;
        setDefaultTilt(card);
      });
    }

    if (!prefersReducedMotion.matches) {
      bindInteractiveMotion();
    } else {
      document.querySelectorAll(".track-card").forEach(setDefaultTilt);
    }

    const handleMotionPreferenceChange = event => {
      if (event.matches) {
        unbindInteractiveMotion();
      } else {
        bindInteractiveMotion();
      }
    };

    if (typeof prefersReducedMotion.addEventListener === "function") {
      prefersReducedMotion.addEventListener("change", handleMotionPreferenceChange);
    } else if (typeof prefersReducedMotion.addListener === "function") {
      prefersReducedMotion.addListener(handleMotionPreferenceChange);
    }

    function clearBodyCover() {
      document.body.classList.remove("has-active-cover");
      document.body.style.removeProperty("--active-cover");
    }

    function setBodyCover(card) {
      if (!card) {
        clearBodyCover();
        return;
      }
      const cover = card.querySelector(".track-cover");
      const backgroundImage = cover ? cover.style.backgroundImage : "";
      if (backgroundImage) {
        document.body.style.setProperty("--active-cover", backgroundImage);
        document.body.classList.add("has-active-cover");
      } else {
        clearBodyCover();
      }
    }

    function formatTime(seconds) {
      if (!Number.isFinite(seconds)) {
        return "0:00";
      }
      const minutes = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${minutes}:${secs < 10 ? "0" : ""}${secs}`;
    }

    function formatCount(value) {
      return numberFormatter.format(Math.max(0, Math.floor(value)));
    }

    function setupTrackStats(card) {
      if (trackRealtimeStats.has(card)) {
        return;
      }
      const likeBtn = card.querySelector(".track-like-btn");
      const likeCountEl = card.querySelector(".track-like-count");
      const playsCountEl = card.querySelector(".track-plays-count");
      const baseLikes = Number.parseInt(card.dataset.likes || "0", 10);
      const basePlays = Number.parseInt(card.dataset.plays || "0", 10);
      const stats = {
        baseLikes,
        likeBtn,
        likeCountEl,
        liked: false,
        basePlays,
        playsCountEl,
        elapsedSeconds: 0,
        lastSecondMark: 0
      };
      if (likeCountEl) {
        likeCountEl.textContent = formatCount(baseLikes);
      }
      if (playsCountEl) {
        playsCountEl.textContent = formatCount(basePlays);
      }
      if (likeBtn) {
        likeBtn.addEventListener("click", () => toggleLike(card));
      }
      trackRealtimeStats.set(card, stats);
    }

    function toggleLike(card) {
      const stats = trackRealtimeStats.get(card);
      if (!stats || !stats.likeBtn || !stats.likeCountEl) {
        return;
      }
      stats.liked = !stats.liked;
      stats.likeBtn.classList.toggle("is-liked", stats.liked);
      stats.likeBtn.setAttribute("aria-pressed", stats.liked ? "true" : "false");
      const totalLikes = stats.baseLikes + (stats.liked ? 1 : 0);
      stats.likeCountEl.textContent = formatCount(totalLikes);
    }

    function updateTrackPlays(card, audio) {
      const stats = trackRealtimeStats.get(card);
      if (!stats || !stats.playsCountEl) {
        return;
      }
      const currentSecond = Math.floor(audio.currentTime || 0);
      if (currentSecond < stats.lastSecondMark) {
        stats.lastSecondMark = currentSecond;
        return;
      }
      if (currentSecond > stats.lastSecondMark) {
        stats.elapsedSeconds += currentSecond - stats.lastSecondMark;
        stats.lastSecondMark = currentSecond;
        stats.playsCountEl.textContent = formatCount(stats.basePlays + stats.elapsedSeconds);
      }
    }

    function resetRealtimeMarker(card, currentTime = 0) {
      const stats = trackRealtimeStats.get(card);
      if (!stats) {
        return;
      }
      stats.lastSecondMark = Math.floor(Math.max(0, currentTime));
    }

    function setCardIcons(card, isPlaying) {
      const overlayIcon = card.querySelector(".play-overlay i");
      const toggleIcon = card.querySelector(".track-play-toggle i");
      const iconClass = isPlaying ? "fa-pause" : "fa-play";
      if (overlayIcon) {
        overlayIcon.className = `fas ${iconClass}`;
      }
      if (toggleIcon) {
        toggleIcon.className = `fas ${iconClass}`;
      }
    }

    function resetCard(card, audio) {
      card.classList.remove("playing");
      setCardIcons(card, false);
      const progressFilled = card.querySelector(".progress-bar-filled");
      if (progressFilled) {
        progressFilled.style.width = "0%";
      }
      const timeDisplay = card.querySelector(".time-display");
      if (timeDisplay) {
        const durationText = formatTime(audio.duration);
        timeDisplay.textContent = `0:00 / ${durationText}`;
      }
      resetRealtimeMarker(card, 0);
    }

    function updateMiniPlayerLyricsState(card) {
      if (!miniPlayerLyricsBtn) return;
      const hasLyrics = Boolean(
        card &&
        card.querySelector(".lyrics-content") &&
        card.querySelector(".lyrics-content").textContent.trim()
      );
      if (hasLyrics) {
        miniPlayerLyricsBtn.removeAttribute("disabled");
      } else {
        miniPlayerLyricsBtn.setAttribute("disabled", "disabled");
      }
    }

    function clearMiniPlayer() {
      if (!miniPlayer || !miniPlayerCover || !miniPlayerTitle || !miniPlayerCurrentTime || !miniPlayerDuration || !miniPlayerProgressFilled || !miniPlayerPlayIcon) {
        return;
      }
      miniPlayer.classList.remove("is-active");
      miniPlayerCover.style.backgroundImage = "";
      miniPlayerTitle.textContent = "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞";
      miniPlayerCurrentTime.textContent = "0:00";
      miniPlayerDuration.textContent = "0:00";
      miniPlayerProgressFilled.style.width = "0%";
      miniPlayerPlayIcon.className = "fas fa-play";
      updateMiniPlayerLyricsState(null);
      clearBodyCover();
    }

    function updateMiniPlayer(card, audio) {
      if (!miniPlayer || !miniPlayerCover || !miniPlayerTitle || !miniPlayerCurrentTime || !miniPlayerDuration || !miniPlayerProgressFilled || !miniPlayerPlayIcon) {
        return;
      }
      if (!card || !audio) {
        clearMiniPlayer();
        return;
      }
      miniPlayer.classList.add("is-active");
      const titleEl = card.querySelector(".track-title");
      const coverEl = card.querySelector(".track-cover");
      if (titleEl) {
        miniPlayerTitle.textContent = titleEl.textContent;
      }
      if (coverEl) {
        miniPlayerCover.style.backgroundImage = coverEl.style.backgroundImage;
      }
      miniPlayerCurrentTime.textContent = formatTime(audio.currentTime);
      miniPlayerDuration.textContent = formatTime(audio.duration);
      miniPlayerPlayIcon.className = audio.paused ? "fas fa-play" : "fas fa-pause";
      updateMiniPlayerLyricsState(card);
    }

    function stopAllExcept(cardToKeep) {
      document.querySelectorAll(".track-card").forEach(card => {
        const audio = card.querySelector(".track-audio");
        if (!audio || card === cardToKeep) {
          return;
        }
        audio.pause();
        audio.currentTime = 0;
        audio.__countedPlay = false;
        resetCard(card, audio);
        if (lyricsActiveCard === card) {
          updateLyricsDesyncState();
        }
      });
      if (!cardToKeep) {
        currentAudio = null;
        currentCard = null;
        clearMiniPlayer();
      }
    }

    function handleToggle(card, audio) {
      if (!audio) return;
      if (audio.paused) {
        const volumeValue = volumeSlider ? volumeSlider.value : "1";
        audio.volume = parseFloat(volumeValue);
        audio.play();
      } else {
        audio.pause();
      }
    }

    function getPlayableCards() {
      return Array.from(document.querySelectorAll('.track-card[data-has-audio="true"]'));
    }

    function findAdjacentCard(direction = 1) {
      const cards = getPlayableCards();
      if (!cards.length) {
        return null;
      }
      const currentIndex = currentCard ? cards.indexOf(currentCard) : -1;
      if (currentIndex === -1) {
        return cards[0];
      }
      const nextIndex = (currentIndex + direction + cards.length) % cards.length;
      return cards[nextIndex];
    }

    function playCard(card) {
      if (!card) {
        return;
      }
      const audio = card.querySelector(".track-audio");
      if (!audio) {
        return;
      }
      stopAllExcept(card);
      const volumeValue = volumeSlider ? parseFloat(volumeSlider.value) : 1;
      audio.volume = volumeValue;
      audio.currentTime = 0;
      audio.play();
      card.scrollIntoView({ behavior: "smooth", block: "center" });
    }

    function markAudioUnavailable(card, audio) {
      if (audio) {
        audio.pause();
        audio.removeAttribute("src");
      }
      if (card) {
        card.dataset.hasAudio = "false";
        card.classList.add("audio-error");
        const playToggle = card.querySelector(".track-play-toggle");
        if (playToggle) {
          playToggle.disabled = true;
          playToggle.setAttribute("aria-label", "–ü—Ä–µ–¥–ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ");
        }
        const overlayIcon = card.querySelector(".play-overlay i");
        if (overlayIcon) {
          overlayIcon.className = "fas fa-ban";
        }
        const timeDisplay = card.querySelector(".time-display");
        if (timeDisplay) {
          timeDisplay.textContent = "–ù–µ—Ç –ø—Ä–µ–≤—å—é";
        }
      }
      if (currentAudio === audio) {
        currentAudio = null;
        currentCard = null;
        clearMiniPlayer();
      }
    }

    function openLyrics(card) {
      if (!card) {
        return;
      }
      const lyricsContent = card.querySelector(".lyrics-content");
      const rawLyrics = lyricsContent ? lyricsContent.textContent.trim() : "";
      if (!rawLyrics) {
        return;
      }
      const slug = (card.dataset.trackSlug || "").toLowerCase();
      const title = card.querySelector(".track-title");
      if (title) {
        lyricsModalTitle.textContent = title.textContent;
      }
      updateLyricsModalTheme(slug);
      renderLyricsBody(rawLyrics, slug);
      lyricsModalOverlay.classList.add("visible");
      lyricsModalOverlay.dataset.activeSlug = slug;
      lyricsActiveCard = card;
      lyricsActiveSlug = slug;
      if (slug !== LYRICS_DESYNC_SLUG) {
        stopLyricsDesync();
      }
      updateLyricsDesyncState();
    }
    
    function rebindTrackCardEvents() {
      document.querySelectorAll(".track-card").forEach(card => {
        const audio = card.querySelector(".track-audio");
        const cover = card.querySelector(".track-cover");
        const toggle = card.querySelector(".track-play-toggle");
        const progressBar = card.querySelector(".progress-bar");
        const lyricsBtn = card.querySelector(".lyrics-btn");

        setupTrackStats(card);

        if (lyricsBtn) {
          lyricsBtn.addEventListener("click", () => openLyrics(card));
        }

        if (!audio) return;

        const timeDisplay = card.querySelector(".time-display");
        if (timeDisplay) timeDisplay.textContent = "0:00 / 0:00";

        audio.addEventListener("loadedmetadata", () => {
          if (timeDisplay) timeDisplay.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
          if (audio === currentAudio) miniPlayerDuration.textContent = formatTime(audio.duration);
        });

        audio.addEventListener("error", () => {
          markAudioUnavailable(card, audio);
        });

        [cover, toggle].forEach(control => {
          if (control) control.addEventListener("click", () => handleToggle(card, audio));
        });

        audio.addEventListener("play", () => {
          handleListeningStatIncrement(card, audio);
          stopAllExcept(card);
          currentAudio = audio;
          currentCard = card;
          card.classList.add("playing");
          setCardIcons(card, true);
          updateMiniPlayer(card, audio);
          resetRealtimeMarker(card, audio.currentTime);
          setBodyCover(card);
          if (lyricsActiveCard === card) updateLyricsDesyncState();
        });

        audio.addEventListener("pause", () => {
          setCardIcons(card, false);
          card.classList.remove("playing");
          resetRealtimeMarker(card, audio.currentTime);
          if (currentAudio === audio) updateMiniPlayer(card, audio);
          clearBodyCover();
          if (lyricsActiveCard === card) updateLyricsDesyncState();
        });

        audio.addEventListener("timeupdate", () => {
          updateTrackPlays(card, audio);
          const hasDuration = Number.isFinite(audio.duration) && audio.duration > 0;
          const progress = hasDuration ? (audio.currentTime / audio.duration) * 100 : 0;
          const progressFilled = card.querySelector(".progress-bar-filled");
          if (progressFilled) progressFilled.style.width = `${progress}%`;
          if (timeDisplay) timeDisplay.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
          if (currentAudio === audio) {
            miniPlayerProgressFilled.style.width = `${progress}%`;
            miniPlayerCurrentTime.textContent = formatTime(audio.currentTime);
            miniPlayerDuration.textContent = formatTime(audio.duration);
          }
        });

        audio.addEventListener("ended", () => {
          audio.__countedPlay = false;
          resetCard(card, audio);
          const nextCard = findAdjacentCard(1);
          if (nextCard && nextCard !== card) {
            playCard(nextCard);
            return;
          }
          if (currentAudio === audio) {
            currentAudio = null;
            currentCard = null;
            clearMiniPlayer();
          }
          if (lyricsActiveCard === card) updateLyricsDesyncState();
        });

        audio.addEventListener("seeked", () => {
          resetRealtimeMarker(card, audio.currentTime);
          if (audio.currentTime <= 0.5) {
            audio.__countedPlay = false;
          }
          if (lyricsActiveCard === card) updateLyricsDesyncState();
        });

        if (progressBar) {
          progressBar.addEventListener("click", event => {
            if (!Number.isFinite(audio.duration) || audio.duration === 0) return;
            const rect = progressBar.getBoundingClientRect();
            const ratio = (event.clientX - rect.left) / rect.width;
            audio.currentTime = Math.max(0, Math.min(audio.duration, ratio * audio.duration));
          });
        }
      });
      bindInteractiveMotion();
    }

    rebindTrackCardEvents();

    if (miniPlayerPlayBtn) {
      miniPlayerPlayBtn.addEventListener("click", () => {
        if (!currentAudio) return;
        handleToggle(currentCard, currentAudio);
      });
    }

    if (miniPlayerPrevBtn) {
      miniPlayerPrevBtn.addEventListener("click", () => {
        const prevCard = findAdjacentCard(-1);
        playCard(prevCard);
      });
    }

    if (miniPlayerNextBtn) {
      miniPlayerNextBtn.addEventListener("click", () => {
        const nextCard = findAdjacentCard(1);
        playCard(nextCard);
      });
    }

    if (miniPlayerProgressBar) {
      miniPlayerProgressBar.addEventListener("click", event => {
        if (!currentAudio || !Number.isFinite(currentAudio.duration) || currentAudio.duration === 0) {
          return;
        }
        const rect = miniPlayerProgressBar.getBoundingClientRect();
        const ratio = (event.clientX - rect.left) / rect.width;
        currentAudio.currentTime = Math.max(0, Math.min(currentAudio.duration, ratio * currentAudio.duration));
      });
    }

    if (volumeSlider) {
      volumeSlider.addEventListener("input", event => {
        const volume = parseFloat(event.target.value);
        applyVolumeToAll(volume);
        persistVolume(volume);
      });
    }

    if (miniPlayerLyricsBtn) {
      miniPlayerLyricsBtn.addEventListener("click", () => openLyrics(currentCard));
    }

    if (lyricsCloseBtn) {
      lyricsCloseBtn.addEventListener("click", closeLyricsModal);
    }

    if (lyricsModalOverlay) {
      lyricsModalOverlay.addEventListener("click", event => {
        if (event.target === lyricsModalOverlay) {
          closeLyricsModal();
        }
      });
    }

    document.addEventListener("keydown", event => {
      if (event.key === "Escape") {
        closeLyricsModal();
      }
    });

    (async function () {
      const STORAGE_KEY = "avzalov_profile_v1";
      const USERS_REGISTRY_KEY = "avzalov_users_registry_v1";
      const USED_CODES_KEY = "avzalov_used_admin_codes_v1";
        const USERS_DATA_ENDPOINT = "data/users.json";
        const ADMIN_CODES_ENDPOINT = "data/admin-codes.json";
        const WELCOME_BONUS = 1;
        const LISTENING_STATS_KEY = "avzalov_listening_stats_v1";
        const COIN_HISTORY_KEY = "avzalov_coin_history_v1";
        const DEMO_TOPUP_KEY = "avzalov_demo_topup_claimed_v1";
        const DEMO_BONUS_KEY = "avzalov_demo_bonus_claimed_v1";
        const MAX_HISTORY_ENTRIES = 100;
        const MAX_RECENT_LISTENS = 6;

        let listeningStatsRegistry = loadListeningStatsRegistry();
        let coinHistoryRegistry = loadCoinHistoryRegistry();
        mixEventStatsRegistry = loadMixEventStatsRegistry();
        let listeningStats = createEmptyListeningStats();
        let coinHistory = [];
        mixEventStats = createEmptyMixEventStats();
        let activeUserId = "guest";

        const roleLabelMap = {
          admin: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
          listener: "–°–ª—É—à–∞—Ç–µ–ª—å",
          moderator: "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä"
        };

      const profilePanelEl = document.getElementById("profilePanel");
      const profileEmptyEl = document.getElementById("profileEmpty");
      const profileNameEl = document.getElementById("profileName");
      const profileIdEl = document.getElementById("profileId");
      const profileRoleEl = document.getElementById("profileRole");
      const coinsAmountEl = document.getElementById("coinsAmount");
      const achievementsGridEl = document.getElementById("achievementsGrid");

      const loginForm = document.getElementById("loginForm");
      const adminCodeForm = document.getElementById("adminCodeForm");
      const adminCodeInput = document.getElementById("adminCodeInput");
      const adminNameInput = document.getElementById("adminNameInput");
      const adminLoginToggle = document.getElementById("adminLoginToggle");
      const earnDemoBtn = document.getElementById("earnDemoCoinsBtn");
      const profileTopupBtn = document.getElementById("profileTopupBtn");
      const logoutButtons = Array.from(document.querySelectorAll('[data-action="logout"]'));
      const adminToolsEl = document.getElementById("adminTools");
      const adminGiftForm = document.getElementById("adminGiftForm");
      const giftUserIdInput = document.getElementById("giftUserId");
      const giftAmountInput = document.getElementById("giftAmount");
      const adminGiftStatusEl = document.getElementById("adminGiftStatus");

      const headerCoinsBtn = document.getElementById("headerCoinsBtn");
      const headerCoinsPopover = document.getElementById("headerCoinsPopover");
      const coinsInfoBtn = document.getElementById("coinsInfoBtn");
      const headerProfileBtn = document.getElementById("headerProfileBtn");
      const headerProfilePopover = document.getElementById("headerProfilePopover");
      const headerProfileNameEl = document.getElementById("headerProfileName");
      const headerProfileAvatarEl = document.getElementById("headerProfileAvatar");
      const headerCoinsAmountEl = document.getElementById("headerCoinsAmount");
      const openProfileSectionBtn = document.getElementById("openProfileSectionBtn");
      const headerUsersPopover = document.getElementById("headerUsersPopover");
      const headerUsersListEl = document.getElementById("headerUsersList");
      const openUsersSectionBtn = document.getElementById("openUsersSectionBtn");
      const headerSectionShortcuts = Array.from(
        document.querySelectorAll("[data-open-section]")
      );
      const popoverProfileNameEl = document.getElementById("popoverProfileName");
      const popoverProfileIdEl = document.getElementById("popoverProfileId");
      const popoverCoinsAmountEl = document.getElementById("popoverCoinsAmount");
      const popoverProfileRoleEl = document.getElementById("popoverProfileRole");
      const popoverAvatarEl = document.getElementById("popoverAvatar");
      const ruzcoinPriceValueEl = document.getElementById("ruzcoinPriceValue");
      const profileAvatarEl = document.getElementById("profileAvatar");
      const profileAvatarInitialsEl = document.getElementById("profileAvatarInitials");
      const profileAvatarInput = document.getElementById("profileAvatarInput");
      const profileAvatarUploadBtn = document.getElementById("profileAvatarUploadBtn");
      const profileAvatarResetBtn = document.getElementById("profileAvatarResetBtn");

      let currentUser = null;
      let usersRegistry = new Map();
      let adminCodes = new Map();
      let usedAdminCodes = {};
      const popoverControllers = [];
      let coinsPopoverController = null;
      let profilePopoverController = null;
      let usersPopoverController = null;
      let mixPopoverController = null;

      const profilePopoverLoggedOutSection = headerProfilePopover
        ? headerProfilePopover.querySelector('[data-state="logged-out"]')
        : null;
      const profilePopoverLoggedInSection = headerProfilePopover
        ? headerProfilePopover.querySelector('[data-state="logged-in"]')
        : null;

      const baseAchievements = [
        { id: "welcome", title: "–ù–æ–≤—ã–π —Å–ª—É—à–∞—Ç–µ–ª—å", desc: "–í–æ—à—ë–ª –≤ –ø—Ä–æ—Ñ–∏–ª—å –≤–ø–µ—Ä–≤—ã–µ.", coins: 1 },
        { id: "first_unlock", title: "–ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø", desc: "–û—Ç–∫—Ä—ã–ª –∑–∞–∫—Ä—ã—Ç—ã–π —Ç—Ä–µ–∫.", coins: 0 },
        { id: "collector", title: "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", desc: "–û—Ç–∫—Ä—ã–ª 3 –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç—Ä–µ–∫–∞.", coins: 0 }
      ];

      function createEmptyListeningStats() {
        return {
          totalPlays: 0,
          trackPlays: {},
          recent: []
        };
      }

      function sanitizeListeningStats(rawStats) {
        const base = createEmptyListeningStats();
        if (!rawStats || typeof rawStats !== "object") {
          return base;
        }
        const total = Number(rawStats.totalPlays);
        if (Number.isFinite(total)) {
          base.totalPlays = Math.max(0, Math.floor(total));
        }
        if (rawStats.trackPlays && typeof rawStats.trackPlays === "object") {
          base.trackPlays = {};
          Object.entries(rawStats.trackPlays).forEach(([slug, count]) => {
            if (typeof slug === "string") {
              const numericCount = Number(count);
              if (Number.isFinite(numericCount) && numericCount > 0) {
                base.trackPlays[slug] = Math.max(0, Math.floor(numericCount));
              }
            }
          });
        }
        if (Array.isArray(rawStats.recent)) {
          base.recent = rawStats.recent
            .filter(entry => entry && typeof entry === "object")
            .slice(0, MAX_RECENT_LISTENS)
            .map(entry => ({
              slug: typeof entry.slug === "string" ? entry.slug : "",
              title: entry.title ? String(entry.title) : resolveTrackTitle(entry.slug || ""),
              time: entry.time ? String(entry.time) : new Date().toLocaleString("ru-RU")
            }));
        }
        return base;
      }

      function loadListeningStatsRegistry() {
        try {
          const raw = localStorage.getItem(LISTENING_STATS_KEY);
          if (!raw) {
            return {};
          }
          const parsed = JSON.parse(raw);
          return parsed && typeof parsed === "object" && !Array.isArray(parsed) ? parsed : {};
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π:", error);
          return {};
        }
      }

      function saveListeningStatsRegistry() {
        try {
          localStorage.setItem(LISTENING_STATS_KEY, JSON.stringify(listeningStatsRegistry));
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π:", error);
        }
      }

      function loadCoinHistoryRegistry() {
        try {
          const raw = localStorage.getItem(COIN_HISTORY_KEY);
          if (!raw) {
            return {};
          }
          const parsed = JSON.parse(raw);
          return parsed && typeof parsed === "object" && !Array.isArray(parsed) ? parsed : {};
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é RUZCOIN:", error);
          return {};
        }
      }

      function saveCoinHistoryRegistry() {
        try {
          localStorage.setItem(COIN_HISTORY_KEY, JSON.stringify(coinHistoryRegistry));
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é RUZCOIN:", error);
        }
      }

      function sanitizeMixEventStats(rawStats) {
        const base = createEmptyMixEventStats();
        if (!rawStats || typeof rawStats !== "object") {
          return base;
        }
        if (rawStats.events && typeof rawStats.events === "object") {
          base.events = {};
          Object.entries(rawStats.events).forEach(([eventId, entry]) => {
            if (typeof eventId !== "string") {
              return;
            }
            const total = Number(entry.totalPlays);
            const sanitized = {
              totalPlays: Number.isFinite(total) ? Math.max(0, Math.floor(total)) : 0,
              trackPlays: {},
              updatedAt: entry && entry.updatedAt ? String(entry.updatedAt) : new Date().toISOString()
            };
            if (entry && entry.trackPlays && typeof entry.trackPlays === "object") {
              Object.entries(entry.trackPlays).forEach(([slug, count]) => {
                if (typeof slug !== "string") {
                  return;
                }
                const numeric = Number(count);
                if (Number.isFinite(numeric) && numeric > 0) {
                  sanitized.trackPlays[slug] = Math.max(0, Math.floor(numeric));
                }
              });
            }
            base.events[eventId] = sanitized;
          });
        }
        return base;
      }

      function loadMixEventStatsRegistry() {
        try {
          const raw = localStorage.getItem(MIX_EVENT_STATS_KEY);
          if (!raw) {
            return {};
          }
          const parsed = JSON.parse(raw);
          return parsed && typeof parsed === "object" && !Array.isArray(parsed) ? parsed : {};
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É MIX-—Å–æ–±—ã—Ç–∏–π:", error);
          return {};
        }
      }

      function saveMixEventStatsRegistry() {
        try {
          localStorage.setItem(MIX_EVENT_STATS_KEY, JSON.stringify(mixEventStatsRegistry));
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É MIX-—Å–æ–±—ã—Ç–∏–π:", error);
        }
      }

      function sanitizeCoinHistory(rawHistory) {
        if (!Array.isArray(rawHistory)) {
          return [];
        }
        return rawHistory
          .filter(entry => entry && typeof entry === "object")
          .slice(0, MAX_HISTORY_ENTRIES)
          .map(entry => {
            const deltaValue = Number(entry.delta);
            const normalizedDelta = Number.isFinite(deltaValue) ? deltaValue : 0;
            const type = entry.type ? String(entry.type) : normalizedDelta >= 0 ? "earn" : "spend";
            const status = entry.status ? String(entry.status) : type === "request" ? "pending" : "completed";
            return {
              type,
              description: entry.description ? String(entry.description) : "–û–ø–µ—Ä–∞—Ü–∏—è —Å RUZCOIN",
              delta: normalizedDelta,
              status,
              time: entry.time ? String(entry.time) : new Date().toLocaleString("ru-RU")
            };
          });
      }

      function getActiveStatsKey() {
        return activeUserId || "guest";
      }

      function loadListeningStatsForActiveUser() {
        const key = getActiveStatsKey();
        listeningStats = sanitizeListeningStats(listeningStatsRegistry[key]);
        getPersonalPlayCount = slug => {
          if (!slug) {
            return 0;
          }
          const numeric = listeningStats.trackPlays && listeningStats.trackPlays[slug];
          const count = Number(numeric);
          return Number.isFinite(count) ? Math.max(0, Math.floor(count)) : 0;
        };
        updateTrackPersonalPlayDisplay = slug => {
          if (!slug) {
            return;
          }
          const count = getPersonalPlayCount(slug);
          document.querySelectorAll(`.track-user-plays[data-track-personal="${slug}"]`).forEach(el => {
            const span = el.querySelector("span");
            if (count > 0) {
              if (span) {
                span.textContent = formatCount(count);
              } else {
                el.textContent = `–¢–≤–æ–∏—Ö –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π: ${formatCount(count)}`;
              }
              el.hidden = false;
            } else {
              if (span) {
                span.textContent = formatCount(0);
              }
              el.hidden = true;
            }
          });
        };
        window.__avzalovListeningStats = listeningStats;
      }

      function loadCoinHistoryForActiveUser() {
        const key = getActiveStatsKey();
        coinHistory = sanitizeCoinHistory(coinHistoryRegistry[key]);
      }

      function loadMixStatsForActiveUser() {
        const key = getActiveStatsKey();
        mixEventStats = sanitizeMixEventStats(mixEventStatsRegistry[key]);
      }

      function saveListeningStats() {
        listeningStatsRegistry[getActiveStatsKey()] = sanitizeListeningStats(listeningStats);
        saveListeningStatsRegistry();
        window.__avzalovListeningStats = listeningStats;
      }

      function saveCoinHistory() {
        coinHistoryRegistry[getActiveStatsKey()] = sanitizeCoinHistory(coinHistory);
        saveCoinHistoryRegistry();
      }

      saveMixEventStatsForActiveUser = function () {
        mixEventStatsRegistry[getActiveStatsKey()] = sanitizeMixEventStats(mixEventStats);
        saveMixEventStatsRegistry();
      };

      getMixEventStatsForCurrentUser = function (eventId) {
        if (!eventId || !mixEventStats || !mixEventStats.events) {
          return null;
        }

        const entry = mixEventStats.events[eventId];
        if (!entry) {
          return null;
        }

        return {
          totalPlays: Number.isFinite(entry.totalPlays) ? entry.totalPlays : 0,
          trackPlays: entry.trackPlays && typeof entry.trackPlays === "object" ? entry.trackPlays : {},
          updatedAt: entry.updatedAt || null
        };
      };

      ensureMixEventEntry = function (eventId) {
        if (!mixEventStats.events) {
          mixEventStats.events = {};
        }
        if (!mixEventStats.events[eventId]) {
          mixEventStats.events[eventId] = {
            totalPlays: 0,
            trackPlays: {},
            updatedAt: new Date().toISOString()
          };
        }
        return mixEventStats.events[eventId];
      };

      function refreshMiniGalleryPersonalDisplays() {
        // –ú–∏–Ω–∏-–≥–∞–ª–µ—Ä–µ—è –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞–≥–ª—É—à–∫—É, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
      }

      function refreshAllTrackPersonalDisplays() {
        document
          .querySelectorAll(".track-user-plays[data-track-personal]")
          .forEach(el => updateTrackPersonalPlayDisplay(el.dataset.trackPersonal));
        refreshMiniGalleryPersonalDisplays();
    }

      function renderListeningStats() {
        if (statTotalPlaysEl) {
          statTotalPlaysEl.textContent = formatCount(listeningStats.totalPlays || 0);
        }
        const trackPlaysMap = listeningStats.trackPlays || {};
        const uniqueCount = Object.values(trackPlaysMap).filter(value => Number(value) > 0).length;
        if (statUniqueTracksEl) {
          statUniqueTracksEl.textContent = formatCount(uniqueCount);
        }
        const topEntry = Object.entries(trackPlaysMap).reduce(
          (best, [slug, count]) => {
            const numeric = Number(count);
            if (!Number.isFinite(numeric) || numeric <= best.count) {
              return best;
            }
            return { slug, count: Math.floor(numeric) };
          },
          { slug: "", count: 0 }
        );
        if (statTopTrackEl) {
          statTopTrackEl.textContent = topEntry.count > 0 ? resolveTrackTitle(topEntry.slug) : "‚Äî";
        }
        if (statTopTrackCountEl) {
          statTopTrackCountEl.textContent =
            topEntry.count > 0 ? `–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π: ${formatCount(topEntry.count)}` : "–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π: 0";
        }
        if (statsNoteEl) {
          statsNoteEl.textContent = currentUser
            ? "–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ç–≤–æ—ë–º –±—Ä–∞—É–∑–µ—Ä–µ."
            : "–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.";
        }
        if (recentListeningListEl) {
          if (!listeningStats.recent || listeningStats.recent.length === 0) {
            recentListeningListEl.innerHTML =
              '<li class="recent-plays-empty">–ù–∞—á–Ω–∏—Ç–µ —Å–ª—É—à–∞—Ç—å —Ç—Ä–µ–∫–∏, –∏ —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</li>';
          } else {
            recentListeningListEl.innerHTML = listeningStats.recent
              .map(
                entry => `
                <li class="recent-plays-item">
                  <span class="recent-track">${entry.title || resolveTrackTitle(entry.slug)}</span>
                  <span class="recent-time">${entry.time}</span>
                </li>`
              )
              .join("");
          }
        }
        refreshAllTrackPersonalDisplays();
      }

      function renderCoinHistory() {
        let earned = 0;
        let spent = 0;
        coinHistory.forEach(entry => {
          const delta = Number(entry.delta);
          if (delta > 0) {
            earned += delta;
          } else if (delta < 0) {
            spent += Math.abs(delta);
          }
        });
        if (historyEarnedEl) {
          historyEarnedEl.textContent = `${formatCount(earned)} RUZ`;
        }
        if (historySpentEl) {
          historySpentEl.textContent = `${formatCount(spent)} RUZ`;
        }
        if (historyNetEl) {
          const net = earned - spent;
          if (net === 0) {
            historyNetEl.textContent = "0 RUZ";
          } else {
            const netSign = net > 0 ? "+" : "‚àí";
            historyNetEl.textContent = `${netSign}${formatCount(Math.abs(net))} RUZ`;
          }
        }
        if (!coinHistoryListEl) {
          return;
        }
        if (!coinHistory.length) {
          coinHistoryListEl.innerHTML = `<div class="history-empty">${
            currentUser
              ? "–ò—Å—Ç–æ—Ä–∏—è –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å RUZCOIN."
              : "–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π."
          }</div>`;
          return;
        }
        coinHistoryListEl.innerHTML = coinHistory
          .map(entry => {
            const delta = Number(entry.delta) || 0;
            const absolute = Math.abs(delta);
            const isPending = entry.status === "pending" || (delta === 0 && entry.type === "request");
            const sign = delta > 0 ? "+" : delta < 0 ? "‚àí" : "";
            const deltaClass = isPending
              ? "history-entry-delta is-pending"
              : delta >= 0
                ? "history-entry-delta is-positive"
                : "history-entry-delta is-negative";
            const valueLabel = isPending ? "–û–∂–∏–¥–∞–µ—Ç" : `${sign}${formatCount(absolute)} RUZ`;
            const timeLabel = isPending ? `–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ¬∑ ${entry.time}` : entry.time;
            return `
              <div class="history-entry">
                <div class="history-entry-header">
                  <span class="history-entry-title">${entry.description}</span>
                  <span class="${deltaClass}">${valueLabel}</span>
                </div>
                <div class="history-entry-time">${timeLabel}</div>
              </div>
            `;
          })
          .join("");
      }

      function recordListeningEvent(slug, title) {
        if (!slug) {
          return;
        }
        if (!listeningStats.trackPlays[slug]) {
          listeningStats.trackPlays[slug] = 0;
        }
        listeningStats.trackPlays[slug] += 1;
        listeningStats.totalPlays = (listeningStats.totalPlays || 0) + 1;
        const entry = {
          slug,
          title: title || resolveTrackTitle(slug),
          time: new Date().toLocaleString("ru-RU")
        };
        listeningStats.recent = [entry, ...listeningStats.recent].slice(0, MAX_RECENT_LISTENS);
        recordMixEventPlay(slug);
        saveListeningStats();
        renderListeningStats();
        updateTrackPersonalPlayDisplay(slug);
      }

      function recordCoinHistory(type, delta, description) {
        const numericDelta = Number(delta);
        if (!Number.isFinite(numericDelta) || numericDelta === 0) {
          return;
        }
        const entry = {
          type: type || (numericDelta > 0 ? "earn" : "spend"),
          description: description || "–û–ø–µ—Ä–∞—Ü–∏—è —Å RUZCOIN",
          delta: numericDelta,
          time: new Date().toLocaleString("ru-RU")
        };
        coinHistory = [entry, ...coinHistory].slice(0, MAX_HISTORY_ENTRIES);
        saveCoinHistory();
        renderCoinHistory();
      }

      function appendCoinHistoryForUser(userId, delta, description) {
        if (!userId) {
          return;
        }
        const numericDelta = Number(delta);
        if (!Number.isFinite(numericDelta) || numericDelta === 0) {
          return;
        }
        const entry = {
          type: numericDelta > 0 ? "gift" : "gift",
          description: description || "–û–ø–µ—Ä–∞—Ü–∏—è —Å RUZCOIN",
          delta: numericDelta,
          time: new Date().toLocaleString("ru-RU")
        };
        const existing = sanitizeCoinHistory(coinHistoryRegistry[userId]);
        coinHistoryRegistry[userId] = [entry, ...existing].slice(0, MAX_HISTORY_ENTRIES);
        saveCoinHistoryRegistry();
      }

      function handleListeningStatIncrement(card, audio) {
        if (!card || !audio) {
          return;
        }
        const slug = card.dataset.trackSlug;
        if (!slug) {
          return;
        }
        if (audio.__countedPlay && audio.currentTime > 0.5) {
          return;
        }
        if (audio.currentTime > 1) {
          return;
        }
        audio.__countedPlay = true;
        const titleEl = card.querySelector(".track-title");
        const title = titleEl ? titleEl.textContent.trim() : resolveTrackTitle(slug);
        recordListeningEvent(slug, title);
      }

      function loadUserHistories() {
        loadListeningStatsForActiveUser();
        loadCoinHistoryForActiveUser();
        loadMixStatsForActiveUser();
        renderListeningStats();
        renderCoinHistory();
        renderMixEventsList();
        updateMixCountdown();
      }

      function switchUserContext(user) {
        activeUserId = user && user.id ? String(user.id) : "guest";
        loadUserHistories();
      }

      function generateUserId() {
        return `RUZ-${Math.random().toString(16).slice(2, 8).toUpperCase()}`;
      }

      function ensureUserShape(rawUser = {}) {
        const safeUser = { ...rawUser };
        safeUser.id = typeof safeUser.id === "string" && safeUser.id.trim()
          ? safeUser.id.trim()
          : generateUserId();
        safeUser.name = typeof safeUser.name === "string" && safeUser.name.trim()
          ? safeUser.name.trim()
          : "–ì–æ—Å—Ç—å";
        const coinsValue = Number.parseInt(safeUser.coins, 10);
        safeUser.coins = Number.isFinite(coinsValue) ? Math.max(0, coinsValue) : 0;
        safeUser.role = typeof safeUser.role === "string" && safeUser.role.trim()
          ? safeUser.role.trim().toLowerCase()
          : "listener";
        safeUser.password = typeof safeUser.password === "string" ? safeUser.password : "";
        if (!Array.isArray(safeUser.unlockedTracks)) {
          safeUser.unlockedTracks = [];
        }
        safeUser.unlockedTracks = Array.from(new Set(safeUser.unlockedTracks));
        if (!safeUser.achievements || typeof safeUser.achievements !== "object") {
          safeUser.achievements = {};
        }
        safeUser.avatar = typeof safeUser.avatar === "string" ? safeUser.avatar.trim() : "";
        return safeUser;
      }

      function sanitizeUserForRegistry(user) {
        const shaped = ensureUserShape(user);
        return {
          id: shaped.id,
          name: shaped.name,
          coins: shaped.coins,
          role: shaped.role,
          password: shaped.password,
          avatar: shaped.avatar,
          unlockedTracks: Array.from(new Set(shaped.unlockedTracks)),
          achievements: { ...shaped.achievements }
        };
      }

      function persistUsersRegistry() {
        try {
          const payload = JSON.stringify(Array.from(usersRegistry.values()));
          localStorage.setItem(USERS_REGISTRY_KEY, payload);
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:", error);
        }
      }

      function loadUsersRegistryFromStorage() {
        const raw = localStorage.getItem(USERS_REGISTRY_KEY);
        if (!raw) {
          return [];
        }
        try {
          const parsed = JSON.parse(raw);
          return Array.isArray(parsed) ? parsed : [];
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:", error);
          return [];
        }
      }

      function bootstrapRegistryFromArray(list = []) {
        usersRegistry = new Map();
        list.forEach(entry => {
          const cleaned = sanitizeUserForRegistry(entry);
          usersRegistry.set(cleaned.id, cleaned);
        });
        persistUsersRegistry();
        renderUsersDirectory();
      }

      function loadUsedAdminCodes() {
        const raw = localStorage.getItem(USED_CODES_KEY);
        if (!raw) {
          return {};
        }
        try {
          const parsed = JSON.parse(raw);
          return parsed && typeof parsed === "object" ? parsed : {};
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã:", error);
          return {};
        }
      }

      function persistUsedAdminCodes() {
        try {
          localStorage.setItem(USED_CODES_KEY, JSON.stringify(usedAdminCodes));
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã:", error);
        }
      }

      function markAdminCodeUsed(code, userId) {
        if (!code) {
          return;
        }
        usedAdminCodes[code] = userId;
        persistUsedAdminCodes();
      }

      function formatRoleLabel(role) {
        const normalized = (role || "").toLowerCase();
        if (roleLabelMap[normalized]) {
          return roleLabelMap[normalized];
        }
        if (!normalized) {
          return roleLabelMap.listener;
        }
        return normalized.charAt(0).toUpperCase() + normalized.slice(1);
      }

      function updateRuzcoinPriceDisplay() {
        if (ruzcoinPriceValueEl) {
          const formattedPrice = `${RUZCOIN_PRICE_RUB.toLocaleString("ru-RU")} ‚ÇΩ`;
          ruzcoinPriceValueEl.textContent = formattedPrice;
        }
      }

      function updateHeaderCoins(value) {
        const numericValue = Number.isFinite(Number(value)) ? Number(value) : 0;
        const formatted = numberFormatter.format(numericValue);
        if (headerCoinsAmountEl) {
          headerCoinsAmountEl.textContent = formatted;
        }
        if (popoverCoinsAmountEl) {
          popoverCoinsAmountEl.textContent = formatted;
        }
      }

      function updateHeaderProfileNameDisplay(name) {
        if (headerProfileNameEl) {
          headerProfileNameEl.textContent = name || "–í–æ–π—Ç–∏";
        }
        applyHeaderAvatar(currentUser);
      }

      function updateProfilePopoverState() {
        const isLoggedIn = Boolean(currentUser);
        if (profilePopoverLoggedOutSection) {
          profilePopoverLoggedOutSection.classList.toggle("is-visible", !isLoggedIn);
        }
        if (profilePopoverLoggedInSection) {
          profilePopoverLoggedInSection.classList.toggle("is-visible", isLoggedIn);
        }
        if (isLoggedIn) {
          applyPopoverAvatar(currentUser);
          if (popoverProfileNameEl) {
            popoverProfileNameEl.textContent = currentUser.name;
          }
          if (popoverProfileIdEl) {
            popoverProfileIdEl.textContent = currentUser.id;
          }
          if (popoverProfileRoleEl) {
            popoverProfileRoleEl.textContent = formatRoleLabel(currentUser.role);
          }
        } else {
          if (popoverProfileNameEl) {
            popoverProfileNameEl.textContent = "–ì–æ—Å—Ç—å";
          }
          if (popoverProfileIdEl) {
            popoverProfileIdEl.textContent = "‚Äî";
          }
          if (popoverProfileRoleEl) {
            popoverProfileRoleEl.textContent = formatRoleLabel("listener");
          }
          if (adminLoginToggle) {
            adminLoginToggle.open = false;
          }
          applyPopoverAvatar(null);
        }
      }

      function closeAllPopovers(exceptController) {
        popoverControllers.forEach(controller => {
          if (controller !== exceptController) {
            controller.close();
          }
        });
      }

      function attachPopover(button, popover) {
        if (!button || !popover) {
          return null;
        }
        popover.dataset.open = "false";
        popover.setAttribute("aria-hidden", "true");
        popover.hidden = true;
        const controller = {
          button,
          popover,
          isOpen() {
            return popover.dataset.open === "true";
          },
          open() {
            closeAllPopovers(controller);
            popover.dataset.open = "true";
            popover.setAttribute("aria-hidden", "false");
            popover.hidden = false;
            button.setAttribute("aria-expanded", "true");
          },
          close() {
            popover.dataset.open = "false";
            popover.setAttribute("aria-hidden", "true");
            popover.hidden = true;
            button.setAttribute("aria-expanded", "false");
          },
          toggle() {
            if (this.isOpen()) {
              this.close();
            } else {
              this.open();
            }
          }
        };
        button.addEventListener("click", event => {
          event.preventDefault();
          controller.toggle();
        });
        popoverControllers.push(controller);
        return controller;
      }

      document.addEventListener("click", event => {
        const target = event.target;
        const shouldIgnore = popoverControllers.some(controller => {
          return controller.button.contains(target) || controller.popover.contains(target);
        });
        if (!shouldIgnore) {
          closeAllPopovers();
        }
      });

      document.addEventListener("keydown", event => {
        if (event.key === "Escape") {
          closeAllPopovers();
        }
      });

      function renderAchievements() {
        if (!achievementsGridEl) {
          return;
        }
        achievementsGridEl.innerHTML = "";
        const userAchievements = currentUser ? currentUser.achievements : {};
        baseAchievements.forEach(ach => {
          const card = document.createElement("div");
          card.className = "achievement-card";
          const isUnlocked = Boolean(userAchievements[ach.id]);
          if (isUnlocked) {
            card.classList.add("unlocked");
          }
          card.innerHTML = `
            <div class="achievement-title">${ach.title}</div>
            <div class="achievement-desc">${ach.desc}</div>
            ${isUnlocked ? '<div class="achievement-badge">‚úì</div>' : ""}
          `;
          achievementsGridEl.appendChild(card);
        });
      }

      function getListeningSnapshotForUser(userId) {
        const stats = sanitizeListeningStats(listeningStatsRegistry[userId]);
        const totalPlays = stats.totalPlays || 0;
        const uniqueTracks = Object.values(stats.trackPlays || {}).filter(value => Number(value) > 0).length;
        return {
          totalPlays,
          uniqueTracks
        };
      }

      function getAchievementCount(user) {
        if (!user || !user.achievements) {
          return 0;
        }
        return Object.keys(user.achievements).length;
      }

      function formatAvatarLabel(name) {
        if (!name) {
          return "RU";
        }
        const parts = name.trim().split(/\s+/);
        if (parts.length === 1) {
          return parts[0].slice(0, 2).toUpperCase();
        }
        return (parts[0][0] + parts[1][0]).toUpperCase();
      }

      function resolveAvatarSource(user) {
        if (!user) {
          return "";
        }
        const rawValue = typeof user === "string" ? user : user.avatar;
        if (typeof rawValue !== "string") {
          return "";
        }
        const trimmed = rawValue.trim();
        if (!trimmed) {
          return "";
        }
        if (trimmed.startsWith("data:") || trimmed.startsWith("blob:")) {
          return trimmed;
        }
        if (/^https?:\/\//i.test(trimmed) || trimmed.startsWith("img/") || trimmed.startsWith("/")) {
          return trimmed;
        }
        return `img/${trimmed}`;
      }

      function setAvatarBackground(element, cssVariable, source) {
        if (!element) {
          return;
        }
        if (source) {
          element.style.setProperty(cssVariable, `url('${source.replace(/'/g, "\\'")}')`);
          element.classList.add("has-image");
        } else {
          element.style.removeProperty(cssVariable);
          element.classList.remove("has-image");
        }
      }

      function applyProfileAvatar(user) {
        if (!profileAvatarEl) {
          return;
        }
        const initials = formatAvatarLabel(user ? user.name : "");
        if (profileAvatarInitialsEl) {
          profileAvatarInitialsEl.textContent = initials;
        }
        const source = resolveAvatarSource(user);
        setAvatarBackground(profileAvatarEl, "--profile-avatar-image", source);
        if (user && user.name) {
          profileAvatarEl.setAttribute("aria-label", `–ê–≤–∞—Ç–∞—Ä ${user.name}`);
        } else {
          profileAvatarEl.setAttribute("aria-label", "–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");
        }
      }

      function applyHeaderAvatar(user) {
        if (!headerProfileAvatarEl) {
          return;
        }
        headerProfileAvatarEl.textContent = formatAvatarLabel(user ? user.name : "");
        setAvatarBackground(headerProfileAvatarEl, "--header-avatar-image", resolveAvatarSource(user));
      }

      function applyHeaderUsersAvatar(user) {
        const headerUsersAvatarEl = document.getElementById("headerUsersAvatar");
        if (!headerUsersAvatarEl) {
          return;
        }
        const source = resolveAvatarSource(user);
        if (user && source) {
          headerUsersAvatarEl.innerHTML = '';
          setAvatarBackground(headerUsersAvatarEl, "--header-avatar-image", source);
        } else {
          headerUsersAvatarEl.innerHTML = '<i class="fas fa-users"></i>';
          setAvatarBackground(headerUsersAvatarEl, "--header-avatar-image", "");
        }
      }

      function applyPopoverAvatar(user) {
        if (!popoverAvatarEl) {
          return;
        }
        popoverAvatarEl.textContent = formatAvatarLabel(user ? user.name : "");
        setAvatarBackground(popoverAvatarEl, "--popover-avatar-image", resolveAvatarSource(user));
      }

      function applyUserCardAvatar(avatarEl, user) {
        if (!avatarEl) {
          return;
        }
        avatarEl.textContent = formatAvatarLabel(user ? user.name : "");
        setAvatarBackground(avatarEl, "--user-avatar-image", resolveAvatarSource(user));
      }

      function updateUsersPopoverList(usersSummary = []) {
        if (!headerUsersListEl) {
          return;
        }
        headerUsersListEl.innerHTML = "";
        if (!usersSummary.length) {
          headerUsersListEl.innerHTML = '<p class="users-popover-empty">–°–ø–∏—Å–æ–∫ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ—Ñ–∏–ª—å.</p>';
          return;
        }
        const topUsers = usersSummary.slice(0, 10);
        topUsers.forEach((entry, index) => {
          const item = document.createElement("div");
          item.className = "users-popover-item";
          item.innerHTML = `
            <span class="users-popover-item-rank">${index + 1}</span>
            <div class="users-popover-meta">
              <span class="users-popover-name">${entry.name}</span>
              <div class="users-popover-stats">
                <span>${numberFormatter.format(entry.coins)} RUZ</span>
                <span>${numberFormatter.format(entry.totalPlays)} –ø—Ä–æ—Å–ª.</span>
              </div>
            </div>
            <span class="users-popover-role">${entry.roleLabel}</span>
          `;
          headerUsersListEl.appendChild(item);
        });
      }

      function renderUsersDirectory() {
        if (!usersDirectoryEl) {
          return;
        }
        const usersList = Array.from(usersRegistry.values());
        if (currentUser && !usersRegistry.has(currentUser.id)) {
          usersList.push(sanitizeUserForRegistry(currentUser));
        }
        if (!usersList.length) {
          usersDirectoryEl.innerHTML = '<p class="users-empty">–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫.</p>';
          updateUsersPopoverList();
          return;
        }
        const enriched = usersList.map(user => {
          const stats = getListeningSnapshotForUser(user.id);
          return {
            id: user.id,
            name: user.name,
            coins: Number(user.coins) || 0,
            roleLabel: formatRoleLabel(user.role),
            totalPlays: stats.totalPlays,
            uniqueTracks: stats.uniqueTracks,
            achievements: getAchievementCount(user),
            avatar: user.avatar
          };
        });
        enriched.sort((a, b) => {
          if (b.coins !== a.coins) {
            return b.coins - a.coins;
          }
          if (b.totalPlays !== a.totalPlays) {
            return b.totalPlays - a.totalPlays;
          }
          return a.name.localeCompare(b.name, "ru", { sensitivity: "base" });
        });
        const fragment = document.createDocumentFragment();
        enriched.forEach((entry, index) => {
          const card = document.createElement("div");
          card.className = "user-card";
          card.innerHTML = `
            <div class="user-card-header">
              <div class="user-avatar">${formatAvatarLabel(entry.name)}</div>
              <div class="user-meta">
                <div class="user-name">${entry.name}</div>
                <div class="user-id">ID: ${entry.id}</div>
              </div>
            </div>
            <div class="user-stats">
              <span class="user-stat-badge"><i class="fas fa-coins"></i>${numberFormatter.format(entry.coins)} RUZ</span>
              <span class="user-stat-badge"><i class="fas fa-chart-line"></i>${numberFormatter.format(entry.totalPlays)} –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π</span>
              <span class="user-stat-badge"><i class="fas fa-music"></i>${numberFormatter.format(entry.uniqueTracks)} —Ç—Ä–µ–∫–æ–≤</span>
              <span class="user-stat-badge"><i class="fas fa-medal"></i>${entry.achievements} –¥–æ—Å—Ç–∏–∂.</span>
              <span class="user-stat-badge"><i class="fas fa-user-shield"></i>${entry.roleLabel}</span>
            </div>
          `;
          card.dataset.rank = index + 1;
          const avatarEl = card.querySelector(".user-avatar");
          applyUserCardAvatar(avatarEl, entry);
          fragment.appendChild(card);
        });
        usersDirectoryEl.innerHTML = "";
        usersDirectoryEl.appendChild(fragment);
        updateUsersPopoverList(enriched);
      }

      function grantAchievement(achievementId) {
        if (!currentUser || !achievementId) {
          return;
        }
        const achievement = baseAchievements.find(a => a.id === achievementId);
        if (!achievement || currentUser.achievements[achievementId]) {
          return;
        }
        currentUser.achievements[achievementId] = new Date().toISOString();
        if (achievement.coins > 0) {
          currentUser.coins += achievement.coins;
        }
        persistCurrentUser();
        renderAchievements();
        updateProfileDisplay();
      }

      function updateProfileDisplay() {
        const isLoggedIn = Boolean(currentUser);
        if (profilePanelEl) {
          profilePanelEl.hidden = !isLoggedIn;
        }
        if (profileEmptyEl) {
          profileEmptyEl.hidden = isLoggedIn;
        }
        if (!isLoggedIn) {
          setActiveProfileView("overview");
          if (achievementsGridEl) {
            achievementsGridEl.innerHTML = "";
          }
        }
        applyProfileAvatar(isLoggedIn ? currentUser : null);
        applyHeaderUsersAvatar(isLoggedIn ? currentUser : null);
        if (isLoggedIn) {
          if (profileNameEl) {
            profileNameEl.textContent = currentUser.name;
          }
          if (profileIdEl) {
            profileIdEl.textContent = currentUser.id;
          }
          if (profileRoleEl) {
            profileRoleEl.textContent = formatRoleLabel(currentUser.role);
          }
          if (coinsAmountEl) {
            coinsAmountEl.textContent = numberFormatter.format(currentUser.coins);
          }
          renderAchievements();
        }
        if (adminToolsEl) {
          const canGift = isLoggedIn && ["admin", "moderator"].includes((currentUser.role || "").toLowerCase());
          adminToolsEl.classList.toggle("is-visible", canGift);
          if (!canGift && adminGiftStatusEl) {
            adminGiftStatusEl.textContent = "";
          }
        }
        updateHeaderCoins(isLoggedIn ? currentUser.coins : 0);
        updateHeaderProfileNameDisplay(isLoggedIn ? currentUser.name : "–í–æ–π—Ç–∏");
        updateProfilePopoverState();
        updateTrackCardsForUser();
      }

      function persistCurrentUser() {
        if (!currentUser) {
          localStorage.removeItem(STORAGE_KEY);
          return;
        }
        try {
          const userToSave = sanitizeUserForRegistry(currentUser);
          localStorage.setItem(STORAGE_KEY, JSON.stringify(userToSave));
          usersRegistry.set(userToSave.id, userToSave);
          persistUsersRegistry();
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å:", error);
        }
      }

      function saveProfile() {
        persistCurrentUser();
        updateProfileDisplay();
        renderUsersDirectory();
      }

      function loadCurrentUser() {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) {
          return null;
        }
        try {
          const parsed = JSON.parse(raw);
          return ensureUserShape(parsed);
        } catch (error) {
          console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å:", error);
          return null;
        }
      }

      function logout(event) {
        if (event && typeof event.preventDefault === "function") {
          event.preventDefault();
        }
        currentUser = null;
        switchUserContext(null);
        saveProfile();
        setActiveTopupMethod("");
        closeAllPopovers();
        if (loginForm) {
          loginForm.reset();
        }
        if (adminCodeForm) {
          adminCodeForm.reset();
        }
        if (adminLoginToggle) {
          adminLoginToggle.open = true;
        }
        alert("–í—ã –≤—ã—à–ª–∏ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è. –î–æ –≤—Å—Ç—Ä–µ—á–∏!");
      }

      async function fetchJson(url) {
        try {
          const response = await fetch(url);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return await response.json();
        } catch (error) {
          console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ${url}:`, error);
          return null;
        }
      }

      async function initializeData() {
        const [usersData, adminCodesData] = await Promise.all([
          fetchJson(USERS_DATA_ENDPOINT),
          fetchJson(ADMIN_CODES_ENDPOINT)
        ]);

        const storedUsers = loadUsersRegistryFromStorage();
        const usersArray = Array.isArray(usersData)
          ? usersData
          : usersData && Array.isArray(usersData.users)
            ? usersData.users
            : [];
        const combinedUsers = [...usersArray, ...storedUsers];
        bootstrapRegistryFromArray(combinedUsers);

        const adminCodesArray = Array.isArray(adminCodesData)
          ? adminCodesData
          : adminCodesData && Array.isArray(adminCodesData.codes)
            ? adminCodesData.codes
            : [];
        if (adminCodesArray.length) {
          adminCodes = new Map(adminCodesArray.map(c => [c.code, c]));
        }
        usedAdminCodes = loadUsedAdminCodes();
      }

      function handleQuickLogin(methodKey) {
        const normalized = (methodKey || "").toLowerCase();
        if (normalized === "demo") {
          let demoUser = null;
          for (const user of usersRegistry.values()) {
            if (user && typeof user.name === "string" && user.name.toLowerCase() === "demo listener") {
              demoUser = user;
              break;
            }
          }
          if (!demoUser) {
            demoUser = {
              id: "RUZ-DEMO01",
              name: "Demo Listener",
              coins: 25,
              role: "listener",
              password: "demo",
              achievements: { welcome: true },
              unlockedTracks: []
            };
          }
          currentUser = ensureUserShape(demoUser);
          switchUserContext(currentUser);
          saveProfile();
          if (profilePopoverController) {
            profilePopoverController.close();
          }
          setActiveProfileView("overview");
          alert("–¢—ã –≤–æ—à—ë–ª –≤ –¥–µ–º–æ-–ø—Ä–æ—Ñ–∏–ª—å Demo Listener. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–µ–∑ —Ä–∏—Å–∫–∞.");
          return;
        }
        if (normalized === "guest") {
          if (profilePopoverController) {
            profilePopoverController.close();
          }
          const profileSection = document.getElementById("profile");
          if (profileSection) {
            profileSection.scrollIntoView({ behavior: "smooth" });
          }
          setActiveProfileView("overview");
          alert("–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω. –í–æ–π–¥–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–π –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.");
        }
      }

      function handleAvatarSelection(file) {
        if (!currentUser) {
          if (profilePopoverController) {
            profilePopoverController.open();
          }
          alert("–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –º–µ–Ω—è—Ç—å –∞–≤–∞—Ç–∞—Ä.");
          return;
        }
        if (!file) {
          return;
        }
        if (!file.type || !file.type.startsWith("image/")) {
          alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (PNG, JPG, WebP).");
          return;
        }
        const maxSize = 1024 * 1024 * 2;
        if (file.size > maxSize) {
          alert("–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –î–æ–ø—É—Å—Ç–∏–º–æ –¥–æ 2 –ú–ë.");
          return;
        }
        const reader = new FileReader();
        reader.onload = event => {
          const result = event.target && typeof event.target.result === "string" ? event.target.result : "";
          if (!result) {
            alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.");
            return;
          }
          currentUser.avatar = result;
          saveProfile();
          updateProfilePopoverState();
          alert("–ê–≤–∞—Ç–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω!");
        };
        reader.onerror = () => {
          alert("–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.");
        };
        reader.readAsDataURL(file);
      }

      function handleLogin(event) {
        event.preventDefault();
        const name = (event.target.elements.loginName.value || "").trim();
        const password = (event.target.elements.loginPassword.value || "").trim();
        if (!name || !password) {
          alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ –ø–∞—Ä–æ–ª—å.");
          return;
        }
        let foundUser = null;
        for (const user of usersRegistry.values()) {
          if (user.name.toLowerCase() === name.toLowerCase() && user.password === password) {
            foundUser = user;
            break;
          }
        }
        if (foundUser) {
          currentUser = ensureUserShape(foundUser);
        } else {
          currentUser = ensureUserShape({
            id: generateUserId(),
            name,
            coins: WELCOME_BONUS,
            role: "listener",
            password,
            achievements: { welcome: true },
            unlockedTracks: []
          });
          recordCoinHistory("bonus", WELCOME_BONUS, "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å");
        }
        switchUserContext(currentUser);
        saveProfile();
        if (loginForm) {
          loginForm.reset();
        }
        if (profilePopoverController) {
          profilePopoverController.close();
        }
        renderUsersDirectory();
        alert(`–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, ${currentUser.name}! –ü—Ä–æ—Ñ–∏–ª—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω.`);
      }

      function handleAdminLogin(event) {
        event.preventDefault();
        const code = (adminCodeInput.value || "").trim().toUpperCase();
        const name = (adminNameInput.value || "").trim();
        if (!code) {
          alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.");
          return;
        }
        if (usedAdminCodes[code]) {
          alert("–≠—Ç–æ—Ç –∫–æ–¥ —É–∂–µ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.");
          return;
        }
        const adminInfo = adminCodes.get(code);
        if (!adminInfo) {
          alert("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.");
          return;
        }
        const role = (adminInfo.role || "admin").toLowerCase();
        const displayName = name || adminInfo.label || adminInfo.name || "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä";
        const startingCoins = Number.isFinite(adminInfo.coins) ? Math.max(adminInfo.coins, WELCOME_BONUS) : WELCOME_BONUS;
        currentUser = ensureUserShape({
          id: generateUserId(),
          name: displayName,
          role,
          coins: startingCoins,
          password: code,
          achievements: { welcome: true },
          unlockedTracks: []
        });
        switchUserContext(currentUser);
        recordCoinHistory("bonus", WELCOME_BONUS, "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –∫–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞");
        markAdminCodeUsed(code, currentUser.id);
        saveProfile();
        if (adminCodeForm) {
          adminCodeForm.reset();
        }
        if (profilePopoverController) {
          profilePopoverController.close();
        }
        renderUsersDirectory();
      }

      function updateTrackCardsForUser() {
        const unlocked = currentUser ? new Set(currentUser.unlockedTracks) : new Set();
        document.querySelectorAll(".track-card[data-track-locked]").forEach(card => {
          const slug = card.dataset.trackLocked;
          if (unlocked.has(slug)) {
            card.classList.remove("track-locked");
            const trackData = trackLibrary.find(t => t.slug === slug);
            if (trackData) {
              const newCard = createTrackCard({ ...trackData, hasAudio: true });
              card.replaceWith(newCard);
              rebindTrackCardEvents();
            }
          }
        });
      }

    function renderAllTrackGrids(library) {
      renderTracksGrid(library);
      renderClipsGrid(library);
    }

      function handleUnlockButtonClick(event) {
        const unlockBtn = event.target.closest(".unlock-btn");
        if (!unlockBtn) {
          return;
        }
        event.preventDefault();
        if (!currentUser) {
          alert("–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Ç—Ä–µ–∫–∏.");
          if (profilePopoverController) {
            profilePopoverController.open();
          }
          return;
        }
        const trackId = unlockBtn.dataset.trackId;
        const price = Number(unlockBtn.dataset.unlockPrice || 0);
        if (!trackId || !(price > 0)) {
          return;
        }
        if (currentUser.unlockedTracks.includes(trackId)) {
          alert("–≠—Ç–æ—Ç —Ç—Ä–µ–∫ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç.");
          return;
        }
        if (currentUser.coins < price) {
          alert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç RUZCOIN. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å.");
          if (coinsPopoverController) {
            coinsPopoverController.open();
          }
          setTopupPanelVisibility(true);
          return;
        }
        currentUser.coins -= price;
        currentUser.unlockedTracks.push(trackId);
        const unlockedTitle = resolveTrackTitle(trackId);
        recordCoinHistory("spend", -price, `–û—Ç–∫—Ä—ã—Ç —Ç—Ä–µ–∫ ¬´${unlockedTitle}¬ª`);
        if (!currentUser.achievements.first_unlock) {
          currentUser.achievements.first_unlock = true;
        }
        if (currentUser.unlockedTracks.length >= 3) {
          currentUser.achievements.collector = true;
        }
        saveProfile();
        alert("–¢—Ä–µ–∫ –æ—Ç–∫—Ä—ã—Ç! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É AVZAL√òV.");
      }

      if (loginForm) {
        loginForm.addEventListener("submit", handleLogin);
      }
      if (adminCodeForm) {
        adminCodeForm.addEventListener("submit", handleAdminLogin);
      }
      logoutButtons.forEach(btn => btn.addEventListener("click", logout));

      if (earnDemoBtn) {
        earnDemoBtn.addEventListener("click", () => {
          if (!currentUser) {
            if (profilePopoverController) {
              profilePopoverController.open();
            } else {
              alert("–í–æ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ–º–æ RUZCOIN.");
            }
            return;
          }
          const demoBonusKey = `${DEMO_BONUS_KEY}_${currentUser.id}`;
          if (localStorage.getItem(demoBonusKey) === "true") {
            alert("–î–µ–º–æ-–±–æ–Ω—É—Å —É–∂–µ –±—ã–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω.");
            return;
          }
          const demoBonusAmount = 1;
          currentUser.coins += demoBonusAmount;
          persistCurrentUser();
          updateProfileDisplay();
          recordCoinHistory("bonus", demoBonusAmount, `–î–µ–º–æ –±–æ–Ω—É—Å: +${demoBonusAmount} RUZCOIN`);
          localStorage.setItem(demoBonusKey, "true");
        });
      }

      if (openProfileSectionBtn) {
        openProfileSectionBtn.addEventListener("click", () => {
          const profileSection = document.getElementById("profile");
          if (profileSection) {
            profileSection.scrollIntoView({ behavior: "smooth" });
          }
        });
      }

      if (openUsersSectionBtn) {
        openUsersSectionBtn.addEventListener("click", event => {
          event.preventDefault();
          closeAllPopovers();
          if (usersSection) {
            usersSection.scrollIntoView({ behavior: "smooth" });
          }
        });
      }

      if (headerSectionShortcuts.length) {
        headerSectionShortcuts.forEach(link => {
          link.addEventListener("click", event => {
            const targetSectionId = link.dataset.openSection;
            if (!targetSectionId) {
              return;
            }
            event.preventDefault();
            openSectionById(targetSectionId);
          });
        });
      }

      if (profileTopupBtn) {
        profileTopupBtn.addEventListener("click", event => {
          event.preventDefault();
          closeAllPopovers();
          openPaymentsSection({ focusTopup: true });
        });
      }

      if (coinsInfoBtn) {
        coinsInfoBtn.addEventListener("click", event => {
          event.preventDefault();
          closeAllPopovers();
          openPaymentsSection({ focusTopup: true });
        });
      }

      if (openPaymentsFromPopoverBtn) {
        openPaymentsFromPopoverBtn.addEventListener("click", event => {
          event.preventDefault();
          closeAllPopovers();
          openPaymentsSection({ focusTopup: true });
        });
      }

      if (adminGiftForm) {
        adminGiftForm.addEventListener("submit", event => {
          event.preventDefault();
          if (!currentUser || !["admin", "moderator"].includes((currentUser.role || "").toLowerCase())) {
            if (adminGiftStatusEl) {
              adminGiftStatusEl.textContent = "–î–∞—Ä–∏—Ç—å RUZCOIN –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã.";
            }
            return;
          }
          const targetId = giftUserIdInput ? giftUserIdInput.value.trim() : "";
          const amountValue = giftAmountInput ? Number.parseInt(giftAmountInput.value, 10) : NaN;
          if (!targetId || !Number.isFinite(amountValue) || amountValue <= 0) {
            if (adminGiftStatusEl) {
              adminGiftStatusEl.textContent = "–£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ID –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç.";
            }
            return;
          }
          const normalizedId = targetId.trim().toUpperCase();
          let targetUser = usersRegistry.get(normalizedId);
          const giftingToSelf = currentUser.id.toUpperCase() === normalizedId;
          if (!targetUser && giftingToSelf) {
            targetUser = sanitizeUserForRegistry(currentUser);
          }
          if (!targetUser) {
            if (adminGiftStatusEl) {
              adminGiftStatusEl.textContent = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID ${normalizedId} –Ω–µ –Ω–∞–π–¥–µ–Ω.`;
            }
            return;
          }
          const updatedCoins = (Number(targetUser.coins) || 0) + amountValue;
          targetUser.coins = updatedCoins;
          usersRegistry.set(targetUser.id, sanitizeUserForRegistry(targetUser));
          persistUsersRegistry();
          appendCoinHistoryForUser(targetUser.id, amountValue, `–ü–æ–¥–∞—Ä–æ–∫ –æ—Ç ${currentUser.name}`);
          if (giftingToSelf) {
            currentUser.coins = updatedCoins;
            saveProfile();
          } else {
            renderUsersDirectory();
          }
          if (adminGiftStatusEl) {
            adminGiftStatusEl.textContent = `+${numberFormatter.format(amountValue)} RUZ –Ω–∞—á–∏—Å–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${targetUser.name}.`;
          }
          adminGiftForm.reset();
        });
      }

      await initializeData();

      const storedUser = loadCurrentUser();
      if (storedUser) {
        currentUser = ensureUserShape(storedUser);
        usersRegistry.set(currentUser.id, sanitizeUserForRegistry(currentUser));
        persistUsersRegistry();
        switchUserContext(currentUser);
      } else {
        currentUser = null;
        switchUserContext(null);
      }
      updateProfileDisplay();
      renderUsersDirectory();
      initializeMixEventsSchedule();

      coinsPopoverController = attachPopover(headerCoinsBtn, headerCoinsPopover);
      profilePopoverController = attachPopover(headerProfileBtn, headerProfilePopover);
      usersPopoverController = attachPopover(headerUsersBtn, headerUsersPopover);
      mixPopoverController = attachPopover(mixEventsBtn, mixEventsPopover);

      [tracksGrid, clipsGrid].forEach(grid => {
        if (grid) {
          grid.addEventListener("click", handleUnlockButtonClick);
        }
      });
    })();
  </script>
</body>
</html>