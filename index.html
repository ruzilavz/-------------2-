:root{
    --bg: #0f1115;
    --card: #0b0d10;
    --muted: #98a0aa;
    --accent: #6ee7b7;
    --glass: rgba(255,255,255,0.03);
    --chip-bg: rgba(255,255,255,0.04);
    --radius: 12px;
    --text: #e6eef6;
    --small: 12px;
  }

  body{
    background: linear-gradient(180deg,#071018 0%, #0b0f16 100%);
    color:var(--text);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    padding:24px;
  }

  .tracks-section{
    max-width:1100px;
    margin:0 auto;
  }

  .tracks-grid{
    display:grid;
    grid-template-columns: repeat(auto-fill,minmax(320px,1fr));
    gap:16px;
  }

  .track-card{
    display:flex;
    align-items:center;
    gap:14px;
    padding:12px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:var(--radius);
    box-shadow: 0 6px 18px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.02);
    transition:transform .18s ease, box-shadow .18s ease;
    cursor:pointer;
    position:relative;
  }

  .track-card:hover{ transform: translateY(-6px); box-shadow: 0 14px 30px rgba(2,6,23,0.6); }

  .cover{
    width:84px;
    height:84px;
    border-radius:8px;
    object-fit:cover;
    flex:0 0 84px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.5);
    background: linear-gradient(135deg,#111315,#0d1014);
  }

  .meta{
    flex:1 1 auto;
    min-width:0;
  }

  .label{ font-size:12px; color:var(--accent); margin:0 0 6px 0; font-weight:600; }
  .title{ margin:0 0 6px 0; font-size:16px; line-height:1.1; }
  .muted{ margin:0; color:var(--muted); font-size:13px; }

  .player-insight{
    margin-top:8px;
    display:flex;
    gap:8px;
    flex-wrap:wrap;
  }

  .chip{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:6px 8px;
    border-radius:999px;
    background:var(--chip-bg);
    color:var(--muted);
    font-size:12px;
  }

  /* Right column: controls + price */
  .actions{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
    flex:0 0 96px;
  }

  .controls{
    display:flex;
    gap:8px;
    align-items:center;
  }

  .icon-btn{
    width:36px;
    height:36px;
    border-radius:8px;
    background:transparent;
    border:0;
    display:inline-grid;
    place-items:center;
    color:var(--text);
    cursor:pointer;
    transition:all .15s ease;
  }

  .icon-btn.ghost{ background:var(--glass); }
  .icon-btn.primary{
    background: linear-gradient(90deg,#00c1a1,#4de1b0);
    color:#052018;
    box-shadow: 0 6px 14px rgba(3, 140, 110, 0.18);
  }

  .icon-btn:hover{ transform: translateY(-3px); }

  /* Price block */
  .price{
    display:flex;
    align-items:center;
    gap:8px;
    background:rgba(255,255,255,0.02);
    padding:6px 8px;
    border-radius:999px;
    font-size:12px;
    color:var(--muted);
  }

  .price .amount{
    font-weight:700;
    color:var(--text);
    font-size:14px;
  }

  .price svg{
    width:22px;
    height:22px;
    display:block;
    transform-origin:center;
    transition:transform .3s ease;
  }

  /* Animate SVG when active */
  .track-card.is-playing .price svg{ animation: coin-spin 0.9s linear infinite; }
  .track-card:hover .price svg{ transform: translateY(-2px) scale(1.05); }

  @keyframes coin-spin{
    from{ transform: rotateY(0deg); }
    to{ transform: rotateY(360deg); }
  }

  /* small helper */
  .sr-only{
    position:absolute!important; width:1px!important; height:1px!important; padding:0!important; margin:-1px!important; overflow:hidden!important; clip:rect(0,0,0,0)!important; white-space:nowrap!important; border:0!important;
  }

  /* Track list for mobile: make each card clickable; active state */
  .track-card.is-active{
    outline:2px solid rgba(110,231,183,0.12);
    box-shadow: 0 18px 40px rgba(2,6,23,0.75);
  }

  /* tiny meta row icons (svg color) */
  .meta svg{ width:14px; height:14px; color:var(--muted); vertical-align:middle; }
  .meta .chip svg{ width:12px; height:12px; color:var(--muted); }

  /* progress inside card (optional) */
  .progress-wrap{ width:100%; margin-top:10px; height:6px; background:rgba(255,255,255,0.03); border-radius:999px; overflow:hidden; }
  .progress-bar{ width:0%; height:100%; background: linear-gradient(90deg,#00d1a8,#4de1b0); transition:width .1s linear; }

  /* Responsive */
  @media (max-width:520px){
    .track-card{ flex-direction:row; gap:12px; padding:10px; }
    .actions{ flex:0 0 86px; }
    .cover{ width:64px; height:64px; flex:0 0 64px; }
  }

</style>

<section class="tracks-section" aria-label="Список треков">
  <h2 style="margin:0 0 14px 0; font-weight:600;">Треки</h2>

  <div class="tracks-grid" id="tracksGrid">
    <!-- Пример карточки; дублируйте/генерируйте для других треков -->
    <article class="track-card is-active" data-src="Davyl.mp3" data-price="49">
      <img class="cover" src="img/Davyl.jpg" alt="Обложка — Давыл">
      <div class="meta">
        <p class="label">Сейчас играет</p>
        <h3 class="title">Давыл</h3>
        <p class="muted">Скоро релиз · ru / tt · © 2025 AVZALØV</p>

        <div class="player-insight" aria-hidden="true">
          <span class="chip"><svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2a2 2 0 0 1 2 2v4h4a2 2 0 0 1 0 4h-4v4a2 2 0 0 1-4 0v-4H6a2 2 0 0 1 0-4h4V4a2 2 0 0 1 2-2z"/></svg> Ранний доступ</span>
          <span class="chip"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zM7 9h10v2H7V9z"/></svg> ru / tt</span>
          <span class="chip"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 5c-4.97 0-9 3.58-9 8s4.03 8 9 8 9-3.58 9-8-4.03-8-9-8z"/></svg> 898 прослушиваний</span>
        </div>

        <div class="progress-wrap" aria-hidden="true">
          <div class="progress-bar" style="width:12%"></div>
        </div>
      </div>

      <div class="actions" role="group" aria-label="Управление треком">
        <div class="controls" aria-hidden="true">
          <button class="icon-btn ghost prev-btn" title="Предыдущий">
            <!-- prev icon -->
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 12L17 5v14L7 12Z"/><path d="M5 5h2v14H5z"/></svg>
          </button>

          <button class="icon-btn primary play-btn" title="Пуск / Пауза" aria-pressed="true">
            <!-- play + pause toggles via JS -->
            <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M8 5.14 19 12 8 18.86V5.14Z"/></svg>
            <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="display:none"><path d="M7 5h4v14H7z"/><path d="M13 5h4v14h-4z"/></svg>
            <span class="sr-only">Пуск</span>
          </button>

          <button class="icon-btn ghost next-btn" title="Следующий">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M5 19V5l10 7-10 7Zm12-14h2v14h-2z"/></svg>
          </button>
        </div>

        <!-- price with animated SVG coin -->
        <div class="price" aria-label="Цена трека">
          <svg class="coin" viewBox="0 0 24 24" aria-hidden="true">
            <defs>
              <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
                <stop offset="0%" stop-color="#ffd166"/>
                <stop offset="100%" stop-color="#fca311"/>
              </linearGradient>
            </defs>
            <!-- stylized coin -->
            <circle cx="12" cy="12" r="9" fill="url(#g1)"></circle>
            <path d="M9.5 11.2c0-.8.9-1.1 2.5-1.6 1.6-.4 2.1-.7 2.1-1.5 0-1-.9-1.5-2.3-1.5-1 0-2.1.2-2.9.6l-.5-1.3c.9-.4 2-.7 3.6-.7 2.5 0 3.7 1 3.7 2.8 0 1.6-1.1 2-2.8 2.4-1.5.4-2.1.7-2.1 1.6 0 .9 1 1.6 2.6 1.6c1 0 2-.2 2.6-.6l.4 1.3c-.8.4-1.9.7-3.6.7-2.5 0-3.9-1-3.9-2.9 0-1.6 1.1-2.1 2.9-2.5 1.6-.4 2.1-.7 2.1-1.6 0-.7-.7-1.1-1.9-1.1-1 0-1.9.2-2.5.4l-.4-1.2z" fill="#8a5c00" opacity="0.9"></path>
          </svg>

          <div>
            <small style="display:block; font-size:11px; color:var(--muted);">Цена</small>
            <div class="amount">49</div>
          </div>
        </div>
      </div>
    </article>

    <!-- Еще одна карточка для примера -->
    <article class="track-card" data-src="Psychopat.mp3" data-price="59">
      <img class="cover" src="img/Davyl.jpg" alt="Обложка — Психопат">
      <div class="meta">
        <p class="label" style="color:#ffc371">Скоро релиз</p>
        <h3 class="title">Психопат</h3>
        <p class="muted">Скоро релиз · ru · © 2025</p>

        <div class="player-insight" aria-hidden="true">
          <span class="chip"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z"/></svg> 12K</span>
          <span class="chip"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 9h10v2H7z"/></svg> ru</span>
        </div>

        <div class="progress-wrap" aria-hidden="true">
          <div class="progress-bar" style="width:0%"></div>
        </div>
      </div>

      <div class="actions" role="group" aria-label="Управление треком">
        <div class="controls" aria-hidden="true">
          <button class="icon-btn ghost prev-btn" title="Предыдущий">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 12L17 5v14L7 12Z"/><path d="M5 5h2v14H5z"/></svg>
          </button>

          <button class="icon-btn primary play-btn" title="Пуск / Пауза" aria-pressed="false">
            <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5.14 19 12 8 18.86V5.14Z"/></svg>
            <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display:none"><path d="M7 5h4v14H7z"/><path d="M13 5h4v14h-4z"/></svg>
            <span class="sr-only">Пуск</span>
          </button>

          <button class="icon-btn ghost next-btn" title="Следующий">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M5 19V5l10 7-10 7Zm12-14h2v14h-2z"/></svg>
          </button>
        </div>

        <div class="price" aria-label="Цена трека">
          <svg class="coin" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="9" fill="#ffd8a8"></circle>
            <path d="M9 11h6v2H9z" fill="#8a5c00"></path>
          </svg>
          <div>
            <small style="display:block; font-size:11px; color:var(--muted);">Цена</small>
            <div class="amount">59</div>
          </div>
        </div>
      </div>
    </article>

    <!-- вставьте дополнительные карточки аналогично -->
  </div>

  <!-- Общий элемент audio — управляет проигрыванием любого выбранного трека -->
  <audio id="audio" preload="metadata"></audio>
</section>

<script>
  (function(){
    const audio = document.getElementById('audio');
    const cards = Array.from(document.querySelectorAll('.track-card'));

    let currentCard = document.querySelector('.track-card.is-active') || null;

    function setActiveCard(card){
      if(currentCard) currentCard.classList.remove('is-active');
      currentCard = card;
      card.classList.add('is-active');
      // обновим aria
      cards.forEach(c => {
        const playBtn = c.querySelector('.play-btn');
        if(playBtn) playBtn.setAttribute('aria-pressed', c === card && card.classList.contains('is-playing'));
      });
    }

    function loadAndPlay(card){
      const src = card.dataset.src;
      if(!src) return;
      // если выбранный — текущий и уже играет, toggle pause
      if(card === currentCard && card.classList.contains('is-playing')){
        audio.pause();
        return;
      }
      // установить src и начать проигрывание
      const currentSrc = audio.src.endsWith(src) ? audio.src : null;
      if (currentSrc !== audio.src) {
        audio.src = src;
      }
      audio.play().catch(e => console.log('Playback blocked:', e));

      // установим is-playing на карточке (остальные — убрать)
      cards.forEach(c => c.classList.remove('is-playing'));
      card.classList.add('is-playing');
      // обнов aria-pressed
      const pb = card.querySelector('.play-btn');
      if(pb) pb.setAttribute('aria-pressed','true');
    }

    function togglePlay(card){
      if(!card) return;
      if(card.classList.contains('is-playing')){
        // pause
        audio.pause();
        card.classList.remove('is-playing');
      } else {
        loadAndPlay(card);
      }
    }

    // клики по карточке — выбрать и проиграть
    cards.forEach(card=>{
      const playBtn = card.querySelector('.play-btn');
      // click whole card (except clicks on control buttons) plays track
      card.addEventListener('click', (e)=>{
        // если кликнули по кнопками управления — обработаем отдельно
        setActiveCard(card);
        if(e.target.closest('.controls') || e.target.closest('.price')) return;
        togglePlay(card);
      });

      // play button
      if(playBtn){
        playBtn.addEventListener('click', (e)=>{
          e.stopPropagation();
          setActiveCard(card);
          togglePlay(card);
        });
      }

      // prev/next (простой переключатель по порядку)
      const prevBtn = card.querySelector('.prev-btn');
      const nextBtn = card.querySelector('.next-btn');
      if(prevBtn) prevBtn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const idx = cards.indexOf(card);
        const prev = cards[(idx - 1 + cards.length) % cards.length];
        if(prev) loadAndPlay(prev);
      });
      if(nextBtn) nextBtn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const idx = cards.indexOf(card);
        const next = cards[(idx + 1) % cards.length];
        if(next) loadAndPlay(next);
      });
    });

    // audio events — синхронизируем UI
    audio.addEventListener('play', ()=>{
      if(currentCard){
        currentCard.classList.add('is-playing');
        setActiveCard(currentCard);
        // swap icons
        const playSvg = currentCard.querySelector('.icon-play');
        const pauseSvg = currentCard.querySelector('.icon-pause');
        if(playSvg) playSvg.style.display = 'none';
        if(pauseSvg) pauseSvg.style.display = 'block';
      }
    });
    audio.addEventListener('pause', ()=>{
      cards.forEach(c => c.classList.remove('is-playing'));
      // swap all pause->play
      cards.forEach(c=>{
        const playSvg = c.querySelector('.icon-play');
        const pauseSvg = c.querySelector('.icon-pause');
        if(playSvg) playSvg.style.display = '';
        if(pauseSvg) pauseSvg.style.display = 'none';
        const pb = c.querySelector('.play-btn');
        if(pb) pb.setAttribute('aria-pressed','false');
      });
    });

    // обновление прогресса для активной карточки
    audio.addEventListener('timeupdate', ()=>{
      if(!currentCard) return;
      const prog = currentCard.querySelector('.progress-bar');
      if(!prog) return;
      const pct = (audio.currentTime / Math.max(1, audio.duration)) * 100;
      prog.style.width = pct + '%';
    });

    // при окончании — переключаем на следующий
    audio.addEventListener('ended', ()=>{
      if(!currentCard) return;
      const idx = cards.indexOf(currentCard);
      const next = cards[(idx + 1) % cards.length];
      if(next) loadAndPlay(next);
    });

    // Инициализация: если есть активная карточка, загрузим её (не автоматически не проигрывая)
    if(currentCard && currentCard.dataset.src){
      audio.src = currentCard.dataset.src;
      // оставляем паузу — пользователь нажмёт play
    }

    // Пример: анимация монетки при hover/play реализована через CSS (coin-spin)
    // Если нужно, можно менять цену программно:
    window.updateTrackPrice = function(trackIndex, newPrice){
      const card = cards[trackIndex];
      if(!card) return;
      card.dataset.price = newPrice;
      const amount = card.querySelector('.amount');
      if(amount) amount.textContent = newPrice;
    };
  })();
</script>